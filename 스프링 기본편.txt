0. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ - κΈ°λ³ΈνΈ v2023-12-04

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

**μΈν”„λ° κ°•μ**

**μ €μ: κΉ€μν•**

μ „μ²΄ λ©μ°¨

1. κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ™€ μ¤ν”„λ§

2. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ π•”ν•΄1 - μμ  λ§λ“¤κΈ°

3. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ π•”ν•΄2 - κ°μ²΄ μ§€ν–¥ μ›λ¦¬ μ μ©

4. μ¤ν”„λ§ μ»¨ν…π•”λ„μ™€ μ¤ν”„λ§ λΉ

5. μ‹±κΈ€ν†¤ μ»¨ν…π•”λ„

6. μ»΄ν¬λ„νΈ μ¤μΊ”

7. μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…

8. λΉ μƒλ…μ£ΌκΈ° μ½λ°±

9. λΉ μ¤μ½”ν”„

10. λ‹¤μμΌλ΅

λ²„μ „ μμ • μ΄λ ¥

v2023-12-04

μ¤ν”„λ§ λ¶€νΈ 3.2 π•”μ - μΈν…”λ¦¬J μ„¤μ •μ‹ Gradleμ„ μ‚¬μ©ν•λ„λ΅ κ°€π•”λ“

v2023-11-27

μ¤ν”„λ§ λ¶€νΈ 3.2 μ—…λ°π•”νΈ κ΄€λ ¨ π•”μ
start.spring.io μ¤ν”„λ§ λ¶€νΈ 2.x μ§€μ› μΆ…λ£
μ¤ν”„λ§ λ¶€νΈ 3.0 π•”μƒμ„ μ‚¬μ©ν•΄μ£Όμ„Έμ”.
μλ°” 17 π•”μƒμ„ μ‚¬μ©ν•΄μ£Όμ„Έμ”.

κ°•μ λ©”λ‰΄μ–Ό λ§ν¬

v2023-10-01

μ¤νƒ€ μμ •(HRDMλ‹ λ„μ›€)

λΉμ¤μ½”ν”„ π•”λ―Έμ§€ μ¤νƒ€ μμ •(11 1λ‹ λ„μ›€)


v2023-08-04

μ¤νƒ€ μμ •(b611219λ‹ λ„μ›€)

v2023-06-16

μ¤ν”„λ§ λ¶€νΈ 3.1 λ΅κ·Έ μ¶λ ¥

μ¤νƒ€ μμ •(ν™”π•”ν…λ‹, Jeonghyun Kimλ‹ λ„μ›€)

v2023-01-03

μ¤ν”„λ§ λ¶€νΈ 3.0 λ‚΄μ© μ¶”κ°€ - Provider

μ¤νƒ€(λ°¤μλ©λ΅λ””λ‹ λ„μ›€)

v2022-11-28

μ¤ν”„λ§ λ¶€νΈ 3.0 λ‚΄μ© μ¶”κ°€

ν”„λ΅μ νΈ μ„ νƒμ—μ„ Gradle - Groovy μ¶”κ°€

v2022-10-22

μ¤νƒ€ μμ •(μ†΅μ°¬μ±λ‹ λ„μ›€)

v2022-05-15

μ½”λ“ μ¤νƒ€ μμ •(κΉ€νƒν„λ‹ λ„μ›€)
μ¤νƒ€ μμ •(highjuneλ‹ λ„μ›€)
μ¤νƒ€ μμ •(grammλ‹ λ„μ›€)
μ¤νƒ€ μμ •(π•”μ‹ κ΄‘λ‹ λ„μ›€)

μ¤νƒ€ μμ •(terry9611λ‹ λ„μ›€)
μ¤νƒ€ μμ •(π•”κ·νƒλ‹ λ„μ›€)
μ¤νƒ€ μμ •(μ μ§„π•”λ‹ λ„μ›€)

v2021-08-07

μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό μƒμ„±ν•λ©΄μ„ μ¤ν”„λ§ λΉ λ“±λ΅ν•κΈ° μ„¤λ… μ¶”κ°€
μ¤νƒ€ μμ •(κ°κµ΄λ‹ λ„μ›€)


v2021-01-24

[μ¤νƒ€ μμ •]

λ„μ›€ μ£Όμ‹  λ¶„: κ°•λ―Όμ •λ‹

v2021-01-03

[μ¤νƒ€ μμ •]

λ„μ›€ μ£Όμ‹  λ¶„: κΉ€μ„±μΌλ‹

v2020-12-29

[μ¤νƒ€ μμ •]

λ„μ›€ μ£Όμ‹  λ¶„: Jongseok Park, μ•„μΉ΄ν λΌλ‹

v1.3 - 2020-11-12

[μ¤νƒ€ μμ •]

[μ „]"rateDiscountPolicy"κ°€ λ„μ–΄μ¤λ©΄ fixDiscountPolicy μ¤ν”„λ§ λΉμ„ μ°Ύμ•„μ„ μ‹¤ν–‰ν•λ‹¤.
[ν›„]"rateDiscountPolicy"κ°€ λ„μ–΄μ¤λ©΄ rateDiscountPolicy μ¤ν”„λ§ λΉμ„ μ°Ύμ•„μ„ μ‹¤ν–‰ν•λ‹¤.
λ„μ›€ μ£Όμ‹  λ¶„: gptpem38λ‹

v1.2 - 2020-10-18

[μ¤νƒ€ μμ •] @Quilifier     @Qualifier

λ„μ›€ μ£Όμ‹  λ¶„: μ •ν„μ§€λ‹

v1.1 - 2020-09-25

[μ¤νƒ€ μμ •] μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 

μΈν„°νπ•”μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“ λ³€κ²½μ—μ„ final ν‚¤μ›λ“ μ κ±°
λ„μ›€ μ£Όμ‹  λ¶„: νμ΅π•” κ°λ°μ

v1.0 - 2020-09-21

λ¦΄λ¦¬μ¦


1. κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ™€ μ¤ν”„λ§

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

**λ³„λ„ PPT μλ£ μ°Έκ³ **

λ©μ°¨

π•”μ•ΌκΈ° - μλ°” μ§„μμ μ¶”μ΄ κ²¨μΈκ³Ό μ¤ν”„λ§μ νƒ„μƒ 15:22

μ¤ν”„λ§π•”λ€? 14:30

μΆ‹μ€ κ°μ²΄ μ§€ν–¥ ν”„λ΅κ·Έλλ°π•”λ€? 21:21

μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™(SOLID) 18:14

κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ™€ μ¤ν”„λ§ 08:29


2. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ μ΄ν•΄1 - μμ  λ§λ“¤κΈ°

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

/ν”„λ΅μ νΈ μƒμ„±

/λΉ„μ¦λ‹μ¤ μ”κµ¬μ‚¬ν•­κ³Ό μ„¤κ³„

/νμ› λ„λ©”μΈ μ„¤κ³„

/νμ› λ„λ©”μΈ κ°λ°

/νμ› λ„λ©”μΈ μ‹¤ν–‰κ³Ό ν…μ¤νΈ

/μ£Όλ¬Έκ³Ό ν• μΈ λ„λ©”μΈ μ„¤κ³„

/μ£Όλ¬Έκ³Ό ν• μΈ λ„λ©”μΈ κ°λ°

/μ£Όλ¬Έκ³Ό ν• μΈ λ„λ©”μΈ μ‹¤ν–‰κ³Ό ν…μ¤νΈ

ν”„λ΅μ νΈ μƒμ„±

**μ‚¬μ „ μ¤€λΉ„λ¬Ό**

Java 17 π•”μƒ μ„¤μΉ

IDE: IntelliJ λλ” Eclipse μ„¤μΉ

**μ¤ν”„λ§ λ¶€νΈ μ¤νƒ€ν„° μ‚¬μ΄νΈλ΅ μ΄λ™ν•΄μ„ μ¤ν”„λ§ ν”„λ΅μ νΈ μƒμ„±**

https://start.spring.io

ν”„λ΅μ νΈ μ„ νƒ

Project: **Gradle - Groovy**                   Project
Spring Boot: 3.x.x

Language: Java
Packaging: Jar

Java: 17 λλ” 21

Project Metadata
groupId: hello
artifactId: core

Dependencies: μ„ νƒν•μ§€ μ•λ”λ‹¤.

**μ£Όμ!**                   **μ¤ν”„λ§ λ¶€νΈ 3.0 μ΄μƒ, JDK 17 μ΄μƒμ„ μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤.**


μ£Όμ! - μ¤ν”„λ§ λ¶€νΈ 3.x λ²„μ „ μ„ νƒ ν•„μ

**start.spring.io μ‚¬μ΄νΈμ—μ„ μ¤ν”„λ§ λ¶€νΈ 2.xμ— λ€ν• μ§€μ›μ΄ μΆ…λ£λμ–΄μ„ λ”λ” μ„ νƒν•  μ μ—†μµλ‹λ‹¤.**

**μ΄μ λ” μ¤ν”„λ§ λ¶€νΈ 3.0 μ΄μƒμ„ μ„ νƒν•΄μ£Όμ„Έμ”.**

μ¤ν”„λ§ λ¶€νΈ 3.0μ„ μ„ νƒν•κ² λλ©΄ λ‹¤μ λ¶€λ¶„μ„ κΌ­ ν™•μΈν•΄μ£Όμ„Έμ”.

**1. Java 17 μ΄μƒ**μ„ μ‚¬μ©ν•΄μ•Ό ν•©λ‹λ‹¤.

**2. javax ν¨ν‚¤μ§€ μ΄λ¦„μ„ jakartaλ΅ λ³€κ²½**ν•΄μ•Ό ν•©λ‹λ‹¤.

μ¤λΌν΄κ³Ό μλ°” λΌπ•”μ„Όμ¤ λ¬Έμ λ΅ λ¨λ“  javax ν¨ν‚¤μ§€λ¥Ό jakarta λ΅ λ³€κ²½ν•κΈ°λ΅ ν–μµλ‹λ‹¤.

**3. H2 λ°μ΄ν„°λ² μ΄μ¤λ¥Ό 2.1.214 λ²„μ „ μ΄μƒ μ‚¬μ©ν•΄μ£Όμ„Έμ”.**

**ν¨ν‚¤μ§€ μ΄λ¦„ λ³€κ²½ μ)**

**JPA μ• λ…Έν…μ΄μ…**

javax.persistence.Entity     jakarta.persistence.Entity

**μ¤ν”„λ§μ—μ„ μμ£Ό μ‚¬μ©ν•λ” @PostConstruct μ• λ…Έν…μ΄μ…**

javax.annotation.PostConstruct     jakarta.annotation.PostConstruct

**μ¤ν”„λ§μ—μ„ μμ£Ό μ‚¬μ©ν•λ” κ²€μ¦ μ• λ…Έν…μ΄μ…**

javax.validation     jakarta.validation

μ¤ν”„λ§ λ¶€νΈ 3.0 κ΄€λ ¨ μμ„Έν• λ‚΄μ©μ€ λ‹¤μ λ§ν¬λ¥Ό ν™•μΈν•΄μ£Όμ„Έμ”: https://bit.ly/springboot3

**Gradle μ „μ²΄ μ„¤μ •**

build.gradle

```grvy

plugins {

id 'org.springframework.boot' version '2.3.3.RELEASE'

id 'io.spring.dependency-management' version '1.0.9.RELEASE'
id 'java'

}

group = 'hello'

version = '0.0.1-SNAPSHOT'

sourceCompatibility = '11'

repositories {
mavenCentral()

}

dependencies {

implementation 'org.springframework.boot:spring-boot-starter'


testImplementation('org.springframework.boot:spring-boot-starter-test') {
exclude group: 'org.junit.vintage', module: 'junit-vintage-engine'

}

}

test {

useJUnitPlatform()

}

```

λ™μ‘ ν™•μΈ

κΈ°λ³Έ λ©”μΈ ν΄λμ¤ μ‹¤ν–‰( CoreApplication.main() )

IntelliJ Gradle λ€μ‹ μ— μλ°” μ§μ ‘ μ‹¤ν–‰

**μ£Όμ! μ΄ λ‚΄μ©μ€ μ¤ν”„λ§ λ¶€νΈ 3.2 μ΄μ „μ—λ§ μ μ©λλ‹¤. μ¤ν”„λ§ λ¶€νΈ 3.2 μ΄μƒμ„ μ‚¬μ©ν•λ‹¤λ©΄ μ΄ λ‚΄μ©μ€ λ„μ–΄κ°€μ**

μµκ·Ό IntelliJ λ²„μ „μ€ Gradleμ„ ν†µν•΄μ„ μ‹¤ν–‰ ν•λ” κ²ƒπ•” κΈ°λ³Έ μ„¤μ •π•”λ‹¤. π•”λ ‡κ² ν•λ©΄ μ‹¤ν–‰μ†λ„κ°€ λλ¦¬λ‹¤. λ‹¤μκ³Ό κ°™π•” λ³€
κ²½ν•λ©΄ μλ°”λ΅ λ°”λ΅ μ‹¤ν–‰ν•΄μ„ μ‹¤ν–‰μ†λ„κ°€ λ” λΉ λ¥΄λ‹¤.

Preferences     Build, Execution, Deployment     Build Tools     Gradle
Build and run using: Gradle     IntelliJ IDEA

Run tests using: Gradle     IntelliJ IDEA

**μ„¤μ • μ΄λ―Έμ§€**


μ£Όμ! μ¤ν”„λ§ λ¶€νΈ 3.2 λ¶€ν„° Gradle μµμ…μ„ μ„ νƒν•μ.

μ¤ν”„λ§ λ¶€νΈ 3.2 λ¶€ν„° μ•μ„ Build and run usingμ— μ•μ„ μ„¤λ…ν• IntelliJ IDEAλ¥Ό μ„ νƒν•λ©΄ λ‡κ°€μ§€ μ¤λ¥κ°€ λ°μƒν•λ‹¤.
λ”°λΌμ„ μ¤ν”„λ§ λ¶€νΈ 3.2λ¥Ό μ‚¬μ©ν•λ‹¤λ©΄ λ‹¤μκ³Ό κ°™π•” IntelliJ IDEAκ°€ μ•„λ‹λΌ Gradleμ„ μ„ νƒν•΄μ•Ό ν•λ‹¤.


λ‹¤μμΌλ΅ π•”λ™ν•©λ‹λ‹¤.

Windows: File     Settings(Ctrl+Alt+S)
Mac: IntelliJ IDEA | Preferences(β,)

Preferences     Build, Execution, Deployment     Build Tools     Gradle

**λΉ¨κ°„μƒ‰ λ°•μ¤μ Build and run usingλ¥Ό Gradleλ΅ μ„ νƒν•©λ‹λ‹¤.**

**λΉ¨κ°„μƒ‰ λ°•μ¤μ Build tests usingλ¥Ό Gradleλ΅ μ„ νƒν•©λ‹λ‹¤.**

λΉ¨κ°„μƒ‰ λ°•μ¤ Gradle JVMμ„ μƒλ΅ μ„¤μΉν• **μλ°” 17λλ” κ·Έ μ΄μƒμΌλ΅ μ§€μ •ν•©λ‹λ‹¤.**

λΉ„μ¦λ‹μ¤ μ”κµ¬μ‚¬ν•­κ³Ό μ„¤κ³„

νμ›

νμ›μ„ κ°€μ…ν•κ³  μ΅°νν•  μ μλ‹¤.

νμ›μ€ μΌλ°κ³Ό VIP λ‘ κ°€μ§€ λ“±κΈ‰π•” μλ‹¤.

νμ› λ°π•”ν„°λ” μμ²΄ DBλ¥Ό κµ¬μ¶•ν•  μ μκ³ , μ™Έλ¶€ μ‹μ¤ν…κ³Ό μ—°λ™ν•  μ μλ‹¤. (λ―Έν™•μ •)

μ£Όλ¬Έκ³Ό ν• μΈ μ •μ±…


νμ›μ€ μƒν’μ„ μ£Όλ¬Έν•  μ μλ‹¤.

νμ› λ“±κΈ‰μ— λ”°λΌ ν• μΈ μ •μ±…μ„ μ μ©ν•  μ μλ‹¤.

ν• μΈ μ •μ±…μ€ λ¨λ“  VIPλ” 1000μ›μ„ ν• μΈν•΄μ£Όλ” κ³ μ • κΈμ•΅ ν• μΈμ„ μ μ©ν•΄λ‹¬λΌ. (λ‚μ¤‘μ— λ³€κ²½ λ  μ μλ‹¤.)
ν• μΈ μ •μ±…μ€ λ³€κ²½ κ°€λ¥μ„±π•” λ†’λ‹¤. νμ‚¬μ κΈ°λ³Έ ν• μΈ μ •μ±…μ„ μ•„μ§ μ •ν•μ§€ λ»ν–κ³ , μ¤ν” μ§μ „κΉμ§€ κ³ λ―Όμ„ λ―Έλ£¨
κ³  μ‹¶λ‹¤. μµμ•…μ κ²½μ° ν• μΈμ„ μ μ©ν•μ§€ μ•μ„ μ λ„ μλ‹¤. (λ―Έν™•μ •)

μ”κµ¬μ‚¬ν•­μ„ λ³΄λ©΄ νμ› λ°π•”ν„°, ν• μΈ μ •μ±… κ°™μ€ λ¶€λ¶„μ€ μ§€κΈ κ²°μ •ν•κΈ° μ–΄λ ¤μ΄ λ¶€λ¶„π•”λ‹¤. κ·Έλ ‡λ‹¤κ³  π•”λ° μ •μ±…π•” κ²°μ •λ  λ•
κΉμ§€ κ°λ°μ„ λ¬΄κΈ°ν• κΈ°λ‹¤λ¦΄ μ λ„ μ—†λ‹¤. μ°λ¦¬λ” μ•μ—μ„ λ°°μ΄ κ°μ²΄ μ§€ν–¥ μ„¤κ³„ λ°©λ²•π•” μμ§€ μ•μ€κ°€!

μΈν„°νπ•”μ¤λ¥Ό λ§λ“¤κ³  κµ¬ν„μ²΄λ¥Ό μ–Έμ λ“ μ§€ κ°μ•„λΌμΈ μ μλ„λ΅ μ„¤κ³„ν•λ©΄ λλ‹¤. κ·ΈλΌ μ‹μ‘ν•΄λ³΄μ.

**μ°Έκ³ :**                   ν”„λ΅μ νΈ ν™κ²½μ„¤μ •μ„ νΈλ¦¬ν•κ² ν•λ ¤κ³  μ¤ν”„λ§ λ¶€νΈλ¥Ό μ‚¬μ©ν• κ²ƒπ•”λ‹¤. μ§€κΈμ€ μ¤ν”„λ§ μ—†λ” μμν• μλ°”λ΅λ§
κ°λ°μ„ μ§„ν–‰ν•λ‹¤λ” μ μ„ κΌ­ κΈ°μ–µν•μ! μ¤ν”„λ§ κ΄€λ ¨μ€ ν•μ°Έ λ’¤μ— λ“±μ¥ν•λ‹¤.

νμ› λ„λ©”μΈ μ„¤κ³„

νμ› λ„λ©”μΈ μ”κµ¬μ‚¬ν•­

νμ›μ„ κ°€μ…ν•κ³  μ΅°νν•  μ μλ‹¤.

νμ›μ€ μΌλ°κ³Ό VIP λ‘ κ°€μ§€ λ“±κΈ‰π•” μλ‹¤.

νμ› λ°π•”ν„°λ” μμ²΄ DBλ¥Ό κµ¬μ¶•ν•  μ μκ³ , μ™Έλ¶€ μ‹μ¤ν…κ³Ό μ—°λ™ν•  μ μλ‹¤. (λ―Έν™•μ •)

**νμ› λ„λ©”μΈ ν‘λ ¥ κ΄€κ³„**


**νμ› ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨**

**νμ› κ°μ²΄ λ‹¤μ΄μ–΄κ·Έλ¨**

νμ› μ„λΉ„μ¤: **MemberServiceImpl**

νμ› λ„λ©”μΈ κ°λ°

νμ› μ—”ν‹°ν‹°

**νμ› λ“±κΈ‰**

```

package hello.core.member;

public enum Grade {
BASIC,

VIP

}

```


**νμ› μ—”ν‹°ν‹°**

```

package hello.core.member;
public class Member {

private Long id;
private String name;
private Grade grade;

public Member(Long id, String name, Grade grade) {
this.id = id;

this.name = name;
this.grade = grade;

}

public Long getId() {
return id;

}

public void setId(Long id) {
this.id = id;

}

public String getName() {
return name;

}

public void setName(String name) {
this.name = name;

}

public Grade getGrade() {
return grade;

}

public void setGrade(Grade grade) {
this.grade = grade;

}

}

```


νμ› μ €μ¥μ†

**νμ› μ €μ¥μ† μΈν„°νμ΄μ¤**

```

package hello.core.member;

public interface MemberRepository {
void save(Member member);

Member findById(Long memberId);

}

```

**λ©”λ¨λ¦¬ νμ› μ €μ¥μ† κµ¬ν„μ²΄**

```

package hello.core.member;

import java.util.HashMap;
import java.util.Map;

public class MemoryMemberRepository implements MemberRepository {
private static Map<Long, Member> store = new HashMap<>();

@Override

public void save(Member member) {
store.put(member.getId(), member);

}

@Override

public Member findById(Long memberId) {
return store.get(memberId);

}

}

```

λ°π•”ν„°λ² π•”μ¤κ°€ μ•„μ§ ν™•μ •π•” μ•λμ—λ‹¤. κ·Έλλ„ κ°λ°μ€ μ§„ν–‰ν•΄μ•Ό ν•λ‹ κ°€μ¥ λ‹¨μν•, λ©”λ¨λ¦¬ νμ› μ €μ¥μ†λ¥Ό κµ¬ν„ν•΄μ„ μ°μ„ 
κ°λ°μ„ μ§„ν–‰ν•μ.

μ°Έκ³ :  HashMap μ€ λ™μ‹μ„± π•”μκ°€ λ°μƒν•  μ μλ‹¤. π•”λ° κ²½μ° ConcurrentHashMap μ„ μ‚¬μ©ν•μ.


νμ› μ„λΉ„μ¤

**νμ› μ„λΉ„μ¤ μΈν„°νμ΄μ¤**

```

package hello.core.member;
public interface MemberService {

void join(Member member);

Member findMember(Long memberId);

}

```

**νμ› μ„λΉ„μ¤ κµ¬ν„μ²΄**

```

package hello.core.member;

public class MemberServiceImpl implements MemberService {
private final MemberRepository memberRepository = new

MemoryMemberRepository();

public void join(Member member) {
memberRepository.save(member);

}

public Member findMember(Long memberId) {
return memberRepository.findById(memberId);

}

}

```

νμ› λ„λ©”μΈ μ‹¤ν–‰κ³Ό ν…μ¤νΈ


νμ› λ„λ©”μΈ - νμ› κ°€μ… main

```

package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;

import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

public class MemberApp {

public static void main(String[] args) {

MemberService memberService = new MemberServiceImpl();
Member member = new Member(1L, "memberA", Grade.VIP);
memberService.join(member);


}

```

Member findMember = memberService.findMember(1L);
System.out.println("new member = " + member.getName());
System.out.println("find Member = " + findMember.getName());

}

μ• ν”λ¦¬μΌ€π•”μ… λ΅μ§μΌλ΅ π•”λ ‡κ² ν…μ¤νΈ ν•λ” κ²ƒμ€ μΆ‹μ€ λ°©λ²•π•” μ•„λ‹λ‹¤. JUnit ν…μ¤νΈλ¥Ό μ‚¬μ©ν•μ.

νμ› λ„λ©”μΈ - νμ› κ°€μ… ν…μ¤νΈ

```

package hello.core.member;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;
class MemberServiceTest {

MemberService memberService = new MemberServiceImpl();

@Test

void join() {

//given

Member member = new Member(1L, "memberA", Grade.VIP);


//when
memberService.join(member);

Member findMember = memberService.findMember(1L);

//then
Assertions.assertThat(member).isEqualTo(findMember);

}

}

```

νμ› λ„λ©”μΈ μ„¤κ³„μ λ¬Έμ μ 

π•” μ½”λ“μ μ„¤κ³„μƒ λ¬Έμ μ μ€ λ¬΄μ—‡μΌκΉμ”?

λ‹¤λ¥Έ μ €μ¥μ†λ΅ λ³€κ²½ν•  λ• OCP μ›μΉ™μ„ μ μ¤€μν• κΉμ”?
DIPλ¥Ό μ μ§€ν‚¤κ³  μμ„κΉμ”?

**μμ΅΄κ΄€κ³„κ°€ μΈν„°νμ΄μ¤ λΏλ§ μ•„λ‹λΌ κµ¬ν„κΉμ§€ λ¨λ‘ μμ΅΄ν•λ” λ¬Έμ μ μ΄ μμ**

**μ£Όλ¬ΈκΉμ§€ λ§λ“¤κ³ λ‚μ„ λ¬Έμ μ κ³Ό ν•΄κ²° λ°©μ•μ„ μ„¤λ…**

μ£Όλ¬Έκ³Ό ν• μΈ λ„λ©”μΈ μ„¤κ³„

μ£Όλ¬Έκ³Ό ν• μΈ μ •μ±…

νμ›μ€ μƒν’μ„ μ£Όλ¬Έν•  μ μλ‹¤.

νμ› λ“±κΈ‰μ— λ”°λΌ ν• μΈ μ •μ±…μ„ μ μ©ν•  μ μλ‹¤.

ν• μΈ μ •μ±…μ€ λ¨λ“  VIPλ” 1000μ›μ„ ν• μΈν•΄μ£Όλ” κ³ μ • κΈμ•΅ ν• μΈμ„ μ μ©ν•΄λ‹¬λΌ. (λ‚μ¤‘μ— λ³€κ²½ λ  μ μλ‹¤.)
ν• μΈ μ •μ±…μ€ λ³€κ²½ κ°€λ¥μ„±π•” λ†’λ‹¤. νμ‚¬μ κΈ°λ³Έ ν• μΈ μ •μ±…μ„ μ•„μ§ μ •ν•μ§€ λ»ν–κ³ , μ¤ν” μ§μ „κΉμ§€ κ³ λ―Όμ„ λ―Έλ£¨
κ³  μ‹¶λ‹¤. μµμ•…μ κ²½μ° ν• μΈμ„ μ μ©ν•μ§€ μ•μ„ μ λ„ μλ‹¤. (λ―Έν™•μ •)

**μ£Όλ¬Έ λ„λ©”μΈ ν‘λ ¥, μ—­ν• , μ±…μ„**


**1. μ£Όλ¬Έ μƒμ„±:**                   ν΄λΌπ•”μ–ΈνΈλ” μ£Όλ¬Έ μ„λΉ„μ¤μ— μ£Όλ¬Έ μƒμ„±μ„ μ”μ²­ν•λ‹¤.

**2. νμ› μ΅°ν:**                   ν• μΈμ„ μ„ν•΄μ„λ” νμ› λ“±κΈ‰π•” ν•„μ”ν•λ‹¤. κ·Έλμ„ μ£Όλ¬Έ μ„λΉ„μ¤λ” νμ› μ €μ¥μ†μ—μ„ νμ›μ„ μ΅°νν•λ‹¤.

**3. ν• μΈ μ μ©:**                   μ£Όλ¬Έ μ„λΉ„μ¤λ” νμ› λ“±κΈ‰μ— λ”°λ¥Έ ν• μΈ μ—¬λ¶€λ¥Ό ν• μΈ μ •μ±…μ— μ„μ„ν•λ‹¤.

**4. μ£Όλ¬Έ κ²°κ³Ό λ°ν™:**                   μ£Όλ¬Έ μ„λΉ„μ¤λ” ν• μΈ κ²°κ³Όλ¥Ό ν¬ν•¨ν• μ£Όλ¬Έ κ²°κ³Όλ¥Ό λ°ν™ν•λ‹¤.

μ°Έκ³ : μ‹¤μ λ΅λ” μ£Όλ¬Έ λ°π•”ν„°λ¥Ό DBμ— μ €μ¥ν•κ² μ§€λ§, μμ κ°€ λ„λ¬΄ λ³µμ΅ν•΄ μ§ μ μμ–΄μ„ μƒλµν•κ³ , λ‹¨μν μ£Όλ¬Έ κ²°κ³Ό
λ¥Ό λ°ν™ν•λ‹¤.

**μ£Όλ¬Έ λ„λ©”μΈ μ „μ²΄**


**μ—­ν• κ³Ό κµ¬ν„μ„ λ¶„λ¦¬**ν•΄μ„ μμ λ΅­κ² κµ¬ν„ κ°μ²΄λ¥Ό μ΅°λ¦½ν•  μ μκ² μ„¤κ³„ν–λ‹¤. λ•λ¶„μ— νμ› μ €μ¥μ†λ” λ¬Όλ΅ π•”κ³ , ν• μΈ μ •μ±…λ„
μ μ—°ν•κ² λ³€κ²½ν•  μ μλ‹¤.

**μ£Όλ¬Έ λ„λ©”μΈ ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨**

**μ£Όλ¬Έ λ„λ©”μΈ κ°μ²΄ λ‹¤μ΄μ–΄κ·Έλ¨1**

νμ›μ„ λ©”λ¨λ¦¬μ—μ„ μ΅°νν•κ³ , μ •μ•΅ ν• μΈ μ •μ±…(κ³ μ • κΈμ•΅)μ„ μ§€μ›ν•΄λ„ μ£Όλ¬Έ μ„λΉ„μ¤λ¥Ό λ³€κ²½ν•μ§€ μ•μ•„λ„ λλ‹¤.
μ—­ν• λ“¤μ ν‘λ ¥ κ΄€κ³„λ¥Ό κ·Έλ€λ΅ μ¬μ‚¬μ© ν•  μ μλ‹¤.


**μ£Όλ¬Έ λ„λ©”μΈ κ°μ²΄ λ‹¤μ΄μ–΄κ·Έλ¨2**

νμ›μ„ λ©”λ¨λ¦¬κ°€ μ•„λ‹ μ‹¤μ  DBμ—μ„ μ΅°νν•κ³ , μ •λ¥  ν• μΈ μ •μ±…(μ£Όλ¬Έ κΈμ•΅μ— λ”°λΌ % ν• μΈ)μ„ μ§€μ›ν•΄λ„ μ£Όλ¬Έ μ„λΉ„μ¤λ¥Ό λ³€
κ²½ν•μ§€ μ•μ•„λ„ λλ‹¤.

ν‘λ ¥ κ΄€κ³„λ¥Ό κ·Έλ€λ΅ μ¬μ‚¬μ© ν•  μ μλ‹¤.

μ£Όλ¬Έκ³Ό ν• μΈ λ„λ©”μΈ κ°λ°

**ν• μΈ μ •μ±… μΈν„°νμ΄μ¤**

```

package hello.core.discount;
import hello.core.member.Member;

public interface DiscountPolicy {

/**

* @return ν• μΈ  λ€μƒ  κΈμ•΅

*/

int discount(Member member, int price);

}

```

**μ •μ•΅ ν• μΈ μ •μ±… κµ¬ν„μ²΄**

```

package hello.core.discount;


import hello.core.member.Grade;
import hello.core.member.Member;

public class FixDiscountPolicy implements DiscountPolicy {

private int discountFixAmount = 1000; //1000μ›  ν• μΈ

@Override

public int discount(Member member, int price) {
if (member.getGrade() == Grade.VIP) {

return discountFixAmount;

} else {

return 0;

}

}

}

```

VIPλ©΄ 1000μ› ν• μΈ, μ•„λ‹λ©΄ ν• μΈ μ—†μ

**μ£Όλ¬Έ μ—”ν‹°ν‹°**

```

package hello.core.order;
public class Order {

private Long memberId;
private String itemName;
private int itemPrice;
private int discountPrice;

public Order(Long memberId, String itemName, int itemPrice, int
discountPrice) {

this.memberId = memberId;
this.itemName = itemName;
this.itemPrice        = itemPrice;
this.discountPrice   = discountPrice;

}

public int calculatePrice() {

return itemPrice - discountPrice;

}


public Long getMemberId() {
return memberId;

}

public String getItemName() {
return itemName;

}

public int getItemPrice() {
return itemPrice;

}

public int getDiscountPrice() {
return discountPrice;

}

@Override

public String toString() {
return "Order{" +

"memberId=" + memberId +

", itemName='" + itemName + '\'' +
", itemPrice=" + itemPrice +

", discountPrice=" + discountPrice +
'}';

}

}

```

**μ£Όλ¬Έ μ„λΉ„μ¤ μΈν„°νμ΄μ¤**

```

package hello.core.order;

public interface OrderService {

Order createOrder(Long memberId, String itemName, int itemPrice);

}

```

**μ£Όλ¬Έ μ„λΉ„μ¤ κµ¬ν„μ²΄**

```

package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;


import hello.core.member.Member;

import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;

public class OrderServiceImpl implements OrderService {

private final MemberRepository memberRepository = new
MemoryMemberRepository();

private final DiscountPolicy discountPolicy = new FixDiscountPolicy();

@Override

public Order createOrder(Long memberId, String itemName, int itemPrice) {

Member member = memberRepository.findById(memberId);

int discountPrice = discountPolicy.discount(member, itemPrice);

return new Order(memberId, itemName, itemPrice, discountPrice);

}

}

```

μ£Όλ¬Έ μƒμ„± μ”μ²­π•” μ¤λ©΄, νμ› μ •λ³΄λ¥Ό μ΅°νν•κ³ , ν• μΈ μ •μ±…μ„ μ μ©ν• λ‹¤μ μ£Όλ¬Έ κ°μ²΄λ¥Ό μƒμ„±ν•΄μ„ λ°ν™ν•λ‹¤.

**λ©”λ¨λ¦¬ νμ› λ¦¬ν¬μ§€ν† λ¦¬μ™€, κ³ μ • κΈμ•΅ ν• μΈ μ •μ±…μ„ κµ¬ν„μ²΄λ΅ μƒμ„±ν•λ‹¤.**

μ£Όλ¬Έκ³Ό ν• μΈ λ„λ©”μΈ μ‹¤ν–‰κ³Ό ν…μ¤νΈ

μ£Όλ¬Έκ³Ό ν• μΈ μ •μ±… μ‹¤ν–‰

```

package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;

import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import hello.core.order.Order;


import hello.core.order.OrderService;
import hello.core.order.OrderServiceImpl;

public class OrderApp {

public static void main(String[] args) {

MemberService memberService = new MemberServiceImpl();
OrderService orderService = new OrderServiceImpl();

long memberId = 1L;

Member member = new Member(memberId, "memberA", Grade.VIP);
memberService.join(member);

Order order = orderService.createOrder(memberId, "itemA", 10000);
System.out.println("order = " + order);

}

}

```

**κ²°κ³Ό**

```

order = Order{memberId=1, itemName='itemA', itemPrice=10000, discountPrice=1000}

```

ν• μΈ κΈμ•΅π•” μ μ¶λ ¥λλ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

μ• ν”λ¦¬μΌ€π•”μ… λ΅μ§μΌλ΅ π•”λ ‡κ² ν…μ¤νΈ ν•λ” κ²ƒμ€ μΆ‹μ€ λ°©λ²•π•” μ•„λ‹λ‹¤. JUnit ν…μ¤νΈλ¥Ό μ‚¬μ©ν•μ.

μ£Όλ¬Έκ³Ό ν• μΈ μ •μ±… ν…μ¤νΈ

```

package hello.core.order;

import hello.core.member.Grade;
import hello.core.member.Member;

import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

import static org.junit.jupiter.api.Assertions.*;
class OrderServiceTest {


MemberService memberService = new MemberServiceImpl();
OrderService orderService = new OrderServiceImpl();

@Test

void createOrder() {
long memberId = 1L;

Member member = new Member(memberId, "memberA", Grade.VIP);
memberService.join(member);


}

```

Order order = orderService.createOrder(memberId, "itemA", 10000);
Assertions.assertThat(order.getDiscountPrice()).isEqualTo(1000);

}


3. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ μ΄ν•΄2 - κ°μ²΄ μ§€ν–¥ μ›λ¦¬ μ μ©

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

/μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°

/μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 

/κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬

/AppConfig λ¦¬ν©ν„°λ§

/μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

/μ „μ²΄ νλ¦„ μ •λ¦¬

/μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™μ μ μ©

/IoC, DI, κ·Έλ¦¬κ³  μ»¨ν…π•”λ„

/μ¤ν”„λ§μΌλ΅ μ „ν™ν•κΈ°

μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°

**μƒλ΅μ΄ ν• μΈ μ •μ±…μ„ ν™•μ¥ν•΄λ³΄μ.**

**μ•…λ• κΈ°νμ**: μ„λΉ„μ¤ μ¤ν” μ§μ „μ— ν• μΈ μ •μ±…μ„ μ§€κΈμ²λΌ κ³ μ • κΈμ•΅ ν• μΈπ•” μ•„λ‹λΌ μΆ€ λ” ν•©λ¦¬μ μΈ μ£Όλ¬Έ κΈμ•΅λ‹Ή ν• 
μΈν•λ” μ •λ¥ % ν• μΈμΌλ΅ λ³€κ²½ν•κ³  μ‹¶μ–΄μ”. μλ¥Ό λ“¤μ–΄μ„ κΈ°μ΅΄ μ •μ±…μ€ VIPκ°€ 10000μ›μ„ μ£Όλ¬Έν•λ“  20000μ›μ„ μ£Ό
λ¬Έν•λ“  ν•­μƒ 1000μ›μ„ ν• μΈν–λ”λ°, π•”λ²μ— μƒλ΅ λ‚μ¨ μ •μ±…μ€ 10%λ΅ μ§€μ •ν•΄λ‘λ©΄ κ³ κ°π•” 10000μ› μ£Όλ¬Έμ‹ 1000
μ›μ„ ν• μΈν•΄μ£Όκ³ , 20000μ› μ£Όλ¬Έμ‹μ— 2000μ›μ„ ν• μΈν•΄μ£Όλ” κ±°μ—μ”!

**μμ§„ κ°λ°μ**: μ κ°€ μ²μλ¶€ν„° κ³ μ • κΈμ•΅ ν• μΈμ€ μ•„λ‹λΌκ³  ν–μ–μ•„μ”.

**μ•…λ• κΈ°νμ**: μ• μμΌ μ†ν”„νΈμ›¨μ–΄ κ°λ° μ„ μ–Έ λ°λΌμ”? β€κ³„νμ„ λ”°λ¥΄κΈ°λ³΄λ‹¤ λ³€ν™”μ— λ€μ‘ν•κΈ°λ¥Όβ€

**μμ§„ κ°λ°μ**: β€¦ (ν•μ§€λ§ λ‚ μ μ—°ν• μ„¤κ³„κ°€ κ°€λ¥ν•λ„λ΅ κ°μ²΄μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ¤€μν–μ§€ ν›„ν›„)
μ°Έκ³ : μ• μμΌ μ†ν”„νΈμ›¨μ–΄ κ°λ° μ„ μ–Έ https://agilemanifesto.org/iso/ko/manifesto.html

μμ§„ κ°λ°μκ°€ μ •λ§ κ°μ²΄μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ μ¤€μ ν–λ”μ§€ ν™•μΈν•΄λ³΄μ. π•”λ²μ—λ” μ£Όλ¬Έν• κΈμ•΅μ %λ¥Ό ν• μΈν•΄μ£Όλ” μƒλ΅μ΄
μ •λ¥  ν• μΈ μ •μ±…μ„ μ¶”κ°€ν•μ.

**RateDiscountPolicy μ¶”κ°€**


**RateDiscountPolicy μ½”λ“ μ¶”κ°€**

```

package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;

public class RateDiscountPolicy implements DiscountPolicy {

private int discountPercent = 10; //10% ν• μΈ

@Override

public int discount(Member member, int price) {

if (member.getGrade() == Grade.VIP) {
return price * discountPercent /  100;

} else {

return 0;

}

}

}

```

**ν…μ¤νΈ μ‘μ„±**

```

package hello.core.discount;

import hello.core.member.Grade;
import hello.core.member.Member;


import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.*;
import static org.junit.jupiter.api.Assertions.*;

class RateDiscountPolicyTest {

RateDiscountPolicy discountPolicy = new RateDiscountPolicy();
@Test

@DisplayName("VIPλ”  10% ν• μΈπ•”  μ μ©λμ–΄μ•Ό  ν•λ‹¤.")
void vip_o() {

//given

Member member = new Member(1L, "memberVIP", Grade.VIP);

//when

int discount = discountPolicy.discount(member, 10000);

//then
assertThat(discount).isEqualTo(1000);

}

@Test

@DisplayName("VIPκ°€  μ•„λ‹λ©΄  ν• μΈπ•”  μ μ©λμ§€  μ•μ•„μ•Ό  ν•λ‹¤.")
void vip_x() {

//given

Member member = new Member(2L, "memberBASIC", Grade.BASIC);

//when

int discount = discountPolicy.discount(member, 10000);

//then
assertThat(discount).isEqualTo(0);

}

}

```

**ν• μΈμ •μ±…μ„ μ¶”κ°€ν•κ³  ν…μ¤νΈ κΉμ§€ μ™„λ£ν–λ‹¤.**

μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 

**λ°©κΈ μ¶”κ°€ν• ν• μΈ μ •μ±…μ„ μ μ©ν•΄λ³΄μ.**


ν• μΈ μ •μ±…μ„ μ• ν”λ¦¬μΌ€μ΄μ…μ— μ μ©ν•΄λ³΄μ.

ν• μΈ μ •μ±…μ„ λ³€κ²½ν•λ ¤λ©΄ ν΄λΌπ•”μ–ΈνΈμΈ OrderServiceImpl μ½”λ“λ¥Ό κ³ μ³μ•Ό ν•λ‹¤.

```

public class OrderServiceImpl implements OrderService {

//    private final DiscountPolicy discountPolicy = new FixDiscountPolicy();
private final DiscountPolicy discountPolicy = new RateDiscountPolicy();

}

```

**λ¬Έμ μ  λ°κ²¬**

μ°λ¦¬λ” μ—­ν• κ³Ό κµ¬ν„μ„ μ¶©μ‹¤ν•κ² λ¶„λ¦¬ν–λ‹¤.     OK

λ‹¤ν•μ„±λ„ ν™μ©ν•κ³ , μΈν„°νπ•”μ¤μ™€ κµ¬ν„ κ°μ²΄λ¥Ό λ¶„λ¦¬ν–λ‹¤.     OK
OCP, DIP κ°™μ€ κ°μ²΄μ§€ν–¥ μ„¤κ³„ μ›μΉ™μ„ μ¶©μ‹¤ν μ¤€μν–λ‹¤

κ·Έλ ‡κ² λ³΄π•”μ§€λ§ μ‚¬μ‹¤μ€ μ•„λ‹λ‹¤.

DIP: μ£Όλ¬Έμ„λΉ„μ¤ ν΄λΌπ•”μ–ΈνΈ( OrderServiceImpl )λ” DiscountPolicy μΈν„°νπ•”μ¤μ— μμ΅΄ν•λ©΄μ„ DIPλ¥Ό
μ§€ν‚¨ κ²ƒ κ°™μ€λ°?

ν΄λμ¤ μμ΅΄κ΄€κ³„λ¥Ό λ¶„μ„ν•΄ λ³΄μ. μ¶”μƒ(μΈν„°νπ•”μ¤) λΏλ§ μ•„λ‹λΌ **κµ¬μ²΄(κµ¬ν„) ν΄λμ¤μ—λ„ μμ΅΄**ν•κ³  μλ‹¤.
μ¶”μƒ(μΈν„°νπ•”μ¤) μμ΅΄:  DiscountPolicy

κµ¬μ²΄(κµ¬ν„) ν΄λμ¤:  FixDiscountPolicy ,  RateDiscountPolicy

OCP: λ³€κ²½ν•μ§€ μ•κ³  ν™•μ¥ν•  μ μλ‹¤κ³  ν–λ”λ°!

**μ§€κΈ μ½”λ“λ” κΈ°λ¥μ„ ν™•μ¥ν•΄μ„ λ³€κ²½ν•λ©΄, ν΄λΌμ΄μ–ΈνΈ μ½”λ“μ— μν–¥μ„ μ¤€λ‹¤!**                   λ”°λΌμ„ **OCPλ¥Ό μ„λ°**ν•λ‹¤.

**μ™ ν΄λΌμ΄μ–ΈνΈ μ½”λ“λ¥Ό λ³€κ²½ν•΄μ•Ό ν• κΉ?**

ν΄λμ¤ λ‹¤π•”μ–΄κ·Έλ¨μΌλ΅ μμ΅΄κ΄€κ³„λ¥Ό λ¶„μ„ν•΄λ³΄μ.

**κΈ°λ€ν–λ μμ΅΄κ΄€κ³„**


μ§€κΈκΉμ§€ λ‹¨μν DiscountPolicy μΈν„°νπ•”μ¤λ§ μμ΅΄ν•λ‹¤κ³  μƒκ°ν–λ‹¤.

**μ‹¤μ  μμ΅΄κ΄€κ³„**

μλ³΄λ©΄ ν΄λΌπ•”μ–ΈνΈμΈ OrderServiceImpl π•” DiscountPolicy μΈν„°νπ•”μ¤ λΏλ§ μ•„λ‹λΌ

FixDiscountPolicy μΈ κµ¬μ²΄ ν΄λμ¤λ„ ν•¨κ» μμ΅΄ν•κ³  μλ‹¤. μ‹¤μ  μ½”λ“λ¥Ό λ³΄λ©΄ μμ΅΄ν•κ³  μλ‹¤! **DIP μ„λ°**

**μ •μ±… λ³€κ²½**


**μ¤‘μ”!:**                   κ·Έλμ„ FixDiscountPolicy λ¥Ό RateDiscountPolicy λ΅ λ³€κ²½ν•λ” μκ°„ OrderServiceImpl μ 
μ†μ¤
μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•΄μ•Ό ν•λ‹¤! **OCP μ„λ°**

μ–΄λ–»κ² λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μμ„κ°€?

ν΄λΌπ•”μ–ΈνΈ μ½”λ“μΈ OrderServiceImpl μ€ DiscountPolicy μ μΈν„°νπ•”μ¤ λΏλ§ μ•„λ‹λΌ κµ¬μ²΄ ν΄λμ¤λ„ ν•¨
κ» μμ΅΄ν•λ‹¤.

κ·Έλμ„ κµ¬μ²΄ ν΄λμ¤λ¥Ό λ³€κ²½ν•  λ• ν΄λΌπ•”μ–ΈνΈ μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•΄μ•Ό ν•λ‹¤.

**DIP μ„λ°**                                                                                        
μ¶”μƒμ—λ§ μμ΅΄ν•λ„λ΅ λ³€κ²½(μΈν„°νπ•”μ¤μ—λ§ μμ΅΄)

DIPλ¥Ό μ„λ°ν•μ§€ μ•λ„λ΅ μΈν„°νπ•”μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μμ΅΄κ΄€κ³„λ¥Ό λ³€κ²½ν•λ©΄ λλ‹¤.

**μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ„¤κ³„λ¥Ό λ³€κ²½ν•μ**


**μΈν„°νμ΄μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“ λ³€κ²½**

```

public class OrderServiceImpl implements OrderService {

//private final DiscountPolicy discountPolicy = new RateDiscountPolicy();
private DiscountPolicy discountPolicy;

}

```

μΈν„°νπ•”μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ„¤κ³„μ™€ μ½”λ“λ¥Ό λ³€κ²½ν–λ‹¤.

**κ·Έλ°λ° κµ¬ν„μ²΄κ°€ μ—†λ”λ° μ–΄λ–»κ² μ½”λ“λ¥Ό μ‹¤ν–‰ν•  μ μμ„κΉ?**

μ‹¤μ  μ‹¤ν–‰μ„ ν•΄λ³΄λ©΄ NPE(null pointer exception)κ°€ λ°μƒν•λ‹¤.

**ν•΄κ²°λ°©μ•**

π•” λ¬Έμ λ¥Ό ν•΄κ²°ν•λ ¤λ©΄ λ„κµ°κ°€κ°€ ν΄λΌπ•”μ–ΈνΈμΈ OrderServiceImpl μ— DiscountPolicy μ κµ¬ν„ κ°μ²΄λ¥Ό λ€
μ‹  μƒμ„±ν•κ³  μ£Όμ…ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤.

κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬

μ• ν”λ¦¬μΌ€π•”μ…μ„ ν•λ‚μ κ³µμ—°π•”λΌ μƒκ°ν•΄λ³΄μ. κ°κ°μ μΈν„°νπ•”μ¤λ¥Ό λ°°μ—­(λ°°μ° μ—­ν• )π•”λΌ μƒκ°ν•μ. κ·Έλ°λ°! μ‹¤μ 
λ°°μ—­ λ§λ” λ°°μ°λ¥Ό μ„ νƒν•λ” κ²ƒμ€ λ„κ°€ ν•λ”κ°€?

λ΅λ―Έμ¤μ™€ μ¤„λ¦¬μ—£ κ³µμ—°μ„ ν•λ©΄ λ΅λ―Έμ¤ μ—­ν• μ„ λ„κ°€ ν• μ§€ μ¤„λ¦¬μ—£ μ—­ν• μ„ λ„κ°€ ν• μ§€λ” λ°°μ°λ“¤π•” μ •ν•λ”κ² μ•„λ‹λ‹¤. π•”
μ „ μ½”λ“λ” λ§μΉ λ΅λ―Έμ¤ μ—­ν• (μΈν„°νπ•”μ¤)μ„ ν•λ” λ μ¤λ‚λ¥΄λ„ λ””μΉ΄ν”„λ¦¬μ¤(κµ¬ν„μ²΄, λ°°μ°)κ°€ μ¤„λ¦¬μ—£ μ—­ν• (μΈν„°νπ•”


μ¤)μ„ ν•λ” μ—¬μ μ£ΌμΈκ³µ(κµ¬ν„μ²΄, λ°°μ°)μ„ μ§μ ‘ μ΄λΉ™ν•λ” κ²ƒκ³Ό κ°™λ‹¤. λ””μΉ΄ν”„λ¦¬μ¤λ” κ³µμ—°λ„ ν•΄μ•Όν•κ³  λ™μ‹μ— μ—¬μ μ£Ό
μΈκ³µλ„ κ³µμ—°μ— μ§μ ‘ μ΄λΉ™ν•΄μ•Ό ν•λ” **λ‹¤μ–‘ν• μ±…μ„**μ„ κ°€μ§€κ³  μλ‹¤.

**κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•μ**

λ°°μ°λ” λ³ΈμΈμ μ—­ν• μΈ λ°°μ—­μ„ μν–‰ν•λ” κ²ƒμ—λ§ μ§‘μ¤‘ν•΄μ•Ό ν•λ‹¤.

λ””μΉ΄ν”„λ¦¬μ¤λ” μ–΄λ–¤ μ—¬μ μ£ΌμΈκ³µπ•” μ„ νƒλλ”λΌλ„ λ‘κ°™π•” κ³µμ—°μ„ ν•  μ μμ–΄μ•Ό ν•λ‹¤.

κ³µμ—°μ„ κµ¬μ„±ν•κ³ , λ‹΄λ‹Ή λ°°μ°λ¥Ό μ„­μ™Έν•κ³ , μ—­ν• μ— λ§λ” λ°°μ°λ¥Ό μ§€μ •ν•λ” μ±…μ„μ„ λ‹΄λ‹Ήν•λ” λ³„λ„μ **κ³µμ—° κΈ°νμ**κ°€ λ‚
μ¬μ‹μ π•”λ‹¤.

κ³µμ—° κΈ°νμλ¥Ό λ§λ“¤κ³ , λ°°μ°μ™€ κ³µμ—° κΈ°νμμ μ±…μ„μ„ ν™•μ‹¤ν λ¶„λ¦¬ν•μ.

AppCOnfig λ“±μ¥

μ• ν”λ¦¬μΌ€π•”μ…μ μ „μ²΄ λ™μ‘ λ°©μ‹μ„ κµ¬μ„±(config)ν•κΈ° μ„ν•΄, **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±**ν•κ³ , **μ—°κ²°**ν•λ” μ±…μ„μ„ κ°€μ§€λ” λ³„λ„μ
μ„¤μ • ν΄λμ¤λ¥Ό λ§λ“¤μ.

**AppConfig**

```

package hello.core;

import hello.core.discount.FixDiscountPolicy;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;

import hello.core.order.OrderServiceImpl;
public class AppConfig {

public MemberService memberService() {

return new MemberServiceImpl(new MemoryMemberRepository());

}

public OrderService orderService() {
return new OrderServiceImpl(

new MemoryMemberRepository(),
new FixDiscountPolicy());

}

}

```


AppConfigλ” μ• ν”λ¦¬μΌ€π•”μ…μ μ‹¤μ  λ™μ‘μ— ν•„μ”ν• **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±**ν•λ‹¤.

MemberServiceImpl
MemoryMemberRepository
OrderServiceImpl

FixDiscountPolicy

AppConfigλ” μƒμ„±ν• κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°(λ νΌλ°μ¤)λ¥Ό **μƒμ„±μλ¥Ό ν†µν•΄μ„ μ£Όμ…(μ—°κ²°)**ν•΄μ¤€λ‹¤.

MemberServiceImpl   MemoryMemberRepository

OrderServiceImpl   MemoryMemberRepository ,  FixDiscountPolicy

μ°Έκ³ : μ§€κΈμ€ κ° ν΄λμ¤μ— μƒμ„±μκ°€ μ—†μ–΄μ„ μ»΄νμΌ μ¤λ¥κ°€ λ°μƒν•λ‹¤. λ°”λ΅ λ‹¤μμ— μ½”λ“μ—μ„ μƒμ„±μλ¥Ό λ§λ“ λ‹¤.

**MemberServiceImpl - μƒμ„±μ μ£Όμ…**

```

package hello.core.member;

public class MemberServiceImpl implements MemberService {
private final MemberRepository memberRepository;

public MemberServiceImpl(MemberRepository memberRepository) {
this.memberRepository = memberRepository;

}

public void join(Member member) {
memberRepository.save(member);

}

public Member findMember(Long memberId) {
return memberRepository.findById(memberId);

}

}


```

μ„¤κ³„ λ³€κ²½μΌλ΅ MemberServiceImpl μ€ MemoryMemberRepository λ¥Ό μμ΅΄ν•μ§€ μ•λ”λ‹¤!
λ‹¨μ§€ MemberRepository μΈν„°νπ•”μ¤λ§ μμ΅΄ν•λ‹¤.

MemberServiceImpl μ…μ¥μ—μ„ μƒμ„±μλ¥Ό ν†µν•΄ μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ λ“¤μ–΄μ¬μ§€(μ£Όμ…λ μ§€)λ” μ• μ μ—†λ‹¤.
MemberServiceImpl μ μƒμ„±μλ¥Ό ν†µν•΄μ„ μ–΄λ–¤ κµ¬ν„ κ°μ²΄λ¥Ό μ£Όμ…ν• μ§€λ” μ¤μ§ μ™Έλ¶€( AppConfig )μ—μ„ κ²°μ •λ
λ‹¤.


MemberServiceImpl μ€ π•”μ λ¶€ν„° **μμ΅΄κ΄€κ³„μ— λ€ν• κ³ λ―Όμ€ μ™Έλ¶€**μ— λ§΅κΈ°κ³  **μ‹¤ν–‰μ—λ§ μ§‘μ¤‘**ν•λ©΄ λλ‹¤.

**κ·Έλ¦Ό - ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨**

κ°μ²΄μ μƒμ„±κ³Ό μ—°κ²°μ€ AppConfig κ°€ λ‹΄λ‹Ήν•λ‹¤.

**DIP μ™„μ„±:**                               MemberServiceImpl μ€ MemberRepository μΈ μ¶”μƒμ—λ§ μμ΅΄ν•λ©΄ λλ‹¤. π•”μ  
κµ¬μ²΄ ν΄λμ¤λ¥Ό
λ°λΌλ„ λλ‹¤.

**κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬:**                   κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ—­ν• κ³Ό μ‹¤ν–‰ν•λ” μ—­ν• π•” λ…ν™•ν λ¶„λ¦¬λμ—λ‹¤.

**κ·Έλ¦Ό - νμ› κ°μ²΄ μΈμ¤ν„΄μ¤ λ‹¤μ΄μ–΄κ·Έλ¨**


appConfig κ°μ²΄λ” memoryMemberRepository κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ·Έ μ°Έμ΅°κ°’μ„ memberServiceImpl μ„
μƒμ„±ν•λ©΄μ„ μƒμ„±μλ΅ μ „λ‹¬ν•λ‹¤.

ν΄λΌπ•”μ–ΈνΈμΈ memberServiceImpl μ…μ¥μ—μ„ λ³΄λ©΄ μμ΅΄κ΄€κ³„λ¥Ό λ§μΉ μ™Έλ¶€μ—μ„ μ£Όμ…ν•΄μ£Όλ” κ²ƒ κ°™λ‹¤κ³  ν•΄μ„

DI(Dependency Injection) μ°λ¦¬λ§λ΅ μμ΅΄κ΄€κ³„ μ£Όμ… λλ” μμ΅΄μ„± μ£Όμ…π•”λΌ ν•λ‹¤.

**OrderServiceImpl - μƒμ„±μ μ£Όμ…**

```

package hello.core.order;

import hello.core.discount.DiscountPolicy;
import hello.core.member.Member;

import hello.core.member.MemberRepository;

public class OrderServiceImpl implements OrderService {

private final MemberRepository memberRepository;
private final DiscountPolicy discountPolicy;

public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy
discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

@Override

public Order createOrder(Long memberId, String itemName, int itemPrice) {
Member member = memberRepository.findById(memberId);


int discountPrice = discountPolicy.discount(member, itemPrice);

return new Order(memberId, itemName, itemPrice, discountPrice);

}

}


```

μ„¤κ³„ λ³€κ²½μΌλ΅ OrderServiceImpl μ€ FixDiscountPolicy λ¥Ό μμ΅΄ν•μ§€ μ•λ”λ‹¤!
λ‹¨μ§€ DiscountPolicy μΈν„°νπ•”μ¤λ§ μμ΅΄ν•λ‹¤.

OrderServiceImpl μ…μ¥μ—μ„ μƒμ„±μλ¥Ό ν†µν•΄ μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ λ“¤μ–΄μ¬μ§€(μ£Όμ…λ μ§€)λ” μ• μ μ—†λ‹¤.
OrderServiceImpl μ μƒμ„±μλ¥Ό ν†µν•΄μ„ μ–΄λ–¤ κµ¬ν„ κ°μ²΄μ„ μ£Όμ…ν• μ§€λ” μ¤μ§ μ™Έλ¶€( AppConfig )μ—μ„ κ²°μ •ν•
λ‹¤.

OrderServiceImpl μ€ π•”μ λ¶€ν„° μ‹¤ν–‰μ—λ§ μ§‘μ¤‘ν•λ©΄ λλ‹¤.

OrderServiceImpl μ—λ” MemoryMemberRepository ,  FixDiscountPolicy κ°μ²΄μ μμ΅΄κ΄€κ³„κ°€ μ£Ό
μ…λλ‹¤.

AppCOnfig μ‹¤ν–‰

**μ‚¬μ© ν΄λμ¤ - MemberApp**

```

package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;

import hello.core.member.MemberService;
public class MemberApp {

public static void main(String[] args) {
AppConfig appConfig = new AppConfig();

MemberService memberService = appConfig.memberService();
Member member = new Member(1L, "memberA", Grade.VIP);
memberService.join(member);

Member findMember = memberService.findMember(1L);
System.out.println("new member = " + member.getName());
System.out.println("find Member = " + findMember.getName());

}

}

```


**μ‚¬μ© ν΄λμ¤ - OrderApp**

```

package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;

import hello.core.member.MemberService;
import hello.core.order.Order;

import hello.core.order.OrderService;
public class OrderApp {

public static void main(String[] args) {
AppConfig appConfig = new AppConfig();

MemberService memberService = appConfig.memberService();
OrderService orderService = appConfig.orderService();

long memberId = 1L;

Member member = new Member(memberId, "memberA", Grade.VIP);
memberService.join(member);

Order order = orderService.createOrder(memberId, "itemA", 10000);
System.out.println("order = " + order);

}

}

```

**ν…μ¤νΈ μ½”λ“ μ¤λ¥ μμ •**

```

class MemberServiceTest {
MemberService memberService;

@BeforeEach

public void beforeEach() {

AppConfig appConfig = new AppConfig();
memberService = appConfig.memberService();

}

}

```

```


class OrderServiceTest {

MemberService memberService;
OrderService orderService;

@BeforeEach

public void beforeEach() {

AppConfig appConfig = new AppConfig();
memberService = appConfig.memberService();
orderService = appConfig.orderService();

}

}

```

ν…μ¤νΈ μ½”λ“μ—μ„ @BeforeEach λ” κ° ν…μ¤νΈλ¥Ό μ‹¤ν–‰ν•κΈ° μ „μ— νΈμ¶λλ‹¤.


**μ •λ¦¬**

AppConfigλ¥Ό ν†µν•΄μ„ κ΄€μ‹¬μ‚¬λ¥Ό ν™•μ‹¤ν•κ² λ¶„λ¦¬ν–λ‹¤.
λ°°μ—­, λ°°μ°λ¥Ό μƒκ°ν•΄λ³΄μ.

AppConfigλ” κ³µμ—° κΈ°νμλ‹¤.

AppConfigλ” κµ¬μ²΄ ν΄λμ¤λ¥Ό μ„ νƒν•λ‹¤. λ°°μ—­μ— λ§λ” λ‹΄λ‹Ή λ°°μ°λ¥Ό μ„ νƒν•λ‹¤. μ• ν”λ¦¬μΌ€π•”μ…π•” μ–΄λ–»κ² λ™μ‘ν•΄μ•Ό ν• 
μ§€ μ „μ²΄ κµ¬μ„±μ„ μ±…μ„μ§„λ‹¤.

π•”μ  κ° λ°°μ°λ“¤μ€ λ‹΄λ‹Ή κΈ°λ¥μ„ μ‹¤ν–‰ν•λ” μ±…μ„λ§ μ§€λ©΄ λλ‹¤.

OrderServiceImpl μ€ κΈ°λ¥μ„ μ‹¤ν–‰ν•λ” μ±…μ„λ§ μ§€λ©΄ λλ‹¤.

AppCOnfig λ¦¬ν©ν„°λ§

ν„μ¬ AppConfigλ¥Ό λ³΄λ©΄ **μ¤‘λ³µ**π•” μκ³ , **μ—­ν• **μ— λ”°λ¥Έ **κµ¬ν„**π•” μ μ•λ³΄μΈλ‹¤.

**κΈ°λ€ν•λ” κ·Έλ¦Ό**


**λ¦¬ν©ν„°λ§ μ „**

```

package hello.core;

import hello.core.discount.FixDiscountPolicy;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;

import hello.core.order.OrderServiceImpl;
public class AppConfig {

public MemberService memberService() {

return new MemberServiceImpl(new MemoryMemberRepository());

}

public OrderService orderService() {
return new OrderServiceImpl(

new MemoryMemberRepository(),
new FixDiscountPolicy());

}


}

```

μ¤‘λ³µμ„ μ κ±°ν•κ³ , μ—­ν• μ— λ”°λ¥Έ κµ¬ν„π•” λ³΄π•”λ„λ΅ λ¦¬ν©ν„°λ§ ν•μ.

**λ¦¬ν©ν„°λ§ ν›„**

```

package hello.core;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.member.MemberRepository;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;

import hello.core.order.OrderServiceImpl;
public class AppConfig {

public MemberService memberService() {

return new MemberServiceImpl(memberRepository());

}

public OrderService orderService() {
return new OrderServiceImpl(

memberRepository(),
discountPolicy());

}

public MemberRepository memberRepository() {
return new MemoryMemberRepository();

}

public DiscountPolicy discountPolicy() {
return new FixDiscountPolicy();

}

}


```

new MemoryMemberRepository() π•” λ¶€λ¶„π•” μ¤‘λ³µ μ κ±°λμ—λ‹¤. π•”μ  MemoryMemberRepository λ¥Ό
λ‹¤λ¥Έ κµ¬ν„μ²΄λ΅ λ³€κ²½ν•  λ• ν• λ¶€λ¶„λ§ λ³€κ²½ν•λ©΄ λλ‹¤.

AppConfig λ¥Ό λ³΄λ©΄ μ—­ν• κ³Ό κµ¬ν„ ν΄λμ¤κ°€ ν•λμ— λ“¤μ–΄μ¨λ‹¤. μ• ν”λ¦¬μΌ€π•”μ… μ „μ²΄ κµ¬μ„±π•” μ–΄λ–»κ² λμ–΄μλ”μ§€ λΉ λ¥΄
κ² νμ•…ν•  μ μλ‹¤.


μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

μ²μμΌλ΅ λμ•„κ°€μ„ μ •μ•΅ ν• μΈ μ •μ±…μ„ μ •λ¥ % ν• μΈ μ •μ±…μΌλ΅ λ³€κ²½ν•΄λ³΄μ.

FixDiscountPolicy     RateDiscountPolicy

μ–΄λ–¤ λ¶€λ¶„λ§ λ³€κ²½ν•λ©΄ λκ² λ”κ°€?

**AppConfigμ λ“±μ¥μΌλ΅ μ• ν”λ¦¬μΌ€μ΄μ…μ΄ ν¬κ² μ‚¬μ© μμ—­κ³Ό, κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κµ¬μ„±(Configuration)ν•λ” μμ—­μΌλ΅ λ¶„
λ¦¬λμ—λ‹¤.**

**κ·Έλ¦Ό - μ‚¬μ©, κµ¬μ„±μ λ¶„λ¦¬**

**κ·Έλ¦Ό - ν• μΈ μ •μ±…μ λ³€κ²½**


FixDiscountPolicy   RateDiscountPolicy λ΅ λ³€κ²½ν•΄λ„ κµ¬μ„± μμ—­λ§ μν–¥μ„ λ°›κ³ , μ‚¬μ© μμ—­μ€ μ „ν€
μν–¥μ„ λ°›μ§€ μ•λ”λ‹¤.

**ν• μΈ μ •μ±… λ³€κ²½ κµ¬μ„± μ½”λ“**

```

package hello.core;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.discount.RateDiscountPolicy;
import hello.core.member.MemberRepository;
import hello.core.member.MemberService;

import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;

import hello.core.order.OrderServiceImpl;
public class AppConfig {

public MemberService memberService() {

return new MemberServiceImpl(memberRepository());

}


public OrderService orderService() {
return new OrderServiceImpl(

memberRepository(),
discountPolicy());

}

public MemberRepository memberRepository() {
return new MemoryMemberRepository();

}

public DiscountPolicy discountPolicy() {

//        return new FixDiscountPolicy();
return new RateDiscountPolicy();

}

}

```

AppConfig μ—μ„ ν• μΈ μ •μ±… μ—­ν• μ„ λ‹΄λ‹Ήν•λ” κµ¬ν„μ„ FixDiscountPolicy   RateDiscountPolicy κ°
μ²΄λ΅ λ³€κ²½ν–λ‹¤.

π•”μ  ν• μΈ μ •μ±…μ„ λ³€κ²½ν•΄λ„, μ• ν”λ¦¬μΌ€π•”μ…μ κµ¬μ„± μ—­ν• μ„ λ‹΄λ‹Ήν•λ” AppConfigλ§ λ³€κ²½ν•λ©΄ λλ‹¤. ν΄λΌπ•”μ–ΈνΈ μ½”
λ“μΈ OrderServiceImpl λ¥Ό ν¬ν•¨ν•΄μ„ **μ‚¬μ© μμ—­**μ μ–΄λ–¤ μ½”λ“λ„ λ³€κ²½ν•  ν•„μ”κ°€ μ—†λ‹¤.

**κµ¬μ„± μμ—­**μ€ λ‹Ήμ—°ν λ³€κ²½λλ‹¤. κµ¬μ„± μ—­ν• μ„ λ‹΄λ‹Ήν•λ” AppConfigλ¥Ό μ• ν”λ¦¬μΌ€π•”μ…π•”λΌλ” κ³µμ—°μ κΈ°νμλ΅ μƒκ°ν•
μ. κ³µμ—° κΈ°νμλ” κ³µμ—° μ°Έμ—¬μμΈ κµ¬ν„ κ°μ²΄λ“¤μ„ λ¨λ‘ μ•μ•„μ•Ό ν•λ‹¤.

μ „μ²΄ νλ¦„ μ •λ¦¬

μ§€κΈκΉμ§€μ νλ¦„μ„ μ •λ¦¬ν•΄λ³΄μ.

μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°

μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ 
κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬

AppConfig λ¦¬ν©ν„°λ§


μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©

**μƒλ΅μ΄ ν• μΈ μ •μ±… κ°λ°**

λ‹¤ν•μ„± λ•λ¶„μ— μƒλ΅μ΄ μ •λ¥  ν• μΈ μ •μ±… μ½”λ“λ¥Ό μ¶”κ°€λ΅ κ°λ°ν•λ” κ²ƒ μμ²΄λ” μ•„λ¬΄ λ¬Έμ κ°€ μ—†μ

**μƒλ΅μ΄ ν• μΈ μ •μ±… μ μ©κ³Ό λ¬Έμ μ **

μƒλ΅ κ°λ°ν• μ •λ¥  ν• μΈ μ •μ±…μ„ μ μ©ν•λ ¤κ³  ν•λ‹ **ν΄λΌμ΄μ–ΈνΈ μ½”λ“**μΈ μ£Όλ¬Έ μ„λΉ„μ¤ κµ¬ν„μ²΄λ„ ν•¨κ» λ³€κ²½ν•΄μ•Όν•¨

μ£Όλ¬Έ μ„λΉ„μ¤ ν΄λΌπ•”μ–ΈνΈκ°€ μΈν„°νπ•”μ¤μΈ DiscountPolicy λΏλ§ μ•„λ‹λΌ, κµ¬μ²΄ ν΄λμ¤μΈ FixDiscountPolicy λ„
ν•¨κ» μμ΅΄    **DIP μ„λ°**

**κ΄€μ‹¬μ‚¬μ λ¶„λ¦¬**

μ• ν”λ¦¬μΌ€π•”μ…μ„ ν•λ‚μ κ³µμ—°μΌλ΅ μƒκ°

κΈ°μ΅΄μ—λ” ν΄λΌπ•”μ–ΈνΈκ°€ μμ΅΄ν•λ” μ„λ²„ κµ¬ν„ κ°μ²΄λ¥Ό μ§μ ‘ μƒμ„±ν•κ³ , μ‹¤ν–‰ν•¨

λΉ„μ λ¥Ό ν•λ©΄ κΈ°μ΅΄μ—λ” λ‚¨μ μ£ΌμΈκ³µ λ°°μ°κ°€ κ³µμ—°λ„ ν•κ³ , λ™μ‹μ— μ—¬μ μ£ΌμΈκ³µλ„ μ§μ ‘ μ΄λΉ™ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€
κ³  μμ

κ³µμ—°μ„ κµ¬μ„±ν•κ³ , λ‹΄λ‹Ή λ°°μ°λ¥Ό μ„­μ™Έν•κ³ , μ§€μ •ν•λ” μ±…μ„μ„ λ‹΄λ‹Ήν•λ” λ³„λ„μ **κ³µμ—° κΈ°νμ**κ°€ λ‚μ¬ μ‹μ 
κ³µμ—° κΈ°νμμΈ AppConfigκ°€ λ“±μ¥

AppConfigλ” μ• ν”λ¦¬μΌ€π•”μ…μ μ „μ²΄ λ™μ‘ λ°©μ‹μ„ κµ¬μ„±(config)ν•κΈ° μ„ν•΄, **κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±**ν•κ³ , **μ—°κ²°**ν•λ” μ±…μ„

π•”μ λ¶€ν„° ν΄λΌπ•”μ–ΈνΈ κ°μ²΄λ” μμ‹ μ μ—­ν• μ„ μ‹¤ν–‰ν•λ” κ²ƒλ§ μ§‘μ¤‘, κ¶ν•π•” μ¤„μ–΄λ“¬(μ±…μ„π•” λ…ν™•ν•΄μ§)

**AppConfig λ¦¬ν©ν„°λ§**

κµ¬μ„± μ •λ³΄μ—μ„ μ—­ν• κ³Ό κµ¬ν„μ„ λ…ν™•ν•κ² λ¶„λ¦¬
μ—­ν• π•” μ λ“λ¬λ‚¨

μ¤‘λ³µ μ κ±°

**μƒλ΅μ΄ κµ¬μ΅°μ™€ ν• μΈ μ •μ±… μ μ©**

μ •μ•΅ ν• μΈ μ •μ±…    μ •λ¥ % ν• μΈ μ •μ±…μΌλ΅ λ³€κ²½

AppConfigμ λ“±μ¥μΌλ΅ μ• ν”λ¦¬μΌ€π•”μ…π•” ν¬κ² **μ‚¬μ© μμ—­**κ³Ό, κ°μ²΄λ¥Ό μƒμ„±ν•κ³  **κµ¬μ„±(Configuration)ν•λ” μμ—­**μΌ
λ΅ λ¶„λ¦¬

ν• μΈ μ •μ±…μ„ λ³€κ²½ν•΄λ„ AppConfigκ°€ μλ” κµ¬μ„± μμ—­λ§ λ³€κ²½ν•λ©΄ λ¨, μ‚¬μ© μμ—­μ€ λ³€κ²½ν•  ν•„μ”κ°€ μ—†μ. λ¬Όλ΅  ν΄λΌ

π•”μ–ΈνΈ μ½”λ“μΈ μ£Όλ¬Έ μ„λΉ„μ¤ μ½”λ“λ„ λ³€κ²½ν•μ§€ μ•μ


μΆ‹μ€ κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ 5κ°€μ§€ μ›μΉ™μ μ μ©

μ—¬κΈ°μ„ 3κ°€μ§€ SRP, DIP, OCP μ μ©

SRP λ‹¨μΌ μ±…μ„ μ›μΉ™

**ν• ν΄λμ¤λ” ν•λ‚μ μ±…μ„λ§ κ°€μ Έμ•Ό ν•λ‹¤.**

ν΄λΌπ•”μ–ΈνΈ κ°μ²΄λ” μ§μ ‘ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν•λ” λ‹¤μ–‘ν• μ±…μ„μ„ κ°€μ§€κ³  μμ

SRP λ‹¨μΌ μ±…μ„ μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ κ΄€μ‹¬μ‚¬λ¥Ό λ¶„λ¦¬ν•¨

κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ—°κ²°ν•λ” μ±…μ„μ€ AppConfigκ°€ λ‹΄λ‹Ή
ν΄λΌπ•”μ–ΈνΈ κ°μ²΄λ” μ‹¤ν–‰ν•λ” μ±…μ„λ§ λ‹΄λ‹Ή

DIP μμ΅΄κ΄€κ³„ μ—­μ „ μ›μΉ™

**ν”„λ΅κ·Έλλ¨Έλ” β€μ¶”μƒν™”μ— μμ΅΄ν•΄μ•Όμ§€, κµ¬μ²΄ν™”μ— μμ΅΄ν•λ©΄ μ•λλ‹¤.β€ μμ΅΄μ„± μ£Όμ…μ€ μ΄ μ›μΉ™μ„ λ”°λ¥΄λ” λ°©λ²• μ¤‘ ν•λ‚λ‹¤.**

μƒλ΅μ΄ ν• μΈ μ •μ±…μ„ κ°λ°ν•κ³ , μ μ©ν•λ ¤κ³  ν•λ‹ ν΄λΌπ•”μ–ΈνΈ μ½”λ“λ„ ν•¨κ» λ³€κ²½ν•΄μ•Ό ν–λ‹¤. μ™λƒν•λ©΄ κΈ°μ΅΄ ν΄λΌπ•”μ–Έ
νΈ μ½”λ“( OrderServiceImpl )λ” DIPλ¥Ό μ§€ν‚¤λ©° DiscountPolicy μ¶”μƒν™” μΈν„°νπ•”μ¤μ— μμ΅΄ν•λ” κ²ƒ κ°™μ•
μ§€λ§,  FixDiscountPolicy κµ¬μ²΄ν™” κµ¬ν„ ν΄λμ¤μ—λ„ ν•¨κ» μμ΅΄ν–λ‹¤.

ν΄λΌπ•”μ–ΈνΈ μ½”λ“κ°€ DiscountPolicy μ¶”μƒν™” μΈν„°νπ•”μ¤μ—λ§ μμ΅΄ν•λ„λ΅ μ½”λ“λ¥Ό λ³€κ²½ν–λ‹¤.
ν•μ§€λ§ ν΄λΌπ•”μ–ΈνΈ μ½”λ“λ” μΈν„°νπ•”μ¤λ§μΌλ΅λ” μ•„λ¬΄κ²ƒλ„ μ‹¤ν–‰ν•  μ μ—†λ‹¤.

AppConfigκ°€ FixDiscountPolicy κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό ν΄λΌπ•”μ–ΈνΈ μ½”λ“ λ€μ‹  μƒμ„±ν•΄μ„ ν΄λΌπ•”μ–ΈνΈ μ½”λ“μ— μ
μ΅΄κ΄€κ³„λ¥Ό μ£Όμ…ν–λ‹¤. π•”λ ‡κ²ν•΄μ„ DIP μ›μΉ™μ„ λ”°λ¥΄λ©΄μ„ λ¬Έμ λ„ ν•΄κ²°ν–λ‹¤.

OCP

**μ†ν”„νΈμ›¨μ–΄ μ”μ†λ” ν™•μ¥μ—λ” μ—΄λ ¤ μμΌλ‚ λ³€κ²½μ—λ” λ‹«ν€ μμ–΄μ•Ό ν•λ‹¤**

λ‹¤ν•μ„± μ‚¬μ©ν•κ³  ν΄λΌπ•”μ–ΈνΈκ°€ DIPλ¥Ό μ§€ν‚΄
μ• ν”λ¦¬μΌ€π•”μ…μ„ μ‚¬μ© μμ—­κ³Ό κµ¬μ„± μμ—­μΌλ΅ λ‚λ”

AppConfigκ°€ μμ΅΄κ΄€κ³„λ¥Ό FixDiscountPolicy   RateDiscountPolicy λ΅ λ³€κ²½ν•΄μ„ ν΄λΌπ•”μ–ΈνΈ μ½”λ“
μ— μ£Όμ…ν•λ―€λ΅ ν΄λΌπ•”μ–ΈνΈ μ½”λ“λ” λ³€κ²½ν•μ§€ μ•μ•„λ„ λ¨

**μ†ν”„νΈμ›¨μ–΄ μ”μ†λ¥Ό μƒλ΅­κ² ν™•μ¥ν•΄λ„ μ‚¬μ© μμ—­μ λ³€κ²½μ€ λ‹«ν€ μλ‹¤!**


IOC, DI, κ·Έλ¦¬κ³  μ»¨ν…μ΄λ„

μ μ–΄μ μ—­μ „ IOC(InversiOn of COntrol)

κΈ°μ΅΄ ν”„λ΅κ·Έλ¨μ€ ν΄λΌπ•”μ–ΈνΈ κµ¬ν„ κ°μ²΄κ°€ μ¤μ¤λ΅ ν•„μ”ν• μ„λ²„ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ—°κ²°ν•κ³ , μ‹¤ν–‰ν–λ‹¤. ν•λ§λ””
λ΅ κµ¬ν„ κ°μ²΄κ°€ ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ„ μ¤μ¤λ΅ μ΅°μΆ…ν–λ‹¤. κ°λ°μ μ…μ¥μ—μ„λ” μμ—°μ¤λ¬μ΄ νλ¦„π•”λ‹¤.

λ°λ©΄μ— AppConfigκ°€ λ“±μ¥ν• π•”ν›„μ— κµ¬ν„ κ°μ²΄λ” μμ‹ μ λ΅μ§μ„ μ‹¤ν–‰ν•λ” μ—­ν• λ§ λ‹΄λ‹Ήν•λ‹¤. ν”„λ΅κ·Έλ¨μ μ μ–΄ ν
λ¦„μ€ π•”μ  AppConfigκ°€ κ°€μ Έκ°„λ‹¤. μλ¥Ό λ“¤μ–΄μ„ OrderServiceImpl μ€ ν•„μ”ν• μΈν„°νπ•”μ¤λ“¤μ„ νΈμ¶ν•μ§€λ§
μ–΄λ–¤ κµ¬ν„ κ°μ²΄λ“¤π•” μ‹¤ν–‰λ μ§€ λ¨λ¥Έλ‹¤.

ν”„λ΅κ·Έλ¨μ— λ€ν• μ μ–΄ νλ¦„μ— λ€ν• κ¶ν•μ€ λ¨λ‘ AppConfigκ°€ κ°€μ§€κ³  μλ‹¤. μ‹¬μ§€μ–΄ OrderServiceImpl λ„
AppConfigκ°€ μƒμ„±ν•λ‹¤. κ·Έλ¦¬κ³  AppConfigλ” OrderServiceImpl π•” μ•„λ‹ OrderService μΈν„°νπ•”μ¤μ
λ‹¤λ¥Έ κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  μ‹¤ν–‰ν•  μ λ„ μλ‹¤. κ·Έλ° μ‚¬μ‹¤λ„ λ¨λ¥Έμ²΄ OrderServiceImpl μ€ λ¬µλ¬µν μμ‹ μ λ΅μ§
μ„ μ‹¤ν–‰ν•  λΏπ•”λ‹¤.

π•”λ ‡λ“― ν”„λ΅κ·Έλ¨μ μ μ–΄ νλ¦„μ„ μ§μ ‘ μ μ–΄ν•λ” κ²ƒπ•” μ•„λ‹λΌ μ™Έλ¶€μ—μ„ κ΄€λ¦¬ν•λ” κ²ƒμ„ μ μ–΄μ μ—­μ „(IoC)π•”λΌ ν•λ‹¤.

**ν”„λ μ„μ›ν¬ vs λΌμ΄λΈλ¬λ¦¬**

ν”„λ μ„μ›ν¬κ°€ λ‚΄κ°€ μ‘μ„±ν• μ½”λ“λ¥Ό μ μ–΄ν•κ³ , λ€μ‹  μ‹¤ν–‰ν•λ©΄ κ·Έκ²ƒμ€ ν”„λ μ„μ›ν¬κ°€ λ§λ‹¤. (JUnit)

λ°λ©΄μ— λ‚΄κ°€ μ‘μ„±ν• μ½”λ“κ°€ μ§μ ‘ μ μ–΄μ νλ¦„μ„ λ‹΄λ‹Ήν•λ‹¤λ©΄ κ·Έκ²ƒμ€ ν”„λ μ„μ›ν¬κ°€ μ•„λ‹λΌ λΌπ•”λΈλ¬λ¦¬λ‹¤.

μμ΅΄κ΄€κ³„ μ£Όμ… DI(Dependency InjectiOn)

OrderServiceImpl μ€ DiscountPolicy μΈν„°νπ•”μ¤μ— μμ΅΄ν•λ‹¤. μ‹¤μ  μ–΄λ–¤ κµ¬ν„ κ°μ²΄κ°€ μ‚¬μ©λ μ§€λ” λ¨λ¥Έ
λ‹¤.

μμ΅΄κ΄€κ³„λ” **μ •μ μΈ ν΄λμ¤ μμ΅΄ κ΄€κ³„μ™€, μ‹¤ν–‰ μ‹μ μ— κ²°μ •λλ” λ™μ μΈ κ°μ²΄(μΈμ¤ν„΄μ¤) μμ΅΄ κ΄€κ³„**                   λ‘μ„ λ¶„λ¦¬ν•΄μ„ μƒ
κ°ν•΄μ•Ό ν•λ‹¤.

**μ •μ μΈ ν΄λμ¤ μμ΅΄κ΄€κ³„**

ν΄λμ¤κ°€ μ‚¬μ©ν•λ” import μ½”λ“λ§ λ³΄κ³  μμ΅΄κ΄€κ³„λ¥Ό μ‰½κ² νλ‹¨ν•  μ μλ‹¤. μ •μ μΈ μμ΅΄κ΄€κ³„λ” μ• ν”λ¦¬μΌ€π•”μ…μ„ μ‹¤ν–‰ν•μ§€
μ•μ•„λ„ λ¶„μ„ν•  μ μλ‹¤. ν΄λμ¤ λ‹¤π•”μ–΄κ·Έλ¨μ„ λ³΄μ

OrderServiceImpl μ€ MemberRepository ,  DiscountPolicy μ— μμ΅΄ν•λ‹¤λ” κ²ƒμ„ μ• μ μλ‹¤.
κ·Έλ°λ° π•”λ¬ν• ν΄λμ¤ μμ΅΄κ΄€κ³„ λ§μΌλ΅λ” μ‹¤μ  μ–΄λ–¤ κ°μ²΄κ°€ OrderServiceImpl μ— μ£Όμ… λ μ§€ μ• μ μ—†λ‹¤.


**ν΄λμ¤ λ‹¤μ΄μ–΄κ·Έλ¨**

**λ™μ μΈ κ°μ²΄ μΈμ¤ν„΄μ¤ μμ΅΄ κ΄€κ³„**

μ• ν”λ¦¬μΌ€π•”μ… μ‹¤ν–‰ μ‹μ μ— μ‹¤μ  μƒμ„±λ κ°μ²΄ μΈμ¤ν„΄μ¤μ μ°Έμ΅°κ°€ μ—°κ²°λ μμ΅΄ κ΄€κ³„λ‹¤.

**κ°μ²΄ λ‹¤μ΄μ–΄κ·Έλ¨**

μ• ν”λ¦¬μΌ€π•”μ… **μ‹¤ν–‰ μ‹μ (λ°νƒ€μ„)**μ— μ™Έλ¶€μ—μ„ μ‹¤μ  κµ¬ν„ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  ν΄λΌπ•”μ–ΈνΈμ— μ „λ‹¬ν•΄μ„ ν΄λΌπ•”μ–ΈνΈμ™€ μ„


λ²„μ μ‹¤μ  μμ΅΄κ΄€κ³„κ°€ μ—°κ²° λλ” κ²ƒμ„ **μμ΅΄κ΄€κ³„ μ£Όμ…**π•”λΌ ν•λ‹¤.
κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•κ³ , κ·Έ μ°Έμ΅°κ°’μ„ μ „λ‹¬ν•΄μ„ μ—°κ²°λλ‹¤.

μμ΅΄κ΄€κ³„ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄ ν΄λΌπ•”μ–ΈνΈ μ½”λ“λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ , ν΄λΌπ•”μ–ΈνΈκ°€ νΈμ¶ν•λ” λ€μƒμ νƒ€μ… μΈμ¤ν„΄μ¤λ¥Ό λ³€
κ²½ν•  μ μλ‹¤.

μμ΅΄κ΄€κ³„ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄ μ •μ μΈ ν΄λμ¤ μμ΅΄κ΄€κ³„λ¥Ό λ³€κ²½ν•μ§€ μ•κ³ , λ™μ μΈ κ°μ²΄ μΈμ¤ν„΄μ¤ μμ΅΄κ΄€κ³„λ¥Ό μ‰½κ² λ³€κ²½
ν•  μ μλ‹¤.

IOC μ»¨ν…μ΄λ„, DI μ»¨ν…μ΄λ„

AppConfig μ²λΌ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ΄€λ¦¬ν•λ©΄μ„ μμ΅΄κ΄€κ³„λ¥Ό μ—°κ²°ν•΄ μ£Όλ” κ²ƒμ„

IoC μ»¨ν…π•”λ„ λλ” **DI μ»¨ν…μ΄λ„**λΌ ν•λ‹¤.

μμ΅΄κ΄€κ³„ μ£Όμ…μ— μ΄μ μ„ λ§μ¶”μ–΄ μµκ·Όμ—λ” μ£Όλ΅ DI μ»¨ν…π•”λ„λΌ ν•λ‹¤.
λλ” μ–΄μƒλΈ”λ¬, μ¤λΈμ νΈ ν©ν† λ¦¬ λ“±μΌλ΅ λ¶λ¦¬κΈ°λ„ ν•λ‹¤.

μ¤ν”„λ§μΌλ΅ μ „ν™ν•κΈ°

μ§€κΈκΉμ§€ μμν• μλ°” μ½”λ“λ§μΌλ΅ DIλ¥Ό μ μ©ν–λ‹¤. π•”μ  μ¤ν”„λ§μ„ μ‚¬μ©ν•΄λ³΄μ.
μ§€κΈμ€ μ½”λ“λ§ μ‘μ„±ν•κ³  μ„¤λ…μ€ λ§μ§€λ§‰μ— ν•κ² λ‹¤.

**AppConfig μ¤ν”„λ§ κΈ°λ°μΌλ΅ λ³€κ²½**

```

package hello.core;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.RateDiscountPolicy;


import hello.core.member.MemberRepository;
import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;

import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;

import hello.core.order.OrderServiceImpl;

import org.springframework.context.annotation.Bean;

import org.springframework.context.annotation.Configuration;

@Configuration

public class AppConfig {

@Bean

public MemberService memberService() {

return new MemberServiceImpl(memberRepository());

}

@Bean

public OrderService orderService() {
return new OrderServiceImpl(

memberRepository(),
discountPolicy());

}

@Bean

public MemberRepository memberRepository() {
return new MemoryMemberRepository();

}

@Bean

public DiscountPolicy discountPolicy() {
return new RateDiscountPolicy();

}

}

```

AppConfigμ— μ„¤μ •μ„ κµ¬μ„±ν•λ‹¤λ” λ»μ @Configuration μ„ λ¶™μ—¬μ¤€λ‹¤.

κ° λ©”μ„λ“μ— @Bean μ„ λ¶™μ—¬μ¤€λ‹¤. π•”λ ‡κ² ν•λ©΄ μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•λ‹¤.

**MemberAppμ— μ¤ν”„λ§ μ»¨ν…μ΄λ„ μ μ©**

```


package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;

import hello.core.member.MemberService;

import org.springframework.context.ApplicationContext;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;
public class MemberApp {

public static void main(String[] args) {

//        AppConfig appConfig = new AppConfig();

//        MemberService memberService = appConfig.memberService();
ApplicationContext applicationContext = new

AnnotationConfigApplicationContext(AppConfig.class);
MemberService memberService =

applicationContext.getBean("memberService", MemberService.class);

Member member = new Member(1L, "memberA", Grade.VIP);
memberService.join(member);


}

```

Member findMember = memberService.findMember(1L);
System.out.println("new member = " + member.getName());
System.out.println("find Member = " + findMember.getName());

}

**OrderAppμ— μ¤ν”„λ§ μ»¨ν…μ΄λ„ μ μ©**

```

package hello.core;

import hello.core.member.Grade;
import hello.core.member.Member;

import hello.core.member.MemberService;
import hello.core.order.Order;

import hello.core.order.OrderService;

import org.springframework.context.ApplicationContext;


import
org.springframework.context.annotation.AnnotationConfigApplicationContext;

public class OrderApp {

public static void main(String[] args) {

//        AppConfig appConfig = new AppConfig();

//        MemberService memberService = appConfig.memberService();

//        OrderService orderService = appConfig.orderService();

ApplicationContext applicationContext = new
AnnotationConfigApplicationContext(AppConfig.class);

MemberService memberService =
applicationContext.getBean("memberService", MemberService.class);

OrderService orderService = applicationContext.getBean("orderService",
OrderService.class);

long memberId = 1L;

Member member = new Member(memberId, "memberA", Grade.VIP);
memberService.join(member);

Order order = orderService.createOrder(memberId, "itemA", 10000);
System.out.println("order = " + order);

}

}

```

λ‘ μ½”λ“λ¥Ό μ‹¤ν–‰ν•λ©΄ μ¤ν”„λ§ κ΄€λ ¨ λ΅κ·Έκ°€ λ‡μ¤„ μ‹¤ν–‰λλ©΄μ„ κΈ°μ΅΄κ³Ό λ™μΌν• κ²°κ³Όκ°€ μ¶λ ¥λλ‹¤.

**μ¤ν”„λ§ μ»¨ν…μ΄λ„**

ApplicationContext λ¥Ό μ¤ν”„λ§ μ»¨ν…π•”λ„λΌ ν•λ‹¤.

κΈ°μ΅΄μ—λ” κ°λ°μκ°€ AppConfig λ¥Ό μ‚¬μ©ν•΄μ„ μ§μ ‘ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  DIλ¥Ό ν–μ§€λ§, π•”μ λ¶€ν„°λ” μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό
ν†µν•΄μ„ μ‚¬μ©ν•λ‹¤.

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” @Configuration π•” λ¶™μ€ AppConfig λ¥Ό μ„¤μ •(κµ¬μ„±) μ •λ³΄λ΅ μ‚¬μ©ν•λ‹¤. μ—¬κΈ°μ„ @Bean π•”
λΌ μ ν λ©”μ„λ“λ¥Ό λ¨λ‘ νΈμ¶ν•΄μ„ λ°ν™λ κ°μ²΄λ¥Ό μ¤ν”„λ§ μ»¨ν…π•”λ„μ— λ“±λ΅ν•λ‹¤. π•”λ ‡κ² μ¤ν”„λ§ μ»¨ν…π•”λ„μ— λ“±λ΅λ
κ°μ²΄λ¥Ό μ¤ν”„λ§ λΉπ•”λΌ ν•λ‹¤.

μ¤ν”„λ§ λΉμ€ @Bean π•” λ¶™μ€ λ©”μ„λ“μ λ…μ„ μ¤ν”„λ§ λΉμ π•”λ¦„μΌλ΅ μ‚¬μ©ν•λ‹¤. ( memberService ,


orderService )

π•”μ „μ—λ” κ°λ°μκ°€ ν•„μ”ν• κ°μ²΄λ¥Ό AppConfig λ¥Ό μ‚¬μ©ν•΄μ„ μ§μ ‘ μ΅°νν–μ§€λ§, π•”μ λ¶€ν„°λ” μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό ν†µ
ν•΄μ„ ν•„μ”ν• μ¤ν”„λ§ λΉ(κ°μ²΄)λ¥Ό μ°Ύμ•„μ•Ό ν•λ‹¤. μ¤ν”„λ§ λΉμ€ applicationContext.getBean() λ©”μ„λ“λ¥Ό μ‚¬μ©
ν•΄μ„ μ°Ύμ„ μ μλ‹¤.

κΈ°μ΅΄μ—λ” κ°λ°μκ°€ μ§μ ‘ μλ°”μ½”λ“λ΅ λ¨λ“  κ²ƒμ„ ν–λ‹¤λ©΄ π•”μ λ¶€ν„°λ” μ¤ν”„λ§ μ»¨ν…π•”λ„μ— κ°μ²΄λ¥Ό μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅
ν•κ³ , μ¤ν”„λ§ μ»¨ν…π•”λ„μ—μ„ μ¤ν”„λ§ λΉμ„ μ°Ύμ•„μ„ μ‚¬μ©ν•λ„λ΅ λ³€κ²½λμ—λ‹¤.

μ½”λ“κ°€ μ•½κ°„ λ” λ³µμ΅ν•΄μ§„ κ²ƒ κ°™μ€λ°, μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό μ‚¬μ©ν•λ©΄ μ–΄λ–¤ μ¥μ π•” μμ„κΉ?

μ¤ν”„λ§ λ¶€νΈ 3.1 μ΄μƒ - λ΅κ·Έ μ¶λ ¥ μ•λλ” λ¬Έμ  ν•΄κ²°

MemberApp κ³Ό OrderApp μ„ μ‹¤ν–‰ν•  λ•, μ¤ν”„λ§ λ¶€νΈ 3.1 π•”μƒμ„ μ‚¬μ©ν•λ‹¤λ©΄ λ΅κ·Έκ°€ μ¶λ ¥λμ§€ μ•λ”λ‹¤.

**μ¤ν”„λ§ λ¶€νΈ 3.1 λ―Έλ§**

```

19:18:00.439 [main] DEBUG

org.springframework.context.annotation.AnnotationConfigApplicationContext -
Refreshing
org.springframework.context.annotation.AnnotationConfigApplicationContext@7cdbc5
d3

19:18:00.445 [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean
'org.springframework.context.annotation.internalConfigurationAnnotationProcessor
'

19:18:00.503 [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean
'org.springframework.context.event.internalEventListenerProcessor'
19:18:00.504                                                                           [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean
'org.springframework.context.event.internalEventListenerFactory'

19:18:00.504 [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean
'org.springframework.context.annotation.internalAutowiredAnnotationProcessor'
19:18:00.505                                                                           [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean


'org.springframework.context.annotation.internalCommonAnnotationProcessor'
19:18:00.508 [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean 'appConfig'

19:18:00.510 [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean 'memberService'

19:18:00.512 [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean 'memberRepository'

19:18:00.512 [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean 'orderService'

19:18:00.513 [main] DEBUG

org.springframework.beans.factory.support.DefaultListableBeanFactory - Creating
shared instance of singleton bean 'discountPolicy'

new member = memberA

find Member = memberA

```

**μ¤ν”„λ§ λ¶€νΈ 3.1 μ΄μƒ**

```

new member = memberA
find Member = memberA

```

π•”λ•λ” λ‹¤μ μ„μΉμ— νμΌμ„ λ§λ“¤μ–΄μ„ λ„£μΌλ©΄ λλ‹¤.

src/main/resources/logback.xml

```xml

<configuration>

<appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">

<encoder>

<pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} -%kvp-

%msg%n</pattern>

</encoder>

</appender>

<root level="DEBUG">

<appender-ref ref="STDOUT" />

</root>

</configuration>

```


μ¤ν”„λ§ λ¶€νΈ 3.1 λ¶€ν„° κΈ°λ³Έ λ΅κ·Έ λ λ²¨μ„ INFO λ΅ λΉ λ¥΄κ² μ„¤μ •ν•κΈ° λ•λ¬Έμ— λ΅κ·Έλ¥Ό ν™•μΈν•  μ μ—†λ”λ°, π•”λ ‡κ²ν•λ©΄ κΈ°λ³Έ
λ΅κ·Έ λ λ²¨μ„ DEBUG λ΅ μ„¤μ •ν•΄μ„ κ°•μ λ‚΄μ©κ³Ό κ°™π•” λ΅κ·Έλ¥Ό ν™•μΈν•  μ μλ‹¤.

μ°Έκ³ λ΅ π•” λ‚΄μ©μ€ MemberApp κ³Ό OrderApp μ²λΌ ApplicationContext λ¥Ό μ§μ ‘ μƒμ„±ν•΄μ„ μ‚¬μ©ν•  λ•λ§ μ μ©λ
λ‹¤.

κ°•μ λ’¤μ—μ„ λ‚μ¤λ” CoreApplication μ²λΌ μ¤ν”„λ§ λ¶€νΈλ¥Ό μ‹¤ν–‰ν•  λ•λ” π•” νμΌμ„ μ κ±°ν•κ±°λ‚ λλ” <root
level="DEBUG"> λ¶€λ¶„μ„ <root level="INFO"> λ΅ λ³€κ²½ν•λ©΄ κ°•μ λ‚΄μ©κ³Ό κ°™μ€ λ΅κ·Έλ¥Ό ν™•μΈν•  μ μλ‹¤.


4. μ¤ν”„λ§ μ»¨ν…μ΄λ„μ™€ μ¤ν”„λ§ λΉ

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

/μ¤ν”„λ§ μ»¨ν…π•”λ„ μƒμ„±

/μ»¨ν…π•”λ„μ— λ“±λ΅λ λ¨λ“  λΉ μ΅°ν

/μ¤ν”„λ§ λΉ μ΅°ν - κΈ°λ³Έ

/μ¤ν”„λ§ λΉ μ΅°ν - λ™μΌν• νƒ€μ…π•” λ‘ π•”μƒ

/μ¤ν”„λ§ λΉ μ΅°ν - μƒμ† κ΄€κ³„

/BeanFactoryμ™€ ApplicationContext

/λ‹¤μ–‘ν• μ„¤μ • ν•μ‹ μ§€μ› - μλ°” μ½”λ“, XML

/μ¤ν”„λ§ λΉ μ„¤μ • λ©”νƒ€ μ •λ³΄ - BeanDefinition

μ¤ν”„λ§ μ»¨ν…μ΄λ„ μƒμ„±

μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ μƒμ„±λλ” κ³Όμ •μ„ μ•μ•„λ³΄μ.

```

//μ¤ν”„λ§  μ»¨ν…π•”λ„  μƒμ„±

ApplicationContext applicationContext =

new AnnotationConfigApplicationContext(AppConfig.class);

```

ApplicationContext λ¥Ό μ¤ν”„λ§ μ»¨ν…π•”λ„λΌ ν•λ‹¤.

ApplicationContext λ” μΈν„°νπ•”μ¤π•”λ‹¤.

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” XMLμ„ κΈ°λ°μΌλ΅ λ§λ“¤ μ μκ³ , μ• λ…Έν…π•”μ… κΈ°λ°μ μλ°” μ„¤μ • ν΄λμ¤λ΅ λ§λ“¤ μ μλ‹¤.
μ§μ „μ— AppConfig λ¥Ό μ‚¬μ©ν–λ λ°©μ‹π•” μ• λ…Έν…π•”μ… κΈ°λ°μ μλ°” μ„¤μ • ν΄λμ¤λ΅ μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό  λ§λ“  κ²ƒπ•”
λ‹¤.

μλ°” μ„¤μ • ν΄λμ¤λ¥Ό κΈ°λ°μΌλ΅ μ¤ν”„λ§ μ»¨ν…π•”λ„( ApplicationContext )λ¥Ό λ§λ“¤μ–΄λ³΄μ.

new AnnotationConfigApplicationContext(AppConfig.class);

π•” ν΄λμ¤λ” ApplicationContext μΈν„°νπ•”μ¤μ κµ¬ν„μ²΄π•”λ‹¤.

μ°Έκ³ : λ” μ •ν™•νλ” μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό λ¶€λ¥Ό λ• BeanFactory ,  ApplicationContext λ΅ κµ¬λ¶„ν•΄μ„ π•”μ•ΌκΈ°
ν•λ‹¤. π•” λ¶€λ¶„μ€ λ’¤μ—μ„ μ„¤λ…ν•κ² λ‹¤.  BeanFactory λ¥Ό μ§μ ‘ μ‚¬μ©ν•λ” κ²½μ°λ” κ±°μ μ—†μΌλ―€λ΅ μΌλ°μ μΌλ΅
ApplicationContext λ¥Ό μ¤ν”„λ§ μ»¨ν…π•”λ„λΌ ν•λ‹¤.


μ¤ν”„λ§ μ»¨ν…μ΄λ„μ μƒμ„± κ³Όμ •

**1. μ¤ν”„λ§ μ»¨ν…μ΄λ„ μƒμ„±**

new AnnotationConfigApplicationContext(AppConfig.class)

μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό μƒμ„±ν•  λ•λ” κµ¬μ„± μ •λ³΄λ¥Ό μ§€μ •ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤.
μ—¬κΈ°μ„λ” AppConfig.class λ¥Ό κµ¬μ„± μ •λ³΄λ΅ μ§€μ •ν–λ‹¤.

**2. μ¤ν”„λ§ λΉ λ“±λ΅**

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” νλΌλ―Έν„°λ΅ λ„μ–΄μ¨ μ„¤μ • ν΄λμ¤ μ •λ³΄λ¥Ό μ‚¬μ©ν•΄μ„ μ¤ν”„λ§ λΉμ„ λ“±λ΅ν•λ‹¤.

**λΉ μ΄λ¦„**

λΉ π•”λ¦„μ€ λ©”μ„λ“ π•”λ¦„μ„ μ‚¬μ©ν•λ‹¤.
λΉ π•”λ¦„μ„ μ§μ ‘ λ¶€μ—¬ν•  μ λ„ μλ‹¤.


@Bean(name="memberService2")

**μ£Όμ: λΉ μ΄λ¦„μ€ ν•­μƒ λ‹¤λ¥Έ μ΄λ¦„μ„ λ¶€μ—¬**ν•΄μ•Ό ν•λ‹¤. κ°™μ€ π•”λ¦„μ„ λ¶€μ—¬ν•λ©΄, λ‹¤λ¥Έ λΉπ•” λ¬΄μ‹λκ±°λ‚, κΈ°μ΅΄ λΉμ„ λ®μ–΄λ²„
λ¦¬κ±°λ‚ μ„¤μ •μ— λ”°λΌ μ¤λ¥κ°€ λ°μƒν•λ‹¤.

**3. μ¤ν”„λ§ λΉ μμ΅΄κ΄€κ³„ μ„¤μ • - μ¤€λΉ„**

**4. μ¤ν”„λ§ λΉ μμ΅΄κ΄€κ³„ μ„¤μ • - μ™„λ£**

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” μ„¤μ • μ •λ³΄λ¥Ό μ°Έκ³ ν•΄μ„ μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…(DI)ν•λ‹¤.

λ‹¨μν μλ°” μ½”λ“λ¥Ό νΈμ¶ν•λ” κ²ƒ κ°™μ§€λ§, μ°¨π•”κ°€ μλ‹¤. π•” μ°¨π•”λ” λ’¤μ— μ‹±κΈ€ν†¤ μ»¨ν…π•”λ„μ—μ„ μ„¤λ…ν•λ‹¤.

**μ°Έκ³ **

μ¤ν”„λ§μ€ λΉμ„ μƒμ„±ν•κ³ , μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…ν•λ” λ‹¨κ³„κ°€ λ‚λ„μ–΄μ Έ μλ‹¤. κ·Έλ°λ° π•”λ ‡κ² μλ°” μ½”λ“λ΅ μ¤ν”„λ§ λΉμ„ λ“±λ΅ν•λ©΄


μƒμ„±μλ¥Ό νΈμ¶ν•λ©΄μ„ μμ΅΄κ΄€κ³„ μ£Όμ…λ„ ν•λ²μ— μ²λ¦¬λλ‹¤. μ—¬κΈ°μ„λ” π•”ν•΄λ¥Ό λ•κΈ° μ„ν•΄ κ°λ…μ μΌλ΅ λ‚λ„μ–΄ μ„¤λ…ν–λ‹¤. μμ„Έ
ν• λ‚΄μ©μ€ μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…μ—μ„ λ‹¤μ‹ μ„¤λ…ν•κ² λ‹¤.

**μ •λ¦¬**

μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό μƒμ„±ν•κ³ , μ„¤μ •(κµ¬μ„±) μ •λ³΄λ¥Ό μ°Έκ³ ν•΄μ„ μ¤ν”„λ§ λΉλ„ λ“±λ΅ν•κ³ , μμ΅΄κ΄€κ³„λ„ μ„¤μ •ν–λ‹¤.

π•”μ  μ¤ν”„λ§ μ»¨ν…π•”λ„μ—μ„ λ°π•”ν„°λ¥Ό μ΅°νν•΄λ³΄μ.

μ»¨ν…μ΄λ„μ— λ“±λ΅λ λ¨λ“  λΉ μ΅°ν

μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μ‹¤μ  μ¤ν”„λ§ λΉλ“¤π•” μ λ“±λ΅ λμ—λ”μ§€ ν™•μΈν•΄λ³΄μ.

```

package hello.core.beanfind;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.config.BeanDefinition;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;
import static org.assertj.core.api.Assertions.assertThat;

class ApplicationContextInfoTest {

AnnotationConfigApplicationContext ac = new
AnnotationConfigApplicationContext(AppConfig.class);

@Test

@DisplayName("λ¨λ“   λΉ  μ¶λ ¥ν•κΈ°")
void findAllBean() {

String[] beanDefinitionNames = ac.getBeanDefinitionNames();
for (String beanDefinitionName : beanDefinitionNames) {

Object bean = ac.getBean(beanDefinitionName);
System.out.println("name=" + beanDefinitionName + " object=" +

bean);

}

}

@Test


@DisplayName("μ• ν”λ¦¬μΌ€π•”μ…  λΉ  μ¶λ ¥ν•κΈ°")
void findApplicationBean() {

String[] beanDefinitionNames = ac.getBeanDefinitionNames();
for (String beanDefinitionName : beanDefinitionNames) {

BeanDefinition beanDefinition =
ac.getBeanDefinition(beanDefinitionName);


bean);

//Role ROLE_APPLICATION: μ§μ ‘  λ“±λ΅ν•  μ• ν”λ¦¬μΌ€π•”μ…  λΉ

//Role ROLE_INFRASTRUCTURE: μ¤ν”„λ§π•”  λ‚΄λ¶€μ—μ„  μ‚¬μ©ν•λ”  λΉ

if (beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION) {
Object bean = ac.getBean(beanDefinitionName);
System.out.println("name=" + beanDefinitionName + " object=" +

}

}

}

}

```

λ¨λ“  λΉ μ¶λ ¥ν•κΈ°

μ‹¤ν–‰ν•λ©΄ μ¤ν”„λ§μ— λ“±λ΅λ λ¨λ“  λΉ μ •λ³΄λ¥Ό μ¶λ ¥ν•  μ μλ‹¤.
ac.getBeanDefinitionNames() : μ¤ν”„λ§μ— λ“±λ΅λ λ¨λ“  λΉ π•”λ¦„μ„ μ΅°νν•λ‹¤.
ac.getBean()                                         : λΉ π•”λ¦„μΌλ΅ λΉ κ°μ²΄(μΈμ¤ν„΄μ¤)λ¥Ό μ΅°νν•λ‹¤.

μ• ν”λ¦¬μΌ€π•”μ… λΉ μ¶λ ¥ν•κΈ°

μ¤ν”„λ§π•” λ‚΄λ¶€μ—μ„ μ‚¬μ©ν•λ” λΉμ€ μ μ™Έν•κ³ , λ‚΄κ°€ λ“±λ΅ν• λΉλ§ μ¶λ ¥ν•΄λ³΄μ.
μ¤ν”„λ§π•” λ‚΄λ¶€μ—μ„ μ‚¬μ©ν•λ” λΉμ€ getRole() λ΅ κµ¬λ¶„ν•  μ μλ‹¤.

ROLE_APPLICATION : μΌλ°μ μΌλ΅ μ‚¬μ©μκ°€ μ •μν• λΉ

ROLE_INFRASTRUCTURE : μ¤ν”„λ§π•” λ‚΄λ¶€μ—μ„ μ‚¬μ©ν•λ” λΉ

μ¤ν”„λ§ λΉ μ΅°ν - κΈ°λ³Έ

μ¤ν”„λ§ μ»¨ν…π•”λ„μ—μ„ μ¤ν”„λ§ λΉμ„ μ°Ύλ” κ°€μ¥ κΈ°λ³Έμ μΈ μ΅°ν λ°©λ²•

ac.getBean(λΉπ•”λ¦„, νƒ€μ…)
ac.getBean(νƒ€μ…)

μ΅°ν λ€μƒ μ¤ν”„λ§ λΉπ•” μ—†μΌλ©΄ μμ™Έ λ°μƒ

NoSuchBeanDefinitionException: No bean named 'xxxxx' available


**μμ  μ½”λ“**

```

package hello.core.beanfind;

import hello.core.AppConfig;

import hello.core.member.MemberService;
import hello.core.member.MemberServiceImpl;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.NoSuchBeanDefinitionException;
import
org.springframework.context.annotation.AnnotationConfigApplicationContext;

import static org.assertj.core.api.Assertions.*;
class ApplicationContextBasicFindTest {

AnnotationConfigApplicationContext ac = new
AnnotationConfigApplicationContext(AppConfig.class);

@Test

@DisplayName("λΉ  π•”λ¦„μΌλ΅  μ΅°ν")
void findBeanByName() {

MemberService memberService = ac.getBean("memberService",
MemberService.class);

assertThat(memberService).isInstanceOf(MemberServiceImpl.class);

}

@Test

@DisplayName("π•”λ¦„  μ—†π•”  νƒ€μ…λ§μΌλ΅  μ΅°ν")
void findBeanByType() {

MemberService memberService = ac.getBean(MemberService.class);
assertThat(memberService).isInstanceOf(MemberServiceImpl.class);

}

@Test

@DisplayName("κµ¬μ²΄  νƒ€μ…μΌλ΅  μ΅°ν")
void findBeanByName2() {

MemberServiceImpl memberService = ac.getBean("memberService",
MemberServiceImpl.class);

assertThat(memberService).isInstanceOf(MemberServiceImpl.class);

}


@Test

@DisplayName("λΉ  π•”λ¦„μΌλ΅  μ΅°νX")
void findBeanByNameX() {

//ac.getBean("xxxxx", MemberService.class);
Assertions.assertThrows(NoSuchBeanDefinitionException.class, () ->

ac.getBean("xxxxx", MemberService.class));

}

}

```

μ°Έκ³ : κµ¬μ²΄ νƒ€μ…μΌλ΅ μ΅°νν•λ©΄ λ³€κ²½μ‹ μ μ—°μ„±π•” λ–¨μ–΄μ§„λ‹¤.

μ¤ν”„λ§ λΉ μ΅°ν - λ™μΌν• νƒ€μ…μ΄ λ‘ μ΄μƒ

νƒ€μ…μΌλ΅ μ΅°νμ‹ κ°™μ€ νƒ€μ…μ μ¤ν”„λ§ λΉπ•” λ‘ π•”μƒπ•”λ©΄ μ¤λ¥κ°€ λ°μƒν•λ‹¤. π•”λ•λ” λΉ π•”λ¦„μ„ μ§€μ •ν•μ.

ac.getBeansOfType() μ„ μ‚¬μ©ν•λ©΄ ν•΄λ‹Ή νƒ€μ…μ λ¨λ“  λΉμ„ μ΅°νν•  μ μλ‹¤.

**μμ  μ½”λ“**

```

package hello.core.beanfind;

import hello.core.member.MemberRepository;
import hello.core.member.MemoryMemberRepository;
import org.junit.jupiter.api.DisplayName;

import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.NoUniqueBeanDefinitionException;
import
org.springframework.context.annotation.AnnotationConfigApplicationContext;
import                                org.springframework.context.annotation.Bean;

import org.springframework.context.annotation.Configuration;
import java.util.Map;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.assertThrows;

class ApplicationContextSameBeanFindTest {

AnnotationConfigApplicationContext ac = new
AnnotationConfigApplicationContext(SameBeanConfig.class);


@Test

@DisplayName("νƒ€μ…μΌλ΅  μ΅°νμ‹  κ°™μ€  νƒ€μ…π•”  λ‘  π•”μƒ  μμΌλ©΄, μ¤‘λ³µ  μ¤λ¥κ°€  λ°μƒν•λ‹¤")
void findBeanByTypeDuplicate() {

//MemberRepository bean = ac.getBean(MemberRepository.class);
assertThrows(NoUniqueBeanDefinitionException.class, () ->

ac.getBean(MemberRepository.class));

}

@Test

@DisplayName("νƒ€μ…μΌλ΅  μ΅°νμ‹  κ°™μ€  νƒ€μ…π•”  λ‘  π•”μƒ  μμΌλ©΄, λΉ  π•”λ¦„μ„  μ§€μ •ν•λ©΄  λλ‹¤")
void findBeanByName() {

MemberRepository memberRepository = ac.getBean("memberRepository1",
MemberRepository.class);

assertThat(memberRepository).isInstanceOf(MemberRepository.class);

}

@Test

@DisplayName("νΉμ •  νƒ€μ…μ„  λ¨λ‘  μ΅°νν•κΈ°")
void findAllBeanByType() {

Map<String, MemberRepository> beansOfType =
ac.getBeansOfType(MemberRepository.class);

for (String key : beansOfType.keySet()) {
System.out.println("key = " + key + " value = " +

beansOfType.get(key));

}

System.out.println("beansOfType = " + beansOfType);
assertThat(beansOfType.size()).isEqualTo(2);

}

@Configuration

static class SameBeanConfig {

@Bean

public MemberRepository memberRepository1() {
return new MemoryMemberRepository();

}

@Bean

public MemberRepository memberRepository2() {
return new MemoryMemberRepository();

}


}

}

```

μ¤ν”„λ§ λΉ μ΅°ν - μƒμ† κ΄€κ³„

λ¶€λ¨ νƒ€μ…μΌλ΅ μ΅°νν•λ©΄, μμ‹ νƒ€μ…λ„ ν•¨κ» μ΅°νν•λ‹¤.

κ·Έλμ„ λ¨λ“  μλ°” κ°μ²΄μ μµκ³  λ¶€λ¨μΈ Object νƒ€μ…μΌλ΅ μ΅°νν•λ©΄, λ¨λ“  μ¤ν”„λ§ λΉμ„ μ΅°νν•λ‹¤.

**μμ  μ½”λ“**

```

package hello.core.beanfind;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.FixDiscountPolicy;
import hello.core.discount.RateDiscountPolicy;
import hello.core.member.MemberService;

import hello.core.member.MemberServiceImpl;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.NoUniqueBeanDefinitionException;
import
org.springframework.context.annotation.AnnotationConfigApplicationContext;


import org.springframework.context.annotation.Bean;

import org.springframework.context.annotation.Configuration;
import java.util.Map;

import static org.assertj.core.api.Assertions.assertThat;
import static org.junit.jupiter.api.Assertions.assertThrows;

class ApplicationContextExtendsFindTest {

AnnotationConfigApplicationContext ac = new
AnnotationConfigApplicationContext(TestConfig.class);

@Test

@DisplayName("λ¶€λ¨  νƒ€μ…μΌλ΅  μ΅°νμ‹, μμ‹π•”  λ‘  π•”μƒ  μμΌλ©΄, μ¤‘λ³µ  μ¤λ¥κ°€  λ°μƒν•λ‹¤")
void findBeanByParentTypeDuplicate() {

//DiscountPolicy bean = ac.getBean(DiscountPolicy.class);
assertThrows(NoUniqueBeanDefinitionException.class, () ->

ac.getBean(DiscountPolicy.class));

}

@Test

@DisplayName("λ¶€λ¨  νƒ€μ…μΌλ΅  μ΅°νμ‹, μμ‹π•”  λ‘  π•”μƒ  μμΌλ©΄, λΉ  π•”λ¦„μ„  μ§€μ •ν•λ©΄  λλ‹¤")
void findBeanByParentTypeBeanName() {

DiscountPolicy rateDiscountPolicy = ac.getBean("rateDiscountPolicy",
DiscountPolicy.class);

assertThat(rateDiscountPolicy).isInstanceOf(RateDiscountPolicy.class);

}

@Test

@DisplayName("νΉμ •  ν•μ„  νƒ€μ…μΌλ΅  μ΅°ν")
void findBeanBySubType() {

RateDiscountPolicy bean = ac.getBean(RateDiscountPolicy.class);
assertThat(bean).isInstanceOf(RateDiscountPolicy.class);

}

@Test

@DisplayName("λ¶€λ¨  νƒ€μ…μΌλ΅  λ¨λ‘  μ΅°νν•κΈ°")
void findAllBeanByParentType() {

Map<String, DiscountPolicy> beansOfType =
ac.getBeansOfType(DiscountPolicy.class);

assertThat(beansOfType.size()).isEqualTo(2);
for (String key : beansOfType.keySet()) {


System.out.println("key = " + key + " value=" +
beansOfType.get(key));

}

}

@Test

@DisplayName("λ¶€λ¨  νƒ€μ…μΌλ΅  λ¨λ‘  μ΅°νν•κΈ°  - Object")
void findAllBeanByObjectType() {

Map<String, Object> beansOfType = ac.getBeansOfType(Object.class);
for (String key : beansOfType.keySet()) {

System.out.println("key = " + key + " value=" +
beansOfType.get(key));

}

}

@Configuration

static class TestConfig {

@Bean

public DiscountPolicy rateDiscountPolicy() {
return new RateDiscountPolicy();

}

@Bean

public DiscountPolicy fixDiscountPolicy() {
return new FixDiscountPolicy();

}

}

}

```

BeanFactOryμ™€ ApplicatiOnCOntext

beanFactoryμ™€ ApplicationContextμ— λ€ν•΄μ„ μ•μ•„λ³΄μ.


**BeanFactory**

μ¤ν”„λ§ μ»¨ν…π•”λ„μ μµμƒμ„ μΈν„°νπ•”μ¤λ‹¤.

μ¤ν”„λ§ λΉμ„ κ΄€λ¦¬ν•κ³  μ΅°νν•λ” μ—­ν• μ„ λ‹΄λ‹Ήν•λ‹¤.

getBean() μ„ μ κ³µν•λ‹¤.

μ§€κΈκΉμ§€ μ°λ¦¬κ°€ μ‚¬μ©ν–λ λ€λ¶€λ¶„μ κΈ°λ¥μ€ BeanFactoryκ°€ μ κ³µν•λ” κΈ°λ¥π•”λ‹¤.

**ApplicationContext**

BeanFactory κΈ°λ¥μ„ λ¨λ‘ μƒμ†λ°›μ•„μ„ μ κ³µν•λ‹¤.

λΉμ„ κ΄€λ¦¬ν•κ³  κ²€μƒ‰ν•λ” κΈ°λ¥μ„ BeanFactoryκ°€ μ κ³µν•΄μ£Όλ”λ°, κ·Έλ¬λ©΄ λ‘μ μ°¨π•”κ°€ λ­κΉ?
μ• ν”λ¦¬μΌ€π•”μ…μ„ κ°λ°ν•  λ•λ” λΉμ„ κ΄€λ¦¬ν•κ³  μ΅°νν•λ” κΈ°λ¥μ€ λ¬Όλ΅ π•”κ³ , μ λ§μ€ λ¶€κ°€κΈ°λ¥π•” ν•„μ”ν•λ‹¤.

**ApplicatonContextκ°€ μ κ³µν•λ” λ¶€κ°€κΈ°λ¥**


**λ©”μ‹μ§€μ†μ¤λ¥Ό ν™μ©ν• κµ­μ ν™” κΈ°λ¥**

μλ¥Ό λ“¤μ–΄μ„ ν•κµ­μ—μ„ λ“¤μ–΄μ¤λ©΄ ν•κµ­μ–΄λ΅, μμ–΄κ¶μ—μ„ λ“¤μ–΄μ¤λ©΄ μμ–΄λ΅ μ¶λ ¥

**ν™κ²½λ³€μ**

λ΅μ»¬, κ°λ°, μ΄μλ“±μ„ κµ¬λ¶„ν•΄μ„ μ²λ¦¬

**μ• ν”λ¦¬μΌ€μ΄μ… μ΄λ²¤νΈ**

π•”λ²¤νΈλ¥Ό λ°ν–‰ν•κ³  κµ¬λ…ν•λ” λ¨λΈμ„ νΈλ¦¬ν•κ² μ§€μ›

**νΈλ¦¬ν• λ¦¬μ†μ¤ μ΅°ν**

νμΌ, ν΄λμ¤ν¨μ¤, μ™Έλ¶€ λ“±μ—μ„ λ¦¬μ†μ¤λ¥Ό νΈλ¦¬ν•κ² μ΅°ν


**μ •λ¦¬**

ApplicationContextλ” BeanFactoryμ κΈ°λ¥μ„ μƒμ†λ°›λ”λ‹¤.

ApplicationContextλ” λΉ κ΄€λ¦¬κΈ°λ¥ + νΈλ¦¬ν• λ¶€κ°€ κΈ°λ¥μ„ μ κ³µν•λ‹¤.

BeanFactoryλ¥Ό μ§μ ‘ μ‚¬μ©ν•  μΌμ€ κ±°μ μ—†λ‹¤. λ¶€κ°€κΈ°λ¥π•” ν¬ν•¨λ ApplicationContextλ¥Ό μ‚¬μ©ν•λ‹¤.
BeanFactoryλ‚ ApplicationContextλ¥Ό μ¤ν”„λ§ μ»¨ν…π•”λ„λΌ ν•λ‹¤.

λ‹¤μ–‘ν• μ„¤μ • ν•μ‹ μ§€μ› - μλ°” μ½”λ“, XML

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” λ‹¤μ–‘ν• ν•μ‹μ μ„¤μ • μ •λ³΄λ¥Ό λ°›μ•„λ“¤μΌ μ μκ² μ μ—°ν•κ² μ„¤κ³„λμ–΄ μλ‹¤.
μλ°” μ½”λ“, XML, Groovy λ“±λ“±


μ• λ…Έν…μ΄μ… κΈ°λ° μλ°” μ½”λ“ μ„¤μ • μ‚¬μ©

μ§€κΈκΉμ§€ ν–λ κ²ƒπ•”λ‹¤.

new AnnotationConfigApplicationContext(AppConfig.class)
AnnotationConfigApplicationContext ν΄λμ¤λ¥Ό μ‚¬μ©ν•λ©΄μ„ μλ°” μ½”λ“λ΅λ μ„¤μ • μ •λ³΄λ¥Ό λ„κΈ°λ©΄ λλ‹¤.

XML μ„¤μ • μ‚¬μ©

μµκ·Όμ—λ” μ¤ν”„λ§ λ¶€νΈλ¥Ό λ§π•” μ‚¬μ©ν•λ©΄μ„ XMLκΈ°λ°μ μ„¤μ •μ€ μ μ‚¬μ©ν•μ§€ μ•λ”λ‹¤. μ•„μ§ λ§μ€ λ κ±°μ‹ ν”„λ΅μ νΈ λ“¤

π•” XMLλ΅ λμ–΄ μκ³ , λ XMLμ„ μ‚¬μ©ν•λ©΄ μ»΄νμΌ μ—†π•” λΉ μ„¤μ • μ •λ³΄λ¥Ό λ³€κ²½ν•  μ μλ” μ¥μ λ„ μμΌλ―€λ΅ ν•λ²μ―¤
λ°°μ›λ‘λ” κ²ƒλ„ κ΄μ°®λ‹¤.

GenericXmlApplicationContext λ¥Ό μ‚¬μ©ν•λ©΄μ„ xml μ„¤μ • νμΌμ„ λ„κΈ°λ©΄ λλ‹¤.

**XmlAppConfig μ‚¬μ© μλ°” μ½”λ“**

```

package hello.core.xml;

import hello.core.member.MemberService;
import org.junit.jupiter.api.Test;

import org.springframework.context.ApplicationContext;

import org.springframework.context.support.GenericXmlApplicationContext;


import static org.assertj.core.api.Assertions.*;
public class XmlAppContext {

@Test

void xmlAppContext() {
ApplicationContext ac = new

GenericXmlApplicationContext("appConfig.xml");

MemberService memberService = ac.getBean("memberService",
MemberService.class);

assertThat(memberService).isInstanceOf(MemberService.class);

}

}

```

**xml κΈ°λ°μ μ¤ν”„λ§ λΉ μ„¤μ • μ •λ³΄**

src/main/resources/appConfig.xml

```xml

<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://www.springframework.org/schema/beans                                     
                             http://

www.springframework.org/schema/beans/spring-beans.xsd">

<bean id="memberService" class="hello.core.member.MemberServiceImpl">

<constructor-arg name="memberRepository" ref="memberRepository" />

</bean>

<bean id="memberRepository"
class="hello.core.member.MemoryMemberRepository" />

<bean id="orderService" class="hello.core.order.OrderServiceImpl">

<constructor-arg name="memberRepository" ref="memberRepository" />

<constructor-arg name="discountPolicy" ref="discountPolicy" />

</bean>

<bean id="discountPolicy" class="hello.core.discount.RateDiscountPolicy" />

</beans>

```

xml κΈ°λ°μ appConfig.xml μ¤ν”„λ§ μ„¤μ • μ •λ³΄μ™€ μλ°” μ½”λ“λ΅ λ AppConfig.java μ„¤μ • μ •λ³΄λ¥Ό λΉ„κµν•΄λ³΄λ©΄
κ±°μ λΉ„μ·ν•λ‹¤λ” κ²ƒμ„ μ• μ μλ‹¤.


xml κΈ°λ°μΌλ΅ μ„¤μ •ν•λ” κ²ƒμ€ μµκ·Όμ— μ μ‚¬μ©ν•μ§€ μ•μΌλ―€λ΅ π•”μ •λ„λ΅ λ§λ¬΄λ¦¬ ν•κ³ , ν•„μ”ν•λ©΄ μ¤ν”„λ§ κ³µμ‹ λ νΌλ°μ¤
λ¬Έμ„λ¥Ό ν™•μΈν•μ.

https://spring.io/projects/spring-framework

μ¤ν”„λ§ λΉ μ„¤μ • λ©”νƒ€ μ •λ³΄ - BeanDefinitiOn

μ¤ν”„λ§μ€ μ–΄λ–»κ² π•”λ° λ‹¤μ–‘ν• μ„¤μ • ν•μ‹μ„ μ§€μ›ν•λ” κ²ƒμΌκΉ? κ·Έ μ¤‘μ‹¬μ—λ” BeanDefinition π•”λΌλ” μ¶”μƒν™”κ°€
μλ‹¤.

μ‰½κ² π•”μ•ΌκΈ°ν•΄μ„ **μ—­ν• κ³Ό κµ¬ν„μ„ κ°λ…μ μΌλ΅ λ‚λ κ²ƒ**π•”λ‹¤!
XMLμ„ μ½μ–΄μ„ BeanDefinitionμ„ λ§λ“¤λ©΄ λλ‹¤.
μλ°” μ½”λ“λ¥Ό μ½μ–΄μ„ BeanDefinitionμ„ λ§λ“¤λ©΄ λλ‹¤.

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” μλ°” μ½”λ“μΈμ§€, XMLμΈμ§€ λ°λΌλ„ λλ‹¤. μ¤μ§ BeanDefinitionλ§ μ•λ©΄ λλ‹¤.

BeanDefinition μ„ λΉ μ„¤μ • λ©”νƒ€μ •λ³΄λΌ ν•λ‹¤.

@Bean ,  <bean> λ‹Ή κ°κ° ν•λ‚μ”© λ©”νƒ€ μ •λ³΄κ°€ μƒμ„±λλ‹¤.
μ¤ν”„λ§ μ»¨ν…π•”λ„λ” π•” λ©”νƒ€μ •λ³΄λ¥Ό κΈ°λ°μΌλ΅ μ¤ν”„λ§ λΉμ„ μƒμ„±ν•λ‹¤.

**μ½”λ“ λ λ²¨λ΅ μ΅°κΈ λ” κΉμ΄ μκ² λ“¤μ–΄κ°€λ³΄μ.**


AnnotationConfigApplicationContext λ” AnnotatedBeanDefinitionReader λ¥Ό μ‚¬μ©ν•΄μ„

AppConfig.class λ¥Ό μ½κ³  BeanDefinition μ„ μƒμ„±ν•λ‹¤.

GenericXmlApplicationContext λ” XmlBeanDefinitionReader λ¥Ό μ‚¬μ©ν•΄μ„ appConfig.xml

μ„¤μ • μ •λ³΄λ¥Ό μ½κ³  BeanDefinition μ„ μƒμ„±ν•λ‹¤.

μƒλ΅μ΄ ν•μ‹μ μ„¤μ • μ •λ³΄κ°€ μ¶”κ°€λλ©΄, XxxBeanDefinitionReaderλ¥Ό λ§λ“¤μ–΄μ„ BeanDefinition μ„ μƒμ„±ν•
λ©΄ λλ‹¤.

BeanDefinitiOn μ‚΄ν΄λ³΄κΈ°

**BeanDefinition μ •λ³΄**

BeanClassName: μƒμ„±ν•  λΉμ ν΄λμ¤ λ…(μλ°” μ„¤μ • μ²λΌ ν©ν† λ¦¬ μ—­ν• μ λΉμ„ μ‚¬μ©ν•λ©΄ μ—†μ)
factoryBeanName: ν©ν† λ¦¬ μ—­ν• μ λΉμ„ μ‚¬μ©ν•  κ²½μ° π•”λ¦„, μ) appConfig
factoryMethodName: λΉμ„ μƒμ„±ν•  ν©ν† λ¦¬ λ©”μ„λ“ μ§€μ •, μ) memberService

Scope: μ‹±κΈ€ν†¤(κΈ°λ³Έκ°’)

lazyInit: μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό μƒμ„±ν•  λ• λΉμ„ μƒμ„±ν•λ” κ²ƒπ•” μ•„λ‹λΌ, μ‹¤μ  λΉμ„ μ‚¬μ©ν•  λ• κΉμ§€ μµλ€ν• μƒμ„±μ„ μ§€μ—°
μ²λ¦¬ ν•λ”μ§€ μ—¬λ¶€

InitMethodName: λΉμ„ μƒμ„±ν•κ³ , μμ΅΄κ΄€κ³„λ¥Ό μ μ©ν• λ’¤μ— νΈμ¶λλ” μ΄κΈ°ν™” λ©”μ„λ“ λ…

DestroyMethodName: λΉμ μƒλ…μ£ΌκΈ°κ°€ λλ‚μ„ μ κ±°ν•κΈ° μ§μ „μ— νΈμ¶λλ” λ©”μ„λ“ λ…

Constructor arguments, Properties: μμ΅΄κ΄€κ³„ μ£Όμ…μ—μ„ μ‚¬μ©ν•λ‹¤. (μλ°” μ„¤μ • μ²λΌ ν©ν† λ¦¬ μ—­ν• μ λΉμ„ μ‚¬μ©
ν•λ©΄ μ—†μ)


```

package hello.core.beandefinition;

import hello.core.AppConfig;

import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import org.springframework.beans.MutablePropertyValues;

import org.springframework.beans.factory.config.BeanDefinition;

import org.springframework.beans.factory.config.ConstructorArgumentValues;
import
org.springframework.context.annotation.AnnotationConfigApplicationContext;
import           org.springframework.context.support.GenericXmlApplicationContext;

public class BeanDefinitionTest {

AnnotationConfigApplicationContext ac = new
AnnotationConfigApplicationContext(AppConfig.class);

//    GenericXmlApplicationContext ac = new
GenericXmlApplicationContext("appConfig.xml");

@Test

@DisplayName("λΉ  μ„¤μ •  λ©”νƒ€μ •λ³΄  ν™•μΈ")
void findApplicationBean() {

String[] beanDefinitionNames = ac.getBeanDefinitionNames();
for (String beanDefinitionName : beanDefinitionNames) {

BeanDefinition beanDefinition =
ac.getBeanDefinition(beanDefinitionName);

if (beanDefinition.getRole() == BeanDefinition.ROLE_APPLICATION) {
System.out.println("beanDefinitionName" + beanDefinitionName +

" beanDefinition = " + beanDefinition);

}

}

}

}

```


**μ •λ¦¬**

BeanDefinitionμ„ μ§μ ‘ μƒμ„±ν•΄μ„ μ¤ν”„λ§ μ»¨ν…π•”λ„μ— λ“±λ΅ν•  μ λ„ μλ‹¤. ν•μ§€λ§ μ‹¤λ¬΄μ—μ„ BeanDefinitionμ„
μ§μ ‘ μ •μν•κ±°λ‚ μ‚¬μ©ν•  μΌμ€ κ±°μ μ—†λ‹¤.     μ–΄λ ¤μ°λ©΄ κ·Έλƒ¥ λ„μ–΄κ°€λ©΄ λλ‹¤^^!

BeanDefinitionμ— λ€ν•΄μ„λ” λ„λ¬΄ κΉπ•”μκ² π•”ν•΄ν•κΈ° λ³΄λ‹¤λ”, μ¤ν”„λ§π•” λ‹¤μ–‘ν• ν•νƒμ μ„¤μ • μ •λ³΄λ¥Ό

BeanDefinitionμΌλ΅ μ¶”μƒν™”ν•΄μ„ μ‚¬μ©ν•λ” κ²ƒ μ •λ„λ§ π•”ν•΄ν•λ©΄ λλ‹¤.


κ°€λ” μ¤ν”„λ§ μ½”λ“λ‚ μ¤ν”„λ§ κ΄€λ ¨ μ¤ν” μ†μ¤μ μ½”λ“λ¥Ό λ³Ό λ•, BeanDefinition π•”λΌλ” κ²ƒπ•” λ³΄μΌ λ•κ°€ μλ‹¤. π•”λ•

π•”λ¬ν• λ©”μ»¤λ‹μ¦μ„ λ– μ¬λ¦¬λ©΄ λλ‹¤.


5. μ‹±κΈ€ν†¤ μ»¨ν…μ΄λ„

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

/μ›Ή μ• ν”λ¦¬μΌ€π•”μ…κ³Ό μ‹±κΈ€ν†¤

/μ‹±κΈ€ν†¤ ν¨ν„΄

/μ‹±κΈ€ν†¤ μ»¨ν…π•”λ„

/μ‹±κΈ€ν†¤ λ°©μ‹μ μ£Όμμ 

/@Configurationκ³Ό μ‹±κΈ€ν†¤

/@Configurationκ³Ό λ°”π•”νΈμ½”λ“ μ΅°μ‘μ λ§λ²•

μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…κ³Ό μ‹±κΈ€ν†¤

μ¤ν”„λ§μ€ νƒμƒπ•” κΈ°μ—…μ© μ¨λΌμΈ μ„λΉ„μ¤ κΈ°μ μ„ μ§€μ›ν•κΈ° μ„ν•΄ νƒ„μƒν–λ‹¤.

λ€λ¶€λ¶„μ μ¤ν”„λ§ μ• ν”λ¦¬μΌ€π•”μ…μ€ μ›Ή μ• ν”λ¦¬μΌ€π•”μ…π•”λ‹¤. λ¬Όλ΅  μ›Ήπ•” μ•„λ‹ μ• ν”λ¦¬μΌ€π•”μ… κ°λ°λ„ μ–Όλ§λ“ μ§€ κ°λ°ν•  μ
μλ‹¤.

μ›Ή μ• ν”λ¦¬μΌ€π•”μ…μ€ λ³΄ν†µ μ—¬λ¬ κ³ κ°π•” λ™μ‹μ— μ”μ²­μ„ ν•λ‹¤.

**μ¤ν”„λ§ μ—†λ” μμν• DI μ»¨ν…μ΄λ„ ν…μ¤νΈ**

```

package hello.core.singleton;
import hello.core.AppConfig;


import hello.core.member.MemberService;
import org.junit.jupiter.api.DisplayName;
import org.junit.jupiter.api.Test;

import static org.assertj.core.api.Assertions.*;
public class SingletonTest {

@Test

@DisplayName("μ¤ν”„λ§  μ—†λ”  μμν•  DI μ»¨ν…π•”λ„")
void pureContainer() {

AppConfig appConfig = new AppConfig();

//1. μ΅°ν: νΈμ¶ν•   λ•  λ§λ‹¤  κ°μ²΄λ¥Ό  μƒμ„±

MemberService memberService1 = appConfig.memberService();

//2. μ΅°ν: νΈμ¶ν•   λ•  λ§λ‹¤  κ°μ²΄λ¥Ό  μƒμ„±

MemberService memberService2 = appConfig.memberService();

//μ°Έμ΅°κ°’π•”  λ‹¤λ¥Έ  κ²ƒμ„  ν™•μΈ

System.out.println("memberService1 = " + memberService1);
System.out.println("memberService2 = " + memberService2);

//memberService1 != memberService2
assertThat(memberService1).isNotSameAs(memberService2);

}

}

```

μ°λ¦¬κ°€ λ§λ“¤μ—λ μ¤ν”„λ§ μ—†λ” μμν• DI μ»¨ν…π•”λ„μΈ AppConfigλ” μ”μ²­μ„ ν•  λ• λ§λ‹¤ κ°μ²΄λ¥Ό μƒλ΅ μƒμ„±ν•λ‹¤.
κ³ κ° νΈλν”½π•” μ΄λ‹Ή 100π•” λ‚μ¤λ©΄ μ΄λ‹Ή 100κ° κ°μ²΄κ°€ μƒμ„±λκ³  μ†λ©Έλλ‹¤!     λ©”λ¨λ¦¬ λ‚­λΉ„κ°€ μ‹¬ν•λ‹¤.
ν•΄κ²°λ°©μ•μ€ ν•΄λ‹Ή κ°μ²΄κ°€ λ”± 1κ°λ§ μƒμ„±λκ³ , κ³µμ ν•λ„λ΅ μ„¤κ³„ν•λ©΄ λλ‹¤.     μ‹±κΈ€ν†¤ ν¨ν„΄

μ‹±κΈ€ν†¤ ν¨ν„΄

ν΄λμ¤μ μΈμ¤ν„΄μ¤κ°€ λ”± 1κ°λ§ μƒμ„±λλ” κ²ƒμ„ λ³΄μ¥ν•λ” λ””μμΈ ν¨ν„΄π•”λ‹¤.
κ·Έλμ„ κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό 2κ° π•”μƒ μƒμ„±ν•μ§€ λ»ν•λ„λ΅ λ§‰μ•„μ•Ό ν•λ‹¤.


private μƒμ„±μλ¥Ό μ‚¬μ©ν•΄μ„ μ™Έλ¶€μ—μ„ μ„μλ΅ new ν‚¤μ›λ“λ¥Ό μ‚¬μ©ν•μ§€ λ»ν•λ„λ΅ λ§‰μ•„μ•Ό ν•λ‹¤.

μ‹±κΈ€ν†¤ ν¨ν„΄μ„ μ μ©ν• μμ  μ½”λ“λ¥Ό λ³΄μ. **mainμ΄ μ•„λ‹ test μ„μΉμ— μƒμ„±ν•μ.**

```

package hello.core.singleton;
public class SingletonService {

//1. static μμ—­μ—  κ°μ²΄λ¥Ό  λ”±  1κ°λ§  μƒμ„±ν•΄λ‘”λ‹¤.

private static final SingletonService instance = new SingletonService();

//2. publicμΌλ΅  μ—΄μ–΄μ„  κ°μ²΄  μΈμ¤ν„΄μ¤κ°€  ν•„μ”ν•λ©΄  π•”  static λ©”μ„λ“λ¥Ό  ν†µν•΄μ„λ§  μ΅°νν•λ„λ΅  ν—μ©ν•

λ‹¤.

public static SingletonService getInstance() {
return instance;

}

//3. μƒμ„±μλ¥Ό  privateμΌλ΅  μ„ μ–Έν•΄μ„  μ™Έλ¶€μ—μ„  new ν‚¤μ›λ“λ¥Ό  μ‚¬μ©ν•  κ°μ²΄  μƒμ„±μ„  λ»ν•κ²  λ§‰λ”λ‹¤.
private SingletonService() {

}

public void logic() {
System.out.println("μ‹±κΈ€ν†¤  κ°μ²΄  λ΅μ§  νΈμ¶");


}

```

}

1.   static μμ—­μ— κ°μ²΄ instanceλ¥Ό λ―Έλ¦¬ ν•λ‚ μƒμ„±ν•΄μ„ μ¬λ ¤λ‘”λ‹¤.

2.   π•” κ°μ²΄ μΈμ¤ν„΄μ¤κ°€ ν•„μ”ν•λ©΄ μ¤μ§ getInstance() λ©”μ„λ“λ¥Ό ν†µν•΄μ„λ§ μ΅°νν•  μ μλ‹¤. π•” λ©”μ„λ“λ¥Ό νΈ
μ¶ν•λ©΄ ν•­μƒ κ°™μ€ μΈμ¤ν„΄μ¤λ¥Ό λ°ν™ν•λ‹¤.

3.   λ”± 1κ°μ κ°μ²΄ μΈμ¤ν„΄μ¤λ§ μ΅΄μ¬ν•΄μ•Ό ν•λ―€λ΅, μƒμ„±μλ¥Ό privateμΌλ΅ λ§‰μ•„μ„ νΉμ‹λΌλ„ μ™Έλ¶€μ—μ„ new ν‚¤μ›λ“
λ΅ κ°μ²΄ μΈμ¤ν„΄μ¤κ°€ μƒμ„±λλ” κ²ƒμ„ λ§‰λ”λ‹¤.

μ‹±κΈ€ν†¤ ν¨ν„΄μ„ μ‚¬μ©ν•λ” ν…μ¤νΈ μ½”λ“λ¥Ό λ³΄μ.

```

@Test

@DisplayName("μ‹±κΈ€ν†¤  ν¨ν„΄μ„  μ μ©ν•  κ°μ²΄  μ‚¬μ©")
public void singletonServiceTest() {

//privateμΌλ΅  μƒμ„±μλ¥Ό  λ§‰μ•„λ‘μ—λ‹¤. μ»΄νμΌ  μ¤λ¥κ°€  λ°μƒν•λ‹¤.


//new SingletonService();

//1. μ΅°ν: νΈμ¶ν•   λ•  λ§λ‹¤  κ°™μ€  κ°μ²΄λ¥Ό  λ°ν™

SingletonService singletonService1 = SingletonService.getInstance();

//2. μ΅°ν: νΈμ¶ν•   λ•  λ§λ‹¤  κ°™μ€  κ°μ²΄λ¥Ό  λ°ν™

SingletonService singletonService2 = SingletonService.getInstance();

//μ°Έμ΅°κ°’π•”  κ°™μ€  κ²ƒμ„  ν™•μΈ

System.out.println("singletonService1 = " + singletonService1);
System.out.println("singletonService2 = " + singletonService2);

// singletonService1 == singletonService2
assertThat(singletonService1).isSameAs(singletonService2);


}

```

singletonService1.logic();

privateμΌλ΅ new ν‚¤μ›λ“λ¥Ό λ§‰μ•„λ‘μ—λ‹¤.

νΈμ¶ν•  λ• λ§λ‹¤ κ°™μ€ κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό λ°ν™ν•λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

μ°Έκ³ : μ‹±κΈ€ν†¤ ν¨ν„΄μ„ κµ¬ν„ν•λ” λ°©λ²•μ€ μ—¬λ¬κ°€μ§€κ°€ μλ‹¤. μ—¬κΈ°μ„λ” κ°μ²΄λ¥Ό λ―Έλ¦¬ μƒμ„±ν•΄λ‘λ” κ°€μ¥ λ‹¨μν•κ³  μ•μ „ν•
λ°©λ²•μ„ μ„ νƒν–λ‹¤.

μ‹±κΈ€ν†¤ ν¨ν„΄μ„ μ μ©ν•λ©΄ κ³ κ°μ μ”μ²­π•” μ¬ λ• λ§λ‹¤ κ°μ²΄λ¥Ό μƒμ„±ν•λ” κ²ƒπ•” μ•„λ‹λΌ, π•”λ―Έ λ§λ“¤μ–΄μ§„ κ°μ²΄λ¥Ό κ³µμ ν•΄μ„ ν¨μ¨
μ μΌλ΅ μ‚¬μ©ν•  μ μλ‹¤. ν•μ§€λ§ μ‹±κΈ€ν†¤ ν¨ν„΄μ€ λ‹¤μκ³Ό κ°™μ€ μ λ§μ€ λ¬Έμ μ λ“¤μ„ κ°€μ§€κ³  μλ‹¤.

**μ‹±κΈ€ν†¤ ν¨ν„΄ λ¬Έμ μ **

μ‹±κΈ€ν†¤ ν¨ν„΄μ„ κµ¬ν„ν•λ” μ½”λ“ μμ²΄κ°€ λ§π•” λ“¤μ–΄κ°„λ‹¤.

μμ΅΄κ΄€κ³„μƒ ν΄λΌπ•”μ–ΈνΈκ°€ κµ¬μ²΄ ν΄λμ¤μ— μμ΅΄ν•λ‹¤.     DIPλ¥Ό μ„λ°ν•λ‹¤.
ν΄λΌπ•”μ–ΈνΈκ°€ κµ¬μ²΄ ν΄λμ¤μ— μμ΅΄ν•΄μ„ OCP μ›μΉ™μ„ μ„λ°ν•  κ°€λ¥μ„±π•” λ†’λ‹¤.
ν…μ¤νΈν•κΈ° μ–΄λ µλ‹¤.

λ‚΄λ¶€ μ†μ„±μ„ λ³€κ²½ν•κ±°λ‚ μ΄κΈ°ν™” ν•κΈ° μ–΄λ µλ‹¤.
private μƒμ„±μλ΅ μμ‹ ν΄λμ¤λ¥Ό λ§λ“¤κΈ° μ–΄λ µλ‹¤.
κ²°λ΅ μ μΌλ΅ μ μ—°μ„±π•” λ–¨μ–΄μ§„λ‹¤.

μ•ν‹°ν¨ν„΄μΌλ΅ λ¶λ¦¬κΈ°λ„ ν•λ‹¤.


μ‹±κΈ€ν†¤ μ»¨ν…μ΄λ„

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” μ‹±κΈ€ν†¤ ν¨ν„΄μ λ¬Έμ μ μ„ ν•΄κ²°ν•λ©΄μ„, κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό μ‹±κΈ€ν†¤(1κ°λ§ μƒμ„±)μΌλ΅ κ΄€λ¦¬ν•λ‹¤.
μ§€κΈκΉμ§€ μ°λ¦¬κ°€ ν•™μµν• μ¤ν”„λ§ λΉπ•” λ°”λ΅ μ‹±κΈ€ν†¤μΌλ΅ κ΄€λ¦¬λλ” λΉπ•”λ‹¤.

**μ‹±κΈ€ν†¤ μ»¨ν…μ΄λ„**

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” μ‹±κΈ€ν„΄ ν¨ν„΄μ„ μ μ©ν•μ§€ μ•μ•„λ„, κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό μ‹±κΈ€ν†¤μΌλ΅ κ΄€λ¦¬ν•λ‹¤.

π•”μ „μ— μ„¤λ…ν• μ»¨ν…π•”λ„ μƒμ„± κ³Όμ •μ„ μμ„Έν λ³΄μ. μ»¨ν…π•”λ„λ” κ°μ²΄λ¥Ό ν•λ‚λ§ μƒμ„±ν•΄μ„ κ΄€λ¦¬ν•λ‹¤.

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” μ‹±κΈ€ν†¤ μ»¨ν…π•”λ„ μ—­ν• μ„ ν•λ‹¤. π•”λ ‡κ² μ‹±κΈ€ν†¤ κ°μ²΄λ¥Ό μƒμ„±ν•κ³  κ΄€λ¦¬ν•λ” κΈ°λ¥μ„ μ‹±κΈ€ν†¤ λ μ§€μ¤
νΈλ¦¬λΌ ν•λ‹¤.

μ¤ν”„λ§ μ»¨ν…π•”λ„μ π•”λ° κΈ°λ¥ λ•λ¶„μ— μ‹±κΈ€ν„΄ ν¨ν„΄μ λ¨λ“  λ‹¨μ μ„ ν•΄κ²°ν•λ©΄μ„ κ°μ²΄λ¥Ό μ‹±κΈ€ν†¤μΌλ΅ μ μ§€ν•  μ μλ‹¤.
μ‹±κΈ€ν†¤ ν¨ν„΄μ„ μ„ν• μ§€μ €λ¶„ν• μ½”λ“κ°€ λ“¤μ–΄κ°€μ§€ μ•μ•„λ„ λλ‹¤.

DIP, OCP, ν…μ¤νΈ, private μƒμ„±μλ΅ λ¶€ν„° μμ λ΅­κ² μ‹±κΈ€ν†¤μ„ μ‚¬μ©ν•  μ μλ‹¤.

**μ¤ν”„λ§ μ»¨ν…μ΄λ„λ¥Ό μ‚¬μ©ν•λ” ν…μ¤νΈ μ½”λ“**

```

@Test

@DisplayName("μ¤ν”„λ§  μ»¨ν…π•”λ„μ™€  μ‹±κΈ€ν†¤")
void springContainer() {

ApplicationContext ac = new
AnnotationConfigApplicationContext(AppConfig.class);

//1. μ΅°ν: νΈμ¶ν•   λ•  λ§λ‹¤  κ°™μ€  κ°μ²΄λ¥Ό  λ°ν™

MemberService memberService1 = ac.getBean("memberService",
MemberService.class);

//2. μ΅°ν: νΈμ¶ν•   λ•  λ§λ‹¤  κ°™μ€  κ°μ²΄λ¥Ό  λ°ν™

MemberService memberService2 = ac.getBean("memberService",
MemberService.class);

//μ°Έμ΅°κ°’π•”  κ°™μ€  κ²ƒμ„  ν™•μΈ

System.out.println("memberService1 = " + memberService1);
System.out.println("memberService2 = " + memberService2);

//memberService1 == memberService2
assertThat(memberService1).isSameAs(memberService2);

}

```


**μ‹±κΈ€ν†¤ μ»¨ν…μ΄λ„ μ μ© ν›„**

μ¤ν”„λ§ μ»¨ν…π•”λ„ λ•λ¶„μ— κ³ κ°μ μ”μ²­π•” μ¬ λ• λ§λ‹¤ κ°μ²΄λ¥Ό μƒμ„±ν•λ” κ²ƒπ•” μ•„λ‹λΌ, π•”λ―Έ λ§λ“¤μ–΄μ§„ κ°μ²΄λ¥Ό κ³µμ ν•΄μ„
ν¨μ¨μ μΌλ΅ μ¬μ‚¬μ©ν•  μ μλ‹¤.

μ°Έκ³ : μ¤ν”„λ§μ κΈ°λ³Έ λΉ λ“±λ΅ λ°©μ‹μ€ μ‹±κΈ€ν†¤π•”μ§€λ§, μ‹±κΈ€ν†¤ λ°©μ‹λ§ μ§€μ›ν•λ” κ²ƒμ€ μ•„λ‹λ‹¤. μ”μ²­ν•  λ• λ§λ‹¤ μƒλ΅μ΄
κ°μ²΄λ¥Ό μƒμ„±ν•΄μ„ λ°ν™ν•λ” κΈ°λ¥λ„ μ κ³µν•λ‹¤. μμ„Έν• λ‚΄μ©μ€ λ’¤μ— λΉ μ¤μ½”ν”„μ—μ„ μ„¤λ…ν•κ² λ‹¤.

μ‹±κΈ€ν†¤ λ°©μ‹μ μ£Όμμ 

μ‹±κΈ€ν†¤ ν¨ν„΄π•”λ“ , μ¤ν”„λ§ κ°™μ€ μ‹±κΈ€ν†¤ μ»¨ν…π•”λ„λ¥Ό μ‚¬μ©ν•λ“ , κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό ν•λ‚λ§ μƒμ„±ν•΄μ„ κ³µμ ν•λ” μ‹±κΈ€ν†¤
λ°©μ‹μ€ μ—¬λ¬ ν΄λΌπ•”μ–ΈνΈκ°€ ν•λ‚μ κ°™μ€ κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό κ³µμ ν•κΈ° λ•λ¬Έμ— μ‹±κΈ€ν†¤ κ°μ²΄λ” μƒνƒλ¥Ό μ μ§€(stateful)ν•
κ² μ„¤κ³„ν•λ©΄ μ•λλ‹¤.

λ¬΄μƒνƒ(stateless)λ΅ μ„¤κ³„ν•΄μ•Ό ν•λ‹¤!

νΉμ • ν΄λΌπ•”μ–ΈνΈμ— μμ΅΄μ μΈ ν•„λ“κ°€ μμΌλ©΄ μ•λλ‹¤.

νΉμ • ν΄λΌπ•”μ–ΈνΈκ°€ κ°’μ„ λ³€κ²½ν•  μ μλ” ν•„λ“κ°€ μμΌλ©΄ μ•λλ‹¤!


κ°€κΈ‰μ  μ½κΈ°λ§ κ°€λ¥ν•΄μ•Ό ν•λ‹¤.

ν•„λ“ λ€μ‹ μ— μλ°”μ—μ„ κ³µμ λμ§€ μ•λ”, μ§€μ—­λ³€μ, νλΌλ―Έν„°, ThreadLocal λ“±μ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.
μ¤ν”„λ§ λΉμ ν•„λ“μ— κ³µμ  κ°’μ„ μ„¤μ •ν•λ©΄ μ •λ§ ν° μ¥μ• κ°€ λ°μƒν•  μ μλ‹¤!!!

**μƒνƒλ¥Ό μ μ§€ν•  κ²½μ° λ°μƒν•λ” λ¬Έμ μ  μμ‹**

```

package hello.core.singleton;
public class StatefulService {

private int price; //μƒνƒλ¥Ό  μ μ§€ν•λ”  ν•„λ“

public void order(String name, int price) {
System.out.println("name = " + name + " price = " + price);
this.price             = price; //μ—¬κΈ°κ°€  λ¬Έμ !

}

public int getPrice() {
return price;

}

}

```

**μƒνƒλ¥Ό μ μ§€ν•  κ²½μ° λ°μƒν•λ” λ¬Έμ μ  μμ‹**

```

package hello.core.singleton;

import org.assertj.core.api.Assertions;
import org.junit.jupiter.api.Test;

import org.springframework.context.ApplicationContext;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;

public class StatefulServiceTest {

@Test

void statefulServiceSingleton() {
ApplicationContext ac = new

AnnotationConfigApplicationContext(TestConfig.class);

StatefulService statefulService1 = ac.getBean("statefulService",
StatefulService.class);

StatefulService statefulService2 = ac.getBean("statefulService",
StatefulService.class);


//ThreadA: Aμ‚¬μ©μ  10000μ›  μ£Όλ¬Έ

statefulService1.order("userA", 10000);

//ThreadB: Bμ‚¬μ©μ  20000μ›  μ£Όλ¬Έ

statefulService2.order("userB", 20000);

//ThreadA: μ‚¬μ©μA μ£Όλ¬Έ  κΈμ•΅  μ΅°ν

int price = statefulService1.getPrice();

//ThreadA: μ‚¬μ©μAλ”  10000μ›μ„  κΈ°λ€ν–μ§€λ§, κΈ°λ€μ™€  λ‹¤λ¥΄κ²  20000μ›  μ¶λ ¥

System.out.println("price = " + price);

Assertions.assertThat(statefulService1.getPrice()).isEqualTo(20000);

}

static class TestConfig {

@Bean

public StatefulService statefulService() {
return new StatefulService();

}

}

}

```

μµλ€ν• λ‹¨μν μ„¤λ…ν•κΈ° μ„ν•΄, μ‹¤μ  μ“°λ λ“λ” μ‚¬μ©ν•μ§€ μ•μ•λ‹¤.

ThreadAκ°€ μ‚¬μ©μA μ½”λ“λ¥Ό νΈμ¶ν•κ³  ThreadBκ°€ μ‚¬μ©μB μ½”λ“λ¥Ό νΈμ¶ν•λ‹¤ κ°€μ •ν•μ.
StatefulService μ price ν•„λ“λ” κ³µμ λλ” ν•„λ“μΈλ°, νΉμ • ν΄λΌπ•”μ–ΈνΈκ°€ κ°’μ„ λ³€κ²½ν•λ‹¤.
μ‚¬μ©μAμ μ£Όλ¬ΈκΈμ•΅μ€ 10000μ›π•” λμ–΄μ•Ό ν•λ”λ°, 20000μ›π•”λΌλ” κ²°κ³Όκ°€ λ‚μ™”λ‹¤.

μ‹¤λ¬΄μ—μ„ π•”λ° κ²½μ°λ¥Ό μΆ…μΆ… λ³΄λ”λ°, π•”λ΅μΈν•΄ μ •λ§ ν•΄κ²°ν•κΈ° μ–΄λ ¤μ΄ ν° λ¬Έμ λ“¤π•” ν„°μ§„λ‹¤.(λ‡λ…„μ— ν•λ²μ”© κΌ­ λ§λ‚
λ‹¤.)

μ§„μ§ κ³µμ ν•„λ“λ” μ΅°μ‹¬ν•΄μ•Ό ν•λ‹¤! μ¤ν”„λ§ λΉμ€ ν•­μƒ λ¬΄μƒνƒ(stateless)λ΅ μ„¤κ³„ν•μ.


@Configurationκ³Ό μ‹±κΈ€ν†¤

κ·Έλ°λ° π•”μƒν•μ π•” μλ‹¤. λ‹¤μ AppConfig μ½”λ“λ¥Ό λ³΄μ.

```

@Configuration

public class AppConfig {

@Bean

public MemberService memberService() {

return new MemberServiceImpl(memberRepository());

}

@Bean

public OrderService orderService() {
return new OrderServiceImpl(

memberRepository(),
discountPolicy());

}

@Bean

public MemberRepository memberRepository() {
return new MemoryMemberRepository();

}

...

}

```

memberService λΉμ„ λ§λ“λ” μ½”λ“λ¥Ό λ³΄λ©΄ memberRepository() λ¥Ό νΈμ¶ν•λ‹¤.

π•” λ©”μ„λ“λ¥Ό νΈμ¶ν•λ©΄ new MemoryMemberRepository() λ¥Ό νΈμ¶ν•λ‹¤.
orderService λΉμ„ λ§λ“λ” μ½”λ“λ„ λ™μΌν•κ² memberRepository() λ¥Ό νΈμ¶ν•λ‹¤.

π•” λ©”μ„λ“λ¥Ό νΈμ¶ν•λ©΄ new MemoryMemberRepository() λ¥Ό νΈμ¶ν•λ‹¤.

κ²°κ³Όμ μΌλ΅ κ°κ° λ‹¤λ¥Έ 2κ°μ MemoryMemberRepository κ°€ μƒμ„±λλ©΄μ„ μ‹±κΈ€ν†¤π•” κΉ¨μ§€λ” κ²ƒ μ²λΌ λ³΄μΈλ‹¤. μ¤ν”„λ§
μ»¨ν…π•”λ„λ” π•” λ¬Έμ λ¥Ό μ–΄λ–»κ² ν•΄κ²°ν• κΉ?

μ§μ ‘ ν…μ¤νΈ ν•΄λ³΄μ.

**κ²€μ¦ μ©λ„μ μ½”λ“ μ¶”κ°€**

```

public class MemberServiceImpl implements MemberService {
private final MemberRepository memberRepository;


//ν…μ¤νΈ  μ©λ„

public MemberRepository getMemberRepository() {
return memberRepository;

}

}

public class OrderServiceImpl implements OrderService {
private final MemberRepository memberRepository;

//ν…μ¤νΈ  μ©λ„

public MemberRepository getMemberRepository() {
return memberRepository;


}

```

}

ν…μ¤νΈλ¥Ό μ„ν•΄ MemberRepositoryλ¥Ό μ΅°νν•  μ μλ” κΈ°λ¥μ„ μ¶”κ°€ν•λ‹¤. κΈ°λ¥ κ²€μ¦μ„ μ„ν•΄ μ κΉ μ‚¬μ©ν•λ” κ²ƒπ•”λ‹
μΈν„°νπ•”μ¤μ— μ΅°νκΈ°λ¥κΉμ§€ μ¶”κ°€ν•μ§€λ” λ§μ.

**ν…μ¤νΈ μ½”λ“**

```

package hello.core.singleton;

import hello.core.AppConfig;

import hello.core.member.MemberRepository;
import hello.core.member.MemberServiceImpl;
import hello.core.order.OrderServiceImpl;
import org.junit.jupiter.api.Test;

import org.springframework.context.ApplicationContext;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;
import static org.assertj.core.api.Assertions.*;

public class ConfigurationSingletonTest {

@Test

void configurationTest() {
ApplicationContext ac = new

AnnotationConfigApplicationContext(AppConfig.class);
MemberServiceImpl memberService = ac.getBean("memberService",

MemberServiceImpl.class);

OrderServiceImpl orderService = ac.getBean("orderService",


OrderServiceImpl.class);

MemberRepository memberRepository = ac.getBean("memberRepository",
MemberRepository.class);

//λ¨λ‘  κ°™μ€  μΈμ¤ν„΄μ¤λ¥Ό  μ°Έκ³ ν•κ³   μλ‹¤.
System.out.println("memberService -> memberRepository = " +

memberService.getMemberRepository());
System.out.println("orderService -> memberRepository  = " +

orderService.getMemberRepository());
System.out.println("memberRepository = " + memberRepository);

//λ¨λ‘  κ°™μ€  μΈμ¤ν„΄μ¤λ¥Ό  μ°Έκ³ ν•κ³   μλ‹¤.
assertThat(memberService.getMemberRepository()).isSameAs(memberRepository);

assertThat(orderService.getMemberRepository()).isSameAs(memberRepository);

}

}

```

ν™•μΈν•΄λ³΄λ©΄ memberRepository μΈμ¤ν„΄μ¤λ” λ¨λ‘ κ°™μ€ μΈμ¤ν„΄μ¤κ°€ κ³µμ λμ–΄ μ‚¬μ©λλ‹¤.

AppConfigμ μλ°” μ½”λ“λ¥Ό λ³΄λ©΄ λ¶„λ…ν κ°κ° 2λ² new MemoryMemberRepository νΈμ¶ν•΄μ„ λ‹¤λ¥Έ μΈμ¤ν„΄
μ¤κ°€ μƒμ„±λμ–΄μ•Ό ν•λ”λ°?

μ–΄λ–»κ² λ μΌμΌκΉ? νΉμ‹ λ‘ λ² νΈμ¶π•” μ•λλ” κ²ƒμΌκΉ? μ‹¤ν—μ„ ν†µν•΄ μ•μ•„λ³΄μ.

**AppConfigμ— νΈμ¶ λ΅κ·Έ λ‚¨κΉ€**

```

package hello.core;

import hello.core.discount.DiscountPolicy;
import hello.core.discount.RateDiscountPolicy;
import hello.core.member.MemberRepository;
import hello.core.member.MemberService;

import hello.core.member.MemberServiceImpl;
import hello.core.member.MemoryMemberRepository;
import hello.core.order.OrderService;

import hello.core.order.OrderServiceImpl;

import org.springframework.context.annotation.Bean;

import org.springframework.context.annotation.Configuration;
@Configuration


public class AppConfig {

@Bean

public MemberService memberService() {

//1λ²

System.out.println("call AppConfig.memberService");
return new MemberServiceImpl(memberRepository());

}

@Bean

public OrderService orderService() {

//1λ²

System.out.println("call AppConfig.orderService");
return new OrderServiceImpl(

memberRepository(),
discountPolicy());

}

@Bean

public MemberRepository memberRepository() {

//2λ²? 3λ²?

System.out.println("call AppConfig.memberRepository");
return new MemoryMemberRepository();

}

@Bean

public DiscountPolicy discountPolicy() {
return new RateDiscountPolicy();

}

}

```

μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ κ°κ° @Beanμ„ νΈμ¶ν•΄μ„ μ¤ν”„λ§ λΉμ„ μƒμ„±ν•λ‹¤. κ·Έλμ„ memberRepository() λ” λ‹¤μκ³Ό κ°™π•”
μ΄ 3λ²π•” νΈμ¶λμ–΄μ•Ό ν•λ” κ²ƒ μ•„λ‹κΉ?

1.   μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ μ¤ν”„λ§ λΉμ— λ“±λ΅ν•κΈ° μ„ν•΄ @Beanπ•” λ¶™μ–΄μλ” memberRepository() νΈμ¶

2.   memberService() λ΅μ§μ—μ„ memberRepository() νΈμ¶

3.   orderService() λ΅μ§μ—μ„ memberRepository() νΈμ¶

κ·Έλ°λ° μ¶λ ¥ κ²°κ³Όλ” λ¨λ‘ 1λ²λ§ νΈμ¶λλ‹¤.

```


call AppConfig.memberService
call AppConfig.memberRepository
call AppConfig.orderService

```

@Configurationκ³Ό λ°”μ΄νΈμ½”λ“ μ΅°μ‘μ λ§λ²•

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” μ‹±κΈ€ν†¤ λ μ§€μ¤νΈλ¦¬λ‹¤. λ”°λΌμ„ μ¤ν”„λ§ λΉπ•” μ‹±κΈ€ν†¤π•” λλ„λ΅ λ³΄μ¥ν•΄μ£Όμ–΄μ•Ό ν•λ‹¤. κ·Έλ°λ° μ¤ν”„λ§π•” μ
λ°” μ½”λ“κΉμ§€ μ–΄λ–»κ² ν•κΈ°λ” μ–΄λ µλ‹¤. μ € μλ°” μ½”λ“λ¥Ό λ³΄λ©΄ λ¶„λ… 3λ² νΈμ¶λμ–΄μ•Ό ν•λ” κ²ƒπ•” λ§λ‹¤.

κ·Έλμ„ μ¤ν”„λ§μ€ ν΄λμ¤μ λ°”π•”νΈμ½”λ“λ¥Ό μ΅°μ‘ν•λ” λΌπ•”λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•λ‹¤.
λ¨λ“  λΉ„λ°€μ€ @Configuration μ„ μ μ©ν• AppConfig μ— μλ‹¤.

λ‹¤μ μ½”λ“λ¥Ό λ³΄μ.

```

@Test

void configurationDeep() {
ApplicationContext ac = new

AnnotationConfigApplicationContext(AppConfig.class);

//AppConfigλ„  μ¤ν”„λ§  λΉμΌλ΅  λ“±λ΅λλ‹¤.

AppConfig bean = ac.getBean(AppConfig.class);


}

```

System.out.println("bean = " + bean.getClass());

//μ¶λ ¥: bean = class hello.core.AppConfig$$EnhancerBySpringCGLIB$$bd479d70

μ‚¬μ‹¤ AnnotationConfigApplicationContext μ— νλΌλ―Έν„°λ΅ λ„κΈ΄ κ°’μ€ μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅λλ‹¤. κ·Έλμ„

AppConfig λ„ μ¤ν”„λ§ λΉπ•” λλ‹¤.

AppConfig μ¤ν”„λ§ λΉμ„ μ΅°νν•΄μ„ ν΄λμ¤ μ •λ³΄λ¥Ό μ¶λ ¥ν•΄λ³΄μ.

```te

bean = class hello.core.AppConfig$$EnhancerBySpringCGLIB$$bd479d70

```

μμν• ν΄λμ¤λΌλ©΄ λ‹¤μκ³Ό κ°™π•” μ¶λ ¥λμ–΄μ•Ό ν•λ‹¤.

class hello.core.AppConfig

κ·Έλ°λ° μμƒκ³Όλ” λ‹¤λ¥΄κ² ν΄λμ¤ λ…μ— xxxCGLIBκ°€ λ¶™μΌλ©΄μ„ μƒλ‹Ήν λ³µμ΅ν•΄μ§„ κ²ƒμ„ λ³Ό μ μλ‹¤. π•”κ²ƒμ€ λ‚΄κ°€ λ§λ“  ν΄λ
μ¤κ°€ μ•„λ‹λΌ μ¤ν”„λ§π•” CGLIBλΌλ” λ°”π•”νΈμ½”λ“ μ΅°μ‘ λΌπ•”λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•΄μ„ AppConfig ν΄λμ¤λ¥Ό μƒμ†λ°›μ€ μ„μμ λ‹¤


λ¥Έ ν΄λμ¤λ¥Ό λ§λ“¤κ³ , κ·Έ λ‹¤λ¥Έ ν΄λμ¤λ¥Ό μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν• κ²ƒπ•”λ‹¤!

**κ·Έλ¦Ό**

κ·Έ μ„μμ λ‹¤λ¥Έ ν΄λμ¤κ°€ λ°”λ΅ μ‹±κΈ€ν†¤π•” λ³΄μ¥λλ„λ΅ ν•΄μ¤€λ‹¤. μ•„λ§λ„ λ‹¤μκ³Ό κ°™π•” λ°”π•”νΈ μ½”λ“λ¥Ό μ΅°μ‘ν•΄μ„ μ‘μ„±λμ–΄ μμ„
κ²ƒπ•”λ‹¤.(μ‹¤μ λ΅λ” CGLIBμ λ‚΄λ¶€ κΈ°μ μ„ μ‚¬μ©ν•λ”λ° λ§¤μ° λ³µμ΅ν•λ‹¤.)

**AppConfig@CGLIB μμƒ μ½”λ“**

```

@Bean

public MemberRepository memberRepository() {

if (memoryMemberRepositoryκ°€  π•”λ―Έ  μ¤ν”„λ§  μ»¨ν…π•”λ„μ—  λ“±λ΅λμ–΄  μμΌλ©΄?) {
return μ¤ν”„λ§  μ»¨ν…π•”λ„μ—μ„  μ°Ύμ•„μ„  λ°ν™;

} else { //μ¤ν”„λ§  μ»¨ν…π•”λ„μ—  μ—†μΌλ©΄

κΈ°μ΅΄  λ΅μ§μ„  νΈμ¶ν•΄μ„  MemoryMemberRepositoryλ¥Ό  μƒμ„±ν•κ³   μ¤ν”„λ§  μ»¨ν…π•”λ„μ—  λ“±λ΅

return λ°ν™

}

}

```

@Beanπ•” λ¶™μ€ λ©”μ„λ“λ§λ‹¤ π•”λ―Έ μ¤ν”„λ§ λΉπ•” μ΅΄μ¬ν•λ©΄ μ΅΄μ¬ν•λ” λΉμ„ λ°ν™ν•κ³ , μ¤ν”„λ§ λΉπ•” μ—†μΌλ©΄ μƒμ„±ν•΄μ„ μ¤
ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•κ³  λ°ν™ν•λ” μ½”λ“κ°€ λ™μ μΌλ΅ λ§λ“¤μ–΄μ§„λ‹¤.

λ•λ¶„μ— μ‹±κΈ€ν†¤π•” λ³΄μ¥λλ” κ²ƒπ•”λ‹¤.

**μ°Έκ³ **                   AppConfig@CGLIBλ” AppConfigμ μμ‹ νƒ€μ…π•”λ―€λ΅, AppConfig νƒ€μ…μΌλ΅ μ΅°ν ν•  μ μλ‹¤.


@Configuration μ„ μ μ©ν•μ§€ μ•κ³ , @Bean λ§ μ μ©ν•λ©΄ μ–΄λ–»κ² λ κΉ?

@Configuration μ„ λ¶™π•”λ©΄ λ°”π•”νΈμ½”λ“λ¥Ό μ΅°μ‘ν•λ” CGLIB κΈ°μ μ„ μ‚¬μ©ν•΄μ„ μ‹±κΈ€ν†¤μ„ λ³΄μ¥ν•μ§€λ§, λ§μ•½ @Beanλ§
μ μ©ν•λ©΄ μ–΄λ–»κ² λ κΉ?

```

//@Configuration μ‚­μ 

public class AppConfig {

}

```

π•”μ  λ‘κ°™π•” μ‹¤ν–‰ν•΄λ³΄μ.

```te

bean = class hello.core.AppConfig

```

π•” μ¶λ ¥ κ²°κ³Όλ¥Ό ν†µν•΄μ„ AppConfigκ°€ CGLIB κΈ°μ  μ—†π•” μμν• AppConfigλ΅ μ¤ν”„λ§ λΉμ— λ“±λ΅λ κ²ƒμ„ ν™•μΈν•  μ μ
λ‹¤.

```te

call AppConfig.memberService
call AppConfig.memberRepository
call AppConfig.orderService
call AppConfig.memberRepository
call AppConfig.memberRepository

```

π•” μ¶λ ¥ κ²°κ³Όλ¥Ό ν†µν•΄μ„ MemberRepositoryκ°€ μ΄ 3λ² νΈμ¶λ κ²ƒμ„ μ• μ μλ‹¤. 1λ²μ€ @Beanμ— μν•΄ μ¤ν”„λ§ μ»¨ν…π•”
λ„μ— λ“±λ΅ν•κΈ° μ„ν•΄μ„π•”κ³ , 2λ²μ€ κ°κ° memberRepository() λ¥Ό νΈμ¶ν•λ©΄μ„ λ°μƒν• μ½”λ“λ‹¤.

**μΈμ¤ν„΄μ¤κ°€ κ°™μ€μ§€ ν…μ¤νΈ κ²°κ³Ό**

```te

memberService -> memberRepository =
hello.core.member.MemoryMemberRepository@6239aba6
orderService                                                 -> memberRepository  =
hello.core.member.MemoryMemberRepository@3e6104fc

memberRepository = hello.core.member.MemoryMemberRepository@12359a82

```

λ‹Ήμ—°ν μΈμ¤ν„΄μ¤κ°€ κ°™μ€μ§€ ν…μ¤νΈ ν•λ” μ½”λ“λ„ μ‹¤ν¨ν•κ³ , κ°κ° λ‹¤ λ‹¤λ¥Έ MemoryMemberRepository μΈμ¤ν„΄μ¤λ¥Ό κ°€
μ§€κ³  μλ‹¤.

ν™•μΈπ•” λλ‚¬μΌλ©΄  @Configurationπ•” λ™μ‘ν•λ„λ΅ λ‹¤μ‹ λλ ¤λ†“μ.

**μ •λ¦¬**

@Beanλ§ μ‚¬μ©ν•΄λ„ μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅λμ§€λ§, μ‹±κΈ€ν†¤μ„ λ³΄μ¥ν•μ§€ μ•λ”λ‹¤.


memberRepository() μ²λΌ μμ΅΄κ΄€κ³„ μ£Όμ…π•” ν•„μ”ν•΄μ„ λ©”μ„λ“λ¥Ό μ§μ ‘ νΈμ¶ν•  λ• μ‹±κΈ€ν†¤μ„ λ³΄μ¥ν•μ§€ μ•
λ”λ‹¤.

ν¬κ² κ³ λ―Όν•  κ²ƒπ•” μ—†λ‹¤. μ¤ν”„λ§ μ„¤μ • μ •λ³΄λ” ν•­μƒ @Configuration μ„ μ‚¬μ©ν•μ.


6. μ»΄ν¬λ„νΈ μ¤μΊ”

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

/μ»΄ν¬λ„νΈ μ¤μΊ”κ³Ό μμ΅΄κ΄€κ³„ μλ™ μ£Όμ… μ‹μ‘ν•κΈ°

/νƒμƒ‰ μ„μΉμ™€ κΈ°λ³Έ μ¤μΊ” λ€μƒ

/ν•„ν„°

/μ¤‘λ³µ λ“±λ΅κ³Ό μ¶©λ

μ»΄ν¬λ„νΈ μ¤μΊ”κ³Ό μμ΅΄κ΄€κ³„ μλ™ μ£Όμ… μ‹μ‘ν•κΈ°

μ§€κΈκΉμ§€ μ¤ν”„λ§ λΉμ„ λ“±λ΅ν•  λ•λ” μλ°” μ½”λ“μ @Beanπ•”λ‚ XMLμ <bean> λ“±μ„ ν†µν•΄μ„ μ„¤μ • μ •λ³΄μ— μ§μ ‘ λ“±
λ΅ν•  μ¤ν”„λ§ λΉμ„ λ‚μ—΄ν–λ‹¤.

μμ μ—μ„λ” λ‡κ°κ°€ μ•λμ—μ§€λ§, π•”λ ‡κ² λ“±λ΅ν•΄μ•Ό ν•  μ¤ν”„λ§ λΉπ•” μμ‹­, μλ°±κ°κ°€ λλ©΄ μΌμΌπ•” λ“±λ΅ν•κΈ°λ„ κ·€μ°®κ³ ,
μ„¤μ • μ •λ³΄λ„ μ»¤μ§€κ³ , λ„λ½ν•λ” λ¬Έμ λ„ λ°μƒν•λ‹¤. μ—­μ‹ κ°λ°μλ” λ°λ³µμ„ μ‹«μ–΄ν•λ‹¤.(λ¬΄μ—‡λ³΄λ‹¤ κ·€μ°®λ‹¤ γ… γ… )

κ·Έλμ„ μ¤ν”„λ§μ€ μ„¤μ • μ •λ³΄κ°€ μ—†μ–΄λ„ μλ™μΌλ΅ μ¤ν”„λ§ λΉμ„ λ“±λ΅ν•λ” μ»΄ν¬λ„νΈ μ¤μΊ”π•”λΌλ” κΈ°λ¥μ„ μ κ³µν•λ‹¤.
λ μμ΅΄κ΄€κ³„λ„ μλ™μΌλ΅ μ£Όμ…ν•λ” @Autowired λΌλ” κΈ°λ¥λ„ μ κ³µν•λ‹¤.

μ½”λ“λ΅ μ»΄ν¬λ„νΈ μ¤μΊ”κ³Ό μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…μ„ μ•μ•„λ³΄μ.

λ¨Όμ € κΈ°μ΅΄ AppConfig.javaλ” κ³Όκ±° μ½”λ“μ™€ ν…μ¤νΈλ¥Ό μ μ§€ν•κΈ° μ„ν•΄ λ‚¨κ²¨λ‘κ³ , μƒλ΅μ΄ AutoAppConfig.javaλ¥Ό λ§λ“¤
μ.

**AutoAppConfig.java**

```

package hello.core;

import org.springframework.context.annotation.ComponentScan;
import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.FilterType;

import static org.springframework.context.annotation.ComponentScan.*;

@Configuration
@ComponentScan(

excludeFilters = @Filter(type = FilterType.ANNOTATION, classes =
Configuration.class))

public class AutoAppConfig {

}



```

μ»΄ν¬λ„νΈ μ¤μΊ”μ„ μ‚¬μ©ν•λ ¤λ©΄ λ¨Όμ € @ComponentScan μ„ μ„¤μ • μ •λ³΄μ— λ¶™μ—¬μ£Όλ©΄ λλ‹¤.
κΈ°μ΅΄μ AppConfigμ™€λ” λ‹¤λ¥΄κ² @BeanμΌλ΅ λ“±λ΅ν• ν΄λμ¤κ°€ ν•λ‚λ„ μ—†λ‹¤!

**μ°Έκ³ :**                   μ»΄ν¬λ„νΈ μ¤μΊ”μ„ μ‚¬μ©ν•λ©΄ @Configuration π•” λ¶™μ€ μ„¤μ • μ •λ³΄λ„ μλ™μΌλ΅ λ“±λ΅λκΈ° λ•λ¬Έμ—,
AppConfig, TestConfig λ“± μ•μ„ λ§λ“¤μ–΄λ‘μ—λ μ„¤μ • μ •λ³΄λ„ ν•¨κ» λ“±λ΅λκ³ , μ‹¤ν–‰λμ–΄ λ²„λ¦°λ‹¤. κ·Έλμ„
excludeFilters λ¥Ό π•”μ©ν•΄μ„ μ„¤μ •μ •λ³΄λ” μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ—μ„ μ μ™Έν–λ‹¤. λ³΄ν†µ μ„¤μ • μ •λ³΄λ¥Ό μ»΄ν¬λ„νΈ μ¤μΊ”
λ€μƒμ—μ„ μ μ™Έν•μ§€λ” μ•μ§€λ§, κΈ°μ΅΄ μμ  μ½”λ“λ¥Ό μµλ€ν• λ‚¨κΈ°κ³  μ μ§€ν•κΈ° μ„ν•΄μ„ π•” λ°©λ²•μ„ μ„ νƒν–λ‹¤.

μ»΄ν¬λ„νΈ μ¤μΊ”μ€ π•”λ¦„ κ·Έλ€λ΅ @Component μ• λ…Έν…π•”μ…π•” λ¶™μ€ ν΄λμ¤λ¥Ό μ¤μΊ”ν•΄μ„ μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•λ‹¤.

@Component λ¥Ό λ¶™μ—¬μ£Όμ.

μ°Έκ³ :  @Configuration π•” μ»΄ν¬λ„νΈ μ¤μΊ”μ λ€μƒπ•” λ π•”μ λ„ @Configuration μ†μ¤μ½”λ“λ¥Ό μ—΄μ–΄λ³΄λ©΄

@Component μ• λ…Έν…π•”μ…π•” λ¶™μ–΄μκΈ° λ•λ¬Έπ•”λ‹¤.

π•”μ  κ° ν΄λμ¤κ°€ μ»΄ν¬λ„νΈ μ¤μΊ”μ λ€μƒπ•” λλ„λ΅ @Component μ• λ…Έν…π•”μ…μ„ λ¶™μ—¬μ£Όμ.

**MemoryMemberRepository @Component μ¶”κ°€**

```

@Component

public class MemoryMemberRepository implements MemberRepository {}

```

**RateDiscountPolicy @Component μ¶”κ°€**

```

@Component

public class RateDiscountPolicy implements DiscountPolicy {}

```

**MemberServiceImpl @Component, @Autowired μ¶”κ°€**

```

@Component

public class MemberServiceImpl implements MemberService {
private final MemberRepository memberRepository;

@Autowired

public MemberServiceImpl(MemberRepository memberRepository) {
this.memberRepository = memberRepository;

}

}

```


π•”μ „μ— AppConfigμ—μ„λ” @Bean μΌλ΅ μ§μ ‘ μ„¤μ • μ •λ³΄λ¥Ό μ‘μ„±ν–κ³ , μμ΅΄κ΄€κ³„λ„ μ§μ ‘ λ…μ‹ν–λ‹¤. π•”μ λ” π•”λ° μ„¤
μ • μ •λ³΄ μμ²΄κ°€ μ—†κΈ° λ•λ¬Έμ—, μμ΅΄κ΄€κ³„ μ£Όμ…λ„ π•” ν΄λμ¤ μ•μ—μ„ ν•΄κ²°ν•΄μ•Ό ν•λ‹¤.

@Autowired λ” μμ΅΄κ΄€κ³„λ¥Ό μλ™μΌλ΅ μ£Όμ…ν•΄μ¤€λ‹¤. μμ„Έν• λ£°μ€ μ΅°κΈ λ’¤μ— μ„¤λ…ν•κ² λ‹¤.

**OrderServiceImpl @Component, @Autowired μ¶”κ°€**

```

@Component

public class OrderServiceImpl implements OrderService {

private final MemberRepository memberRepository;
private final DiscountPolicy discountPolicy;

@Autowired

public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy
discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;


}

```

}

@Autowired λ¥Ό μ‚¬μ©ν•λ©΄ μƒμ„±μμ—μ„ μ—¬λ¬ μμ΅΄κ΄€κ³„λ„ ν•λ²μ— μ£Όμ…λ°›μ„ μ μλ‹¤.

**AutoAppConfigTest.java**

```

package hello.core.scan;

import hello.core.AutoAppConfig;

import hello.core.member.MemberService;
import org.junit.jupiter.api.Test;

import org.springframework.context.ApplicationContext;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;
import static org.assertj.core.api.Assertions.*;

public class AutoAppConfigTest {

@Test

void basicScan() {
ApplicationContext ac = new

AnnotationConfigApplicationContext(AutoAppConfig.class);

MemberService memberService = ac.getBean(MemberService.class);


assertThat(memberService).isInstanceOf(MemberService.class);

}

}

```

AnnotationConfigApplicationContext λ¥Ό μ‚¬μ©ν•λ” κ²ƒμ€ κΈ°μ΅΄κ³Ό λ™μΌν•λ‹¤.
μ„¤μ • μ •λ³΄λ΅ AutoAppConfig ν΄λμ¤λ¥Ό λ„κ²¨μ¤€λ‹¤.

μ‹¤ν–‰ν•΄λ³΄λ©΄ κΈ°μ΅΄κ³Ό κ°™π•” μ λ™μ‘ν•λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

λ΅κ·Έλ¥Ό μ λ³΄λ©΄ μ»΄ν¬λ„νΈ μ¤μΊ”π•” μ λ™μ‘ν•λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

```te

ClassPathBeanDefinitionScanner - Identified candidate component class:

.. RateDiscountPolicy.class

.. MemberServiceImpl.class

.. MemoryMemberRepository.class

.. OrderServiceImpl.class

```

μ»΄ν¬λ„νΈ μ¤μΊ”κ³Ό μλ™ μμ΅΄κ΄€κ³„ μ£Όμ…π•” μ–΄λ–»κ² λ™μ‘ν•λ”μ§€ κ·Έλ¦ΌμΌλ΅ μ•μ•„λ³΄μ.

**1. @ComponentScan**

@ComponentScan μ€ @Component κ°€ λ¶™μ€ λ¨λ“  ν΄λμ¤λ¥Ό μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•λ‹¤.

π•”λ• μ¤ν”„λ§ λΉμ κΈ°λ³Έ π•”λ¦„μ€ ν΄λμ¤λ…μ„ μ‚¬μ©ν•λ λ§¨ μ•κΈ€μλ§ μ†λ¬Έμλ¥Ό μ‚¬μ©ν•λ‹¤.

**λΉ μ΄λ¦„ κΈ°λ³Έ μ „λµ: MemberServiceImpl ν΄λμ¤    memberServiceImpl

**λΉ μ΄λ¦„ μ§μ ‘ μ§€μ •: λ§μ•½ μ¤ν”„λ§ λΉμ π•”λ¦„μ„ μ§μ ‘ μ§€μ •ν•κ³  μ‹¶μΌλ©΄

@Component("memberService2") π•”λ°μ‹μΌλ΅ π•”λ¦„μ„ λ¶€μ—¬ν•λ©΄ λλ‹¤.


**2. @Autowired μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…**

μƒμ„±μμ— @Autowired λ¥Ό μ§€μ •ν•λ©΄, μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ μλ™μΌλ΅ ν•΄λ‹Ή μ¤ν”„λ§ λΉμ„ μ°Ύμ•„μ„ μ£Όμ…ν•λ‹¤.

π•”λ• κΈ°λ³Έ μ΅°ν μ „λµμ€ νƒ€μ…π•” κ°™μ€ λΉμ„ μ°Ύμ•„μ„ μ£Όμ…ν•λ‹¤.
getBean(MemberRepository.class) μ™€ λ™μΌν•λ‹¤κ³  π•”ν•΄ν•λ©΄ λλ‹¤.
λ”                                                  μμ„Έν• λ‚΄μ©μ€ λ’¤μ—μ„ μ„¤λ…ν•λ‹¤.

μƒμ„±μμ— νλΌλ―Έν„°κ°€ λ§μ•„λ„ λ‹¤ μ°Ύμ•„μ„ μλ™μΌλ΅ μ£Όμ…ν•λ‹¤.


νƒμƒ‰ μ„μΉμ™€ κΈ°λ³Έ μ¤μΊ” λ€μƒ

νƒμƒ‰ν•  ν¨ν‚¤μ§€μ μ‹μ‘ μ„μΉ μ§€μ •

λ¨λ“  μλ°” ν΄λμ¤λ¥Ό λ‹¤ μ»΄ν¬λ„νΈ μ¤μΊ”ν•λ©΄ μ‹κ°„π•” μ¤λ κ±Έλ¦°λ‹¤. κ·Έλμ„ κΌ­ ν•„μ”ν• μ„μΉλ¶€ν„° νƒμƒ‰ν•λ„λ΅ μ‹μ‘ μ„μΉλ¥Ό μ§€
μ •ν•  μ μλ‹¤.

```

@ComponentScan(

basePackages = "hello.core",

}

```

basePackages : νƒμƒ‰ν•  ν¨ν‚¤μ§€μ μ‹μ‘ μ„μΉλ¥Ό μ§€μ •ν•λ‹¤. π•” ν¨ν‚¤μ§€λ¥Ό ν¬ν•¨ν•΄μ„ ν•μ„ ν¨ν‚¤μ§€λ¥Ό λ¨λ‘ νƒμƒ‰ν•λ‹¤.
basePackages = {"hello.core", "hello.service"}  π•”λ ‡κ² μ—¬λ¬ μ‹μ‘ μ„μΉλ¥Ό μ§€μ •ν•  μλ„
μλ‹¤.

basePackageClasses : μ§€μ •ν• ν΄λμ¤μ ν¨ν‚¤μ§€λ¥Ό νƒμƒ‰ μ‹μ‘ μ„μΉλ΅ μ§€μ •ν•λ‹¤.

λ§μ•½ μ§€μ •ν•μ§€ μ•μΌλ©΄ @ComponentScan π•” λ¶™μ€ μ„¤μ • μ •λ³΄ ν΄λμ¤μ ν¨ν‚¤μ§€κ°€ μ‹μ‘ μ„μΉκ°€ λλ‹¤.

**κ¶μ¥ν•λ” λ°©λ²•**

κ°μΈμ μΌλ΅ μ¦κ²¨ μ‚¬μ©ν•λ” λ°©λ²•μ€ ν¨ν‚¤μ§€ μ„μΉλ¥Ό μ§€μ •ν•μ§€ μ•κ³ , μ„¤μ • μ •λ³΄ ν΄λμ¤μ μ„μΉλ¥Ό ν”„λ΅μ νΈ μµμƒλ‹¨μ— λ‘λ” κ²ƒ

π•”λ‹¤. μµκ·Ό μ¤ν”„λ§ λ¶€νΈλ„ π•” λ°©λ²•μ„ κΈ°λ³ΈμΌλ΅ μ κ³µν•λ‹¤.
μλ¥Ό λ“¤μ–΄μ„ ν”„λ΅μ νΈκ°€ λ‹¤μκ³Ό κ°™π•” κµ¬μ΅°κ°€ λμ–΄ μμΌλ©΄

com.hello
com.hello.serivce
com.hello.repository

com.hello   ν”„λ΅μ νΈ μ‹μ‘ λ£¨νΈ, μ—¬κΈ°μ— AppConfig κ°™μ€ λ©”μΈ μ„¤μ • μ •λ³΄λ¥Ό λ‘κ³ , @ComponentScan μ• λ…Έν…π•”
μ…μ„ λ¶™π•”κ³ ,  basePackages μ§€μ •μ€ μƒλµν•λ‹¤.

π•”λ ‡κ² ν•λ©΄ com.hello λ¥Ό ν¬ν•¨ν• ν•μ„λ” λ¨λ‘ μλ™μΌλ΅ μ»΄ν¬λ„νΈ μ¤μΊ”μ λ€μƒπ•” λλ‹¤. κ·Έλ¦¬κ³  ν”„λ΅μ νΈ λ©”μΈ μ„¤μ •
μ •λ³΄λ” ν”„λ΅μ νΈλ¥Ό λ€ν‘ν•λ” μ •λ³΄π•”κΈ° λ•λ¬Έμ— ν”„λ΅μ νΈ μ‹μ‘ λ£¨νΈ μ„μΉμ— λ‘λ” κ²ƒπ•” μΆ‹λ‹¤ μƒκ°ν•λ‹¤.

μ°Έκ³ λ΅ μ¤ν”„λ§ λ¶€νΈλ¥Ό μ‚¬μ©ν•λ©΄ μ¤ν”„λ§ λ¶€νΈμ λ€ν‘ μ‹μ‘ μ •λ³΄μΈ @SpringBootApplication λ¥Ό π•” ν”„λ΅μ νΈ μ‹μ‘
λ£¨νΈ μ„μΉμ— λ‘λ” κ²ƒπ•” κ΄€λ΅€π•”λ‹¤. (κ·Έλ¦¬κ³  π•” μ„¤μ •μ•μ— λ°”λ΅ @ComponentScan π•” λ“¤μ–΄μλ‹¤!)

μ»΄ν¬λ„νΈ μ¤μΊ” κΈ°λ³Έ λ€μƒ


μ»΄ν¬λ„νΈ μ¤μΊ”μ€ @Component λΏλ§ μ•„λ‹λΌ λ‹¤μκ³Ό λ‚΄μ©λ„ μ¶”κ°€λ΅ λ€μƒμ— ν¬ν•¨ν•λ‹¤.

@Component : μ»΄ν¬λ„νΈ μ¤μΊ”μ—μ„ μ‚¬μ©
@Controller : μ¤ν”„λ§ MVC μ»¨νΈλ΅¤λ¬μ—μ„ μ‚¬μ©
@Service        : μ¤ν”„λ§ λΉ„μ¦λ‹μ¤ λ΅μ§μ—μ„ μ‚¬μ©
@Repository  : μ¤ν”„λ§ λ°π•”ν„° μ ‘κ·Ό κ³„μΈµμ—μ„ μ‚¬μ©
@Configuration : μ¤ν”„λ§ μ„¤μ • μ •λ³΄μ—μ„ μ‚¬μ©

ν•΄λ‹Ή ν΄λμ¤μ μ†μ¤ μ½”λ“λ¥Ό λ³΄λ©΄ @Component λ¥Ό ν¬ν•¨ν•κ³  μλ” κ²ƒμ„ μ• μ μλ‹¤.

```

@Component

public @interface Controller {

}

@Component

public @interface Service {

}

@Component

public @interface Configuration {

}

```

μ°Έκ³ : μ‚¬μ‹¤ μ• λ…Έν…π•”μ…μ—λ” μƒμ†κ΄€κ³„λΌλ” κ²ƒπ•” μ—†λ‹¤. κ·Έλμ„ π•”λ ‡κ² μ• λ…Έν…π•”μ…π•” νΉμ • μ• λ…Έν…π•”μ…μ„ λ“¤κ³  μλ”
κ²ƒμ„ μΈμ‹ν•  μ μλ” κ²ƒμ€ μλ°” μ–Έμ–΄κ°€ μ§€μ›ν•λ” κΈ°λ¥μ€ μ•„λ‹κ³ , μ¤ν”„λ§π•” μ§€μ›ν•λ” κΈ°λ¥π•”λ‹¤.

μ»΄ν¬λ„νΈ μ¤μΊ”μ μ©λ„ λΏλ§ μ•„λ‹λΌ λ‹¤μ μ• λ…Έν…π•”μ…π•” μμΌλ©΄ μ¤ν”„λ§μ€ λ¶€κ°€ κΈ°λ¥μ„ μν–‰ν•λ‹¤.

@Controller : μ¤ν”„λ§ MVC μ»¨νΈλ΅¤λ¬λ΅ μΈμ‹

@Repository : μ¤ν”„λ§ λ°π•”ν„° μ ‘κ·Ό κ³„μΈµμΌλ΅ μΈμ‹ν•κ³ , λ°π•”ν„° κ³„μΈµμ μμ™Έλ¥Ό μ¤ν”„λ§ μμ™Έλ΅ λ³€ν™ν•΄μ¤€λ‹¤.
@Configuration : μ•μ„ λ³΄μ•λ“―π•” μ¤ν”„λ§ μ„¤μ • μ •λ³΄λ΅ μΈμ‹ν•κ³ , μ¤ν”„λ§ λΉπ•” μ‹±κΈ€ν†¤μ„ μ μ§€ν•λ„λ΅ μ¶”κ°€ μ²λ¦¬
λ¥Ό ν•λ‹¤.

@Service : μ‚¬μ‹¤ @Service λ” νΉλ³„ν• μ²λ¦¬λ¥Ό ν•μ§€ μ•λ”λ‹¤. λ€μ‹  κ°λ°μλ“¤π•” ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§π•” μ—¬κΈ°μ— μ
κ² κµ¬λ‚ λΌκ³  λΉ„μ¦λ‹μ¤ κ³„μΈµμ„ μΈμ‹ν•λ”λ° λ„μ›€π•” λλ‹¤.

μ°Έκ³ :  useDefaultFilters μµμ…μ€ κΈ°λ³ΈμΌλ΅ μΌμ Έμλ”λ°, π•” μµμ…μ„ λ„λ©΄ κΈ°λ³Έ μ¤μΊ” λ€μƒλ“¤π•” μ μ™Έλλ‹¤. κ·Έλƒ¥

π•”λ° μµμ…π•” μκµ¬λ‚ μ •λ„ μ•κ³  λ„μ–΄κ°€μ.


ν•„ν„°

includeFilters : μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ„ μ¶”κ°€λ΅ μ§€μ •ν•λ‹¤.

excludeFilters : μ»΄ν¬λ„νΈ μ¤μΊ”μ—μ„ μ μ™Έν•  λ€μƒμ„ μ§€μ •ν•λ‹¤.

λΉ λ¥΄κ² μμ λ΅ ν™•μΈν•΄λ³΄μ.

**λ¨λ“  μ½”λ“λ” ν…μ¤νΈ μ½”λ“μ— μ¶”κ°€**

**μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ— μ¶”κ°€ν•  μ• λ…Έν…μ΄μ…**

```

package hello.core.scan.filter;
import java.lang.annotation.*;

@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented

public @interface MyIncludeComponent {

}

```

**μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ—μ„ μ μ™Έν•  μ• λ…Έν…μ΄μ…**

```

package hello.core.scan.filter;
import java.lang.annotation.*;

@Target(ElementType.TYPE)
@Retention(RetentionPolicy.RUNTIME)
@Documented

public @interface MyExcludeComponent {

}

```

**μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ— μ¶”κ°€ν•  ν΄λμ¤**

```

package hello.core.scan.filter;

@MyIncludeComponent
public class BeanA {

}


```

@MyIncludeComponent μ μ©


**μ»΄ν¬λ„νΈ μ¤μΊ” λ€μƒμ—μ„ μ μ™Έν•  ν΄λμ¤**

```

package hello.core.scan.filter;

@MyExcludeComponent
public class BeanB {

}


```

@MyExcludeComponent μ μ©

**μ„¤μ • μ •λ³΄μ™€ μ „μ²΄ ν…μ¤νΈ μ½”λ“**

```

package hello.core.scan.filter;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.NoSuchBeanDefinitionException;
import org.springframework.context.ApplicationContext;

import
org.springframework.context.annotation.AnnotationConfigApplicationContext;
import                       org.springframework.context.annotation.ComponentScan;

import org.springframework.context.annotation.Configuration;
import org.springframework.context.annotation.FilterType;

import static org.assertj.core.api.Assertions.assertThat;

import static org.springframework.context.annotation.ComponentScan.Filter;
public class ComponentFilterAppConfigTest {

@Test

void filterScan() {
ApplicationContext ac = new

AnnotationConfigApplicationContext(ComponentFilterAppConfig.class);

BeanA beanA = ac.getBean("beanA", BeanA.class);
assertThat(beanA).isNotNull();

Assertions.assertThrows(

NoSuchBeanDefinitionException.class,

() -> ac.getBean("beanB", BeanB.class));

}

@Configuration
@ComponentScan(


includeFilters = @Filter(type = FilterType.ANNOTATION, classes =
MyIncludeComponent.class),

excludeFilters = @Filter(type = FilterType.ANNOTATION, classes =
MyExcludeComponent.class)

)

static class ComponentFilterAppConfig {

}

}

```

```

@ComponentScan(

includeFilters = @Filter(type = FilterType.ANNOTATION, classes =

MyIncludeComponent.class),

excludeFilters = @Filter(type = FilterType.ANNOTATION, classes =

MyExcludeComponent.class)

)


```

includeFilters μ— MyIncludeComponent μ• λ…Έν…π•”μ…μ„ μ¶”κ°€ν•΄μ„ BeanAκ°€ μ¤ν”„λ§ λΉμ— λ“±λ΅λλ‹¤.
excludeFilters μ— MyExcludeComponent μ• λ…Έν…π•”μ…μ„ μ¶”κ°€ν•΄μ„ BeanBλ” μ¤ν”„λ§ λΉμ— λ“±λ΅λμ§€ μ•λ”
λ‹¤.

FilterType μµμ…

FilterTypeμ€ 5κ°€μ§€ μµμ…π•” μλ‹¤.

ANNOTATION: κΈ°λ³Έκ°’, μ• λ…Έν…π•”μ…μ„ μΈμ‹ν•΄μ„ λ™μ‘ν•λ‹¤.
ex)  org.example.SomeAnnotation

ASSIGNABLE_TYPE: μ§€μ •ν• νƒ€μ…κ³Ό μμ‹ νƒ€μ…μ„ μΈμ‹ν•΄μ„ λ™μ‘ν•λ‹¤.
ex)  org.example.SomeClass

ASPECTJ: AspectJ ν¨ν„΄ μ‚¬μ©

ex)  org.example..*Service+

REGEX: μ •κ· ν‘ν„μ‹

ex)  org\.example\.Default.*

CUSTOM:  TypeFilter π•”λΌλ” μΈν„°νπ•”μ¤λ¥Ό κµ¬ν„ν•΄μ„ μ²λ¦¬

ex)  org.example.MyTypeFilter


μλ¥Ό λ“¤μ–΄μ„ BeanAλ„ λΉΌκ³  μ‹¶μΌλ©΄ λ‹¤μκ³Ό κ°™π•” μ¶”κ°€ν•λ©΄ λλ‹¤.

```

@ComponentScan(
includeFilters = {

@Filter(type = FilterType.ANNOTATION, classes =
MyIncludeComponent.class),

},

excludeFilters = {

@Filter(type = FilterType.ANNOTATION, classes =
MyExcludeComponent.class),

@Filter(type = FilterType.ASSIGNABLE_TYPE, classes = BeanA.class)

}

)

```

μ°Έκ³ :  @Component λ©΄ μ¶©λ¶„ν•κΈ° λ•λ¬Έμ—,  includeFilters λ¥Ό μ‚¬μ©ν•  μΌμ€ κ±°μ μ—†λ‹¤.  excludeFilters λ”
μ—¬λ¬κ°€μ§€ π•”μ λ΅ κ°„νΉ μ‚¬μ©ν•  λ•κ°€ μμ§€λ§ λ§μ§€λ” μ•λ‹¤.

νΉν μµκ·Ό μ¤ν”„λ§ λ¶€νΈλ” μ»΄ν¬λ„νΈ μ¤μΊ”μ„ κΈ°λ³ΈμΌλ΅ μ κ³µν•λ”λ°, κ°μΈμ μΌλ΅λ” μµμ…μ„ λ³€κ²½ν•λ©΄μ„ μ‚¬μ©ν•κΈ° λ³΄λ‹¤
λ” μ¤ν”„λ§μ κΈ°λ³Έ μ„¤μ •μ— μµλ€ν• λ§μ¶”μ–΄ μ‚¬μ©ν•λ” κ²ƒμ„ κ¶μ¥ν•κ³ , μ„ νΈν•λ” νΈπ•”λ‹¤.

μ¤‘λ³µ λ“±λ΅κ³Ό μ¶©λ

μ»΄ν¬λ„νΈ μ¤μΊ”μ—μ„ κ°™μ€ λΉ π•”λ¦„μ„ λ“±λ΅ν•λ©΄ μ–΄λ–»κ² λ κΉ?
λ‹¤μ λ‘κ°€μ§€ μƒν™©π•” μλ‹¤.

1.   μλ™ λΉ λ“±λ΅ vs μλ™ λΉ λ“±λ΅

2.   μλ™ λΉ λ“±λ΅ vs μλ™ λΉ λ“±λ΅

μλ™ λΉ λ“±λ΅ vs μλ™ λΉ λ“±λ΅

μ»΄ν¬λ„νΈ μ¤μΊ”μ— μν•΄ μλ™μΌλ΅ μ¤ν”„λ§ λΉπ•” λ“±λ΅λλ”λ°, κ·Έ π•”λ¦„π•” κ°™μ€ κ²½μ° μ¤ν”„λ§μ€ μ¤λ¥λ¥Ό λ°μƒμ‹ν‚¨λ‹¤.

ConflictingBeanDefinitionException μμ™Έ λ°μƒ


μλ™ λΉ λ“±λ΅ vs μλ™ λΉ λ“±λ΅

λ§μ•½ μλ™ λΉ λ“±λ΅κ³Ό μλ™ λΉ λ“±λ΅μ—μ„ λΉ π•”λ¦„π•” μ¶©λλλ©΄ μ–΄λ–»κ² λ κΉ?

```

@Component

public class MemoryMemberRepository implements MemberRepository {}

```

```

@Configuration
@ComponentScan(

excludeFilters = @Filter(type = FilterType.ANNOTATION, classes =
Configuration.class)

)

public class AutoAppConfig {

@Bean(name = "memoryMemberRepository")
public MemberRepository memberRepository() {

return new MemoryMemberRepository();

}

}

```

π•” κ²½μ° μλ™ λΉ λ“±λ΅π•” μ°μ„ κ¶μ„ κ°€μ§„λ‹¤.
(μλ™ λΉπ•” μλ™ λΉμ„ μ¤λ²„λΌπ•”λ”© ν•΄λ²„λ¦°λ‹¤.)

**μλ™ λΉ λ“±λ΅μ‹ λ‚¨λ” λ΅κ·Έ**

```te

Overriding bean definition for bean 'memoryMemberRepository' with a different
definition: replacing

```

λ¬Όλ΅  κ°λ°μκ°€ μλ„μ μΌλ΅ π•”λ° κ²°κ³Όλ¥Ό κΈ°λ€ν–λ‹¤λ©΄, μλ™ λ³΄λ‹¤λ” μλ™π•” μ°μ„ κ¶μ„ κ°€μ§€λ” κ²ƒπ•” μΆ‹λ‹¤. ν•μ§€λ§ ν„μ‹¤μ€ κ°
λ°μκ°€ μλ„μ μΌλ΅ μ„¤μ •ν•΄μ„ π•”λ° κ²°κ³Όκ°€ λ§λ“¤μ–΄μ§€κΈ° λ³΄λ‹¤λ” μ—¬λ¬ μ„¤μ •λ“¤π•” κΌ¬μ—¬μ„ π•”λ° κ²°κ³Όκ°€ λ§λ“¤μ–΄μ§€λ” κ²½μ°κ°€ λ€
λ¶€λ¶„π•”λ‹¤!

**κ·Έλ¬λ©΄ μ •λ§ μ΅κΈ° μ–΄λ ¤μ΄ λ²„κ·Έκ°€ λ§λ“¤μ–΄μ§„λ‹¤. ν•­μƒ μ΅κΈ° μ–΄λ ¤μ΄ λ²„κ·Έλ” μ• λ§¤ν• λ²„κ·Έλ‹¤.**

κ·Έλμ„ μµκ·Ό μ¤ν”„λ§ λ¶€νΈμ—μ„λ” μλ™ λΉ λ“±λ΅κ³Ό μλ™ λΉ λ“±λ΅π•” μ¶©λλ‚λ©΄ μ¤λ¥κ°€ λ°μƒν•λ„λ΅ κΈ°λ³Έ κ°’μ„ λ°”κΎΈμ—λ‹¤.

**μλ™ λΉ λ“±λ΅, μλ™ λΉ λ“±λ΅ μ¤λ¥μ‹ μ¤ν”„λ§ λ¶€νΈ μ—λ¬**

Consider renaming one of the beans or enabling overriding by setting
spring.main.allow-bean-definition-overriding=true

μ¤ν”„λ§ λ¶€νΈμΈ CoreApplication μ„ μ‹¤ν–‰ν•΄λ³΄λ©΄ μ¤λ¥λ¥Ό λ³Ό μ μλ‹¤.


7. μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

/λ‹¤μ–‘ν• μμ΅΄κ΄€κ³„ μ£Όμ… λ°©λ²•

/μµμ… μ²λ¦¬

/μƒμ„±μ μ£Όμ…μ„ μ„ νƒν•΄λΌ!

/λ΅¬λ³µκ³Ό μµμ‹  νΈλλ“

/ μ΅°ν λΉπ•” 2κ° π•”μƒ - λ¬Έμ 

/@Autowired ν•„λ“ λ…, @Qualifier, @Primary

/μ• λ…Έν…π•”μ… μ§μ ‘ λ§λ“¤κΈ°

/μ΅°νν• λΉπ•” λ¨λ‘ ν•„μ”ν•  λ•, List, Map

/μλ™, μλ™μ μ¬λ°”λ¥Έ μ‹¤λ¬΄ μ΄μ κΈ°μ¤€

λ‹¤μ–‘ν• μμ΅΄κ΄€κ³„ μ£Όμ… λ°©λ²•

μμ΅΄κ΄€κ³„ μ£Όμ…μ€ ν¬κ² 4κ°€μ§€ λ°©λ²•π•” μλ‹¤.
μƒμ„±μ μ£Όμ…

μμ •μ μ£Όμ…(setter μ£Όμ…)
ν•„λ“ μ£Όμ…

μΌλ° λ©”μ„λ“ μ£Όμ…

μƒμ„±μ μ£Όμ…

π•”λ¦„ κ·Έλ€λ΅ μƒμ„±μλ¥Ό ν†µν•΄μ„ μμ΅΄ κ΄€κ³„λ¥Ό μ£Όμ… λ°›λ” λ°©λ²•π•”λ‹¤.
μ§€κΈκΉμ§€ μ°λ¦¬κ°€ μ§„ν–‰ν–λ λ°©λ²•π•” λ°”λ΅ μƒμ„±μ μ£Όμ…π•”λ‹¤.

νΉμ§•

μƒμ„±μ νΈμ¶μ‹μ μ— λ”± 1λ²λ§ νΈμ¶λλ” κ²ƒπ•” λ³΄μ¥λλ‹¤.

**λ¶λ³€, ν•„μ**                   μμ΅΄κ΄€κ³„μ— μ‚¬μ©

```

@Component

public class OrderServiceImpl implements OrderService {

private final MemberRepository memberRepository;
private final DiscountPolicy discountPolicy;

@Autowired


public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy
discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

}

```

**μ¤‘μ”! μƒμ„±μκ°€ λ”± 1κ°λ§ μμΌλ©΄ @Autowiredλ¥Ό μƒλµν•΄λ„ μλ™ μ£Όμ… λλ‹¤.**                   λ¬Όλ΅  μ¤ν”„λ§ λΉμ—λ§ ν•΄λ‹Ήν•λ‹¤.

```

@Component

public class OrderServiceImpl implements OrderService {

private final MemberRepository memberRepository;
private final DiscountPolicy discountPolicy;

public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy
discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

}

```

μμ •μ μ£Όμ…(setter μ£Όμ…)

setterλΌ λ¶λ¦¬λ” ν•„λ“μ κ°’μ„ λ³€κ²½ν•λ” μμ •μ λ©”μ„λ“λ¥Ό ν†µν•΄μ„ μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…ν•λ” λ°©λ²•π•”λ‹¤.
νΉμ§•

**μ„ νƒ, λ³€κ²½**                   κ°€λ¥μ„±π•” μλ” μμ΅΄κ΄€κ³„μ— μ‚¬μ©

μλ°”λΉ ν”„λ΅νΌν‹° κ·μ•½μ μμ •μ λ©”μ„λ“ λ°©μ‹μ„ μ‚¬μ©ν•λ” λ°©λ²•π•”λ‹¤.

```

@Component

public class OrderServiceImpl implements OrderService {

private MemberRepository memberRepository;
private DiscountPolicy discountPolicy;

@Autowired

public void setMemberRepository(MemberRepository memberRepository) {
this.memberRepository = memberRepository;

}


@Autowired

public void setDiscountPolicy(DiscountPolicy discountPolicy) {
this.discountPolicy = discountPolicy;

}

}

```

μ°Έκ³ :  @Autowired μ κΈ°λ³Έ λ™μ‘μ€ μ£Όμ…ν•  λ€μƒπ•” μ—†μΌλ©΄ μ¤λ¥κ°€ λ°μƒν•λ‹¤. μ£Όμ…ν•  λ€μƒπ•” μ—†μ–΄λ„ λ™μ‘ν•κ² ν•
λ ¤λ©΄ @Autowired(required = false) λ΅ μ§€μ •ν•λ©΄ λλ‹¤.

μ°Έκ³ : μλ°”λΉ ν”„λ΅νΌν‹°, μλ°”μ—μ„λ” κ³Όκ±°λ¶€ν„° ν•„λ“μ κ°’μ„ μ§μ ‘ λ³€κ²½ν•μ§€ μ•κ³ , setXxx, getXxx λΌλ” λ©”μ„λ“λ¥Ό
ν†µν•΄μ„ κ°’μ„ μ½κ±°λ‚ μμ •ν•λ” κ·μΉ™μ„ λ§λ“¤μ—λ”λ°, κ·Έκ²ƒπ•” μλ°”λΉ ν”„λ΅νΌν‹° κ·μ•½π•”λ‹¤. λ” μμ„Έν• λ‚΄μ©π•” κ¶κΈν•λ©΄
μλ°”λΉ ν”„λ΅νΌν‹°λ΅ κ²€μƒ‰ν•΄λ³΄μ.

**μλ°”λΉ ν”„λ΅νΌν‹° κ·μ•½ μμ‹**

```

class Data {
private int age;

public void setAge(int age) {
this.age = age;

}

public int getAge() {
return age;

}

}

```

ν•„λ“ μ£Όμ…

π•”λ¦„ κ·Έλ€λ΅ ν•„λ“μ— λ°”λ΅ μ£Όμ…ν•λ” λ°©λ²•π•”λ‹¤.
νΉμ§•

μ½”λ“κ°€ κ°„κ²°ν•΄μ„ λ§μ€ κ°λ°μλ“¤μ„ μ νΉν•μ§€λ§ μ™Έλ¶€μ—μ„ λ³€κ²½π•” λ¶κ°€λ¥ν•΄μ„ ν…μ¤νΈ ν•κΈ° νλ“¤λ‹¤λ” μΉλ…μ μΈ
λ‹¨μ π•” μλ‹¤.

DI ν”„λ μ„μ›ν¬κ°€ μ—†μΌλ©΄ μ•„λ¬΄κ²ƒλ„ ν•  μ μ—†λ‹¤.
μ‚¬μ©ν•μ§€ λ§μ!

μ• ν”λ¦¬μΌ€π•”μ…μ μ‹¤μ  μ½”λ“μ™€ κ΄€κ³„ μ—†λ” ν…μ¤νΈ μ½”λ“

μ¤ν”„λ§ μ„¤μ •μ„ λ©μ μΌλ΅ ν•λ” @Configuration κ°™μ€ κ³³μ—μ„λ§ νΉλ³„ν• μ©λ„λ΅ μ‚¬μ©


```

@Component

public class OrderServiceImpl implements OrderService {

@Autowired

private MemberRepository memberRepository;
@Autowired

private DiscountPolicy discountPolicy;

}

```

**μ°Έκ³ :**                   μμν• μλ°” ν…μ¤νΈ μ½”λ“μ—λ” λ‹Ήμ—°ν @Autowiredκ°€ λ™μ‘ν•μ§€ μ•λ”λ‹¤.  @SpringBootTest μ²λΌ μ¤ν”„λ§
μ»¨ν…π•”λ„λ¥Ό ν…μ¤νΈμ— ν†µν•©ν• κ²½μ°μ—λ§ κ°€λ¥ν•λ‹¤.

**μ°Έκ³ :**                   λ‹¤μ μ½”λ“μ™€ κ°™π•” @Bean μ—μ„ νλΌλ―Έν„°μ— μμ΅΄κ΄€κ³„λ” μλ™ μ£Όμ…λλ‹¤. μλ™ λ“±λ΅μ‹ μλ™ λ“±λ΅λ λΉμ μμ΅΄
κ΄€κ³„κ°€ ν•„μ”ν•  λ• λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μλ‹¤.

```

@Bean

OrderService orderService(MemberRepository memberRepoisitory, DiscountPolicy
discountPolicy) {

return new OrderServiceImpl(memberRepository, discountPolicy);

}

```

μΌλ° λ©”μ„λ“ μ£Όμ…

μΌλ° λ©”μ„λ“λ¥Ό ν†µν•΄μ„ μ£Όμ… λ°›μ„ μ μλ‹¤.
νΉμ§•

ν•λ²μ— μ—¬λ¬ ν•„λ“λ¥Ό μ£Όμ… λ°›μ„ μ μλ‹¤.
μΌλ°μ μΌλ΅ μ μ‚¬μ©ν•μ§€ μ•λ”λ‹¤.

```

@Component

public class OrderServiceImpl implements OrderService {

private MemberRepository memberRepository;
private DiscountPolicy discountPolicy;

@Autowired

public void init(MemberRepository memberRepository, DiscountPolicy


discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

}

```

μ°Έκ³ : μ–΄μ©λ©΄ λ‹Ήμ—°ν• π•”μ•ΌκΈ°π•”μ§€λ§ μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…μ€ μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ κ΄€λ¦¬ν•λ” μ¤ν”„λ§ λΉπ•”μ–΄μ•Ό λ™μ‘ν•λ‹¤.
μ¤ν”„λ§ λΉπ•” μ•„λ‹ Member κ°™μ€ ν΄λμ¤μ—μ„ @Autowired μ½”λ“λ¥Ό μ μ©ν•΄λ„ μ•„λ¬΄ κΈ°λ¥λ„ λ™μ‘ν•μ§€ μ•λ”λ‹¤.

μµμ… μ²λ¦¬

μ£Όμ…ν•  μ¤ν”„λ§ λΉπ•” μ—†μ–΄λ„ λ™μ‘ν•΄μ•Ό ν•  λ•κ°€ μλ‹¤.

κ·Έλ°λ° @Autowired λ§ μ‚¬μ©ν•λ©΄ required μµμ…μ κΈ°λ³Έκ°’π•” true λ΅ λμ–΄ μμ–΄μ„ μλ™ μ£Όμ… λ€μƒπ•” μ—†μΌλ©΄ μ¤λ¥
κ°€ λ°μƒν•λ‹¤.

μλ™ μ£Όμ… λ€μƒμ„ μµμ…μΌλ΅ μ²λ¦¬ν•λ” λ°©λ²•μ€ λ‹¤μκ³Ό κ°™λ‹¤.

@Autowired(required=false) : μλ™ μ£Όμ…ν•  λ€μƒπ•” μ—†μΌλ©΄ μμ •μ λ©”μ„λ“ μμ²΄κ°€ νΈμ¶ μ•λ¨

org.springframework.lang.@Nullable : μλ™ μ£Όμ…ν•  λ€μƒπ•” μ—†μΌλ©΄ nullπ•” μ…λ ¥λλ‹¤.

Optional<> : μλ™ μ£Όμ…ν•  λ€μƒπ•” μ—†μΌλ©΄ Optional.empty κ°€ μ…λ ¥λλ‹¤.

μμ λ΅ ν™•μΈν•΄λ³΄μ.

```

//νΈμ¶  μ•λ¨

@Autowired(required = false)

public void setNoBean1(Member member) {
System.out.println("setNoBean1 = " + member);

}

//null νΈμ¶

@Autowired

public void setNoBean2(@Nullable Member member) {
System.out.println("setNoBean2 = " + member);

}

//Optional.empty νΈμ¶

@Autowired(required = false)

public void setNoBean3(Optional<Member> member) {


System.out.println("setNoBean3 = " + member);

}

```

**Memberλ” μ¤ν”„λ§ λΉμ΄ μ•„λ‹λ‹¤.**

setNoBean1() μ€ @Autowired(required=false) π•”λ―€λ΅ νΈμ¶ μμ²΄κ°€ μ•λλ‹¤.

**μ¶λ ¥κ²°κ³Ό**

```

setNoBean2 = null
setNoBean3 = Optional.empty

```

μ°Έκ³ : @Nullable, Optionalμ€ μ¤ν”„λ§ μ „λ°μ— κ±Έμ³μ„ μ§€μ›λλ‹¤. μλ¥Ό λ“¤μ–΄μ„ μƒμ„±μ μλ™ μ£Όμ…μ—μ„ νΉμ • ν•„λ“μ—
λ§ μ‚¬μ©ν•΄λ„ λλ‹¤.

μƒμ„±μ μ£Όμ…μ„ μ„ νƒν•΄λΌ!

κ³Όκ±°μ—λ” μμ •μ μ£Όμ…κ³Ό ν•„λ“ μ£Όμ…μ„ λ§π•” μ‚¬μ©ν–μ§€λ§, μµκ·Όμ—λ” μ¤ν”„λ§μ„ ν¬ν•¨ν• DI ν”„λ μ„μ›ν¬ λ€λ¶€λ¶„π•” μƒμ„±μ μ£Όμ…
μ„ κ¶μ¥ν•λ‹¤. κ·Έ π•”μ λ” λ‹¤μκ³Ό κ°™λ‹¤.


**λ¶λ³€**

λ€λ¶€λ¶„μ μμ΅΄κ΄€κ³„ μ£Όμ…μ€ ν•λ² μΌμ–΄λ‚λ©΄ μ• ν”λ¦¬μΌ€π•”μ… μΆ…λ£μ‹μ κΉμ§€ μμ΅΄κ΄€κ³„λ¥Ό λ³€κ²½ν•  μΌπ•” μ—†λ‹¤. μ¤νλ ¤ λ€λ¶€
λ¶„μ μμ΅΄κ΄€κ³„λ” μ• ν”λ¦¬μΌ€π•”μ… μΆ…λ£ μ „κΉμ§€ λ³€ν•λ©΄ μ•λλ‹¤.(λ¶λ³€ν•΄μ•Ό ν•λ‹¤.)

μμ •μ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄, setXxx λ©”μ„λ“λ¥Ό publicμΌλ΅ μ—΄μ–΄λ‘μ–΄μ•Ό ν•λ‹¤.

λ„κµ°κ°€ μ‹¤μλ΅ λ³€κ²½ν•  μ λ„ μκ³ , λ³€κ²½ν•λ©΄ μ•λλ” λ©”μ„λ“λ¥Ό μ—΄μ–΄λ‘λ” κ²ƒμ€ μΆ‹μ€ μ„¤κ³„ λ°©λ²•π•” μ•„λ‹λ‹¤.

μƒμ„±μ μ£Όμ…μ€ κ°μ²΄λ¥Ό μƒμ„±ν•  λ• λ”± 1λ²λ§ νΈμ¶λλ―€λ΅ π•”ν›„μ— νΈμ¶λλ” μΌπ•” μ—†λ‹¤. λ”°λΌμ„ λ¶λ³€ν•κ² μ„¤κ³„ν•  μ μ
λ‹¤.

**λ„λ½**

ν”„λ μ„μ›ν¬ μ—†π•” μμν• μλ°” μ½”λ“λ¥Ό λ‹¨μ„ ν…μ¤νΈ ν•λ” κ²½μ°μ—
λ‹¤μκ³Ό κ°™π•” μμ •μ μμ΅΄κ΄€κ³„μΈ κ²½μ°

```

public class OrderServiceImpl implements OrderService {
private MemberRepository memberRepository;


private DiscountPolicy discountPolicy;

@Autowired

public void setMemberRepository(MemberRepository memberRepository) {
this.memberRepository = memberRepository;

}

@Autowired

public void setDiscountPolicy(DiscountPolicy discountPolicy) {
this.discountPolicy = discountPolicy;


}

```

}

//...

@Autowired κ°€ ν”„λ μ„μ›ν¬ μ•μ—μ„ λ™μ‘ν•  λ•λ” μμ΅΄κ΄€κ³„κ°€ μ—†μΌλ©΄ μ¤λ¥κ°€ λ°μƒν•μ§€λ§, μ§€κΈμ€ ν”„λ μ„μ›ν¬ μ—†

π•” μμν• μλ°” μ½”λ“λ΅λ§ λ‹¨μ„ ν…μ¤νΈλ¥Ό μν–‰ν•κ³  μλ‹¤.

π•”λ ‡κ² ν…μ¤νΈλ¥Ό μν–‰ν•λ©΄ μ‹¤ν–‰μ€ λλ‹¤.

```

@Test

void createOrder() {

OrderServiceImpl orderService = new OrderServiceImpl();
orderService.createOrder(1L, "itemA", 10000);

}

```

κ·Έλ°λ° λ§‰μƒ μ‹¤ν–‰ κ²°κ³Όλ” NPE(Null Point Exception)π•” λ°μƒν•λ”λ°, memberRepository, discountPolicy λ¨λ‘
μμ΅΄κ΄€κ³„ μ£Όμ…π•” λ„λ½λμ—κΈ° λ•λ¬Έπ•”λ‹¤.

μƒμ„±μ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄ λ‹¤μμ²λΌ μ£Όμ… λ°π•”ν„°λ¥Ό λ„λ½ ν–μ„ λ• **μ»΄νμΌ μ¤λ¥**κ°€ λ°μƒν•λ‹¤.
κ·Έλ¦¬κ³  IDEμ—μ„ λ°”λ΅ μ–΄λ–¤ κ°’μ„ ν•„μλ΅ μ£Όμ…ν•΄μ•Ό ν•λ”μ§€ μ• μ μλ‹¤.

```

@Test

void createOrder() {

OrderServiceImpl orderService = new OrderServiceImpl();
orderService.createOrder(1L, "itemA", 10000);

}

```

**final ν‚¤μ›λ“**

μƒμ„±μ μ£Όμ…μ„ μ‚¬μ©ν•λ©΄ ν•„λ“μ— final ν‚¤μ›λ“λ¥Ό μ‚¬μ©ν•  μ μλ‹¤. κ·Έλμ„ μƒμ„±μμ—μ„ νΉμ‹λΌλ„ κ°’π•” μ„¤μ •λμ§€ μ•λ” μ¤
λ¥λ¥Ό μ»΄νμΌ μ‹μ μ— λ§‰μ•„μ¤€λ‹¤. λ‹¤μ μ½”λ“λ¥Ό λ³΄μ.

```

@Component

public class OrderServiceImpl implements OrderService {
private final MemberRepository memberRepository;


private final DiscountPolicy discountPolicy;

@Autowired

public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy
discountPolicy) {

this.memberRepository = memberRepository;


}

```

}

//...

μ λ³΄λ©΄ ν•„μ ν•„λ“μΈ discountPolicy μ— κ°’μ„ μ„¤μ •ν•΄μ•Ό ν•λ”λ°, π•” λ¶€λ¶„π•” λ„λ½λμ—λ‹¤. μλ°”λ” μ»΄νμΌ μ‹μ μ—
λ‹¤μ μ¤λ¥λ¥Ό λ°μƒμ‹ν‚¨λ‹¤.

java: variable discountPolicy might not have been initialized

κΈ°μ–µν•μ! **μ»΄νμΌ μ¤λ¥λ” μ„Έμƒμ—μ„ κ°€μ¥ λΉ λ¥΄κ³ , μΆ‹μ€ μ¤λ¥λ‹¤!**

**μ°Έκ³ :**                   μμ •μ μ£Όμ…μ„ ν¬ν•¨ν• λ‚λ¨Έμ§€ μ£Όμ… λ°©μ‹μ€ λ¨λ‘ μƒμ„±μ π•”ν›„μ— νΈμ¶λλ―€λ΅, ν•„λ“μ— final ν‚¤μ›λ“λ¥Ό μ‚¬μ©
ν•  μ μ—†λ‹¤. μ¤μ§ μƒμ„±μ μ£Όμ… λ°©μ‹λ§ final ν‚¤μ›λ“λ¥Ό μ‚¬μ©ν•  μ μλ‹¤.


**μ •λ¦¬**

μƒμ„±μ μ£Όμ… λ°©μ‹μ„ μ„ νƒν•λ” π•”μ λ” μ—¬λ¬κ°€μ§€κ°€ μμ§€λ§, ν”„λ μ„μ›ν¬μ— μμ΅΄ν•μ§€ μ•κ³ , μμν• μλ°” μ–Έμ–΄μ νΉμ§•
μ„ μ μ‚΄λ¦¬λ” λ°©λ²•π•”κΈ°λ„ ν•λ‹¤.

κΈ°λ³ΈμΌλ΅ μƒμ„±μ μ£Όμ…μ„ μ‚¬μ©ν•κ³ , ν•„μ κ°’π•” μ•„λ‹ κ²½μ°μ—λ” μμ •μ μ£Όμ… λ°©μ‹μ„ μµμ…μΌλ΅ λ¶€μ—¬ν•λ©΄ λλ‹¤. μƒμ„±μ
μ£Όμ…κ³Ό μμ •μ μ£Όμ…μ„ λ™μ‹μ— μ‚¬μ©ν•  μ μλ‹¤.

ν•­μƒ μƒμ„±μ μ£Όμ…μ„ μ„ νƒν•΄λΌ! κ·Έλ¦¬κ³  κ°€λ” μµμ…π•” ν•„μ”ν•λ©΄ μμ •μ μ£Όμ…μ„ μ„ νƒν•΄λΌ. ν•„λ“ μ£Όμ…μ€ μ‚¬μ©ν•μ§€ μ•λ”
κ² μΆ‹λ‹¤.

λ΅¬λ³µκ³Ό μµμ‹  νΈλλ“

λ§‰μƒ κ°λ°μ„ ν•΄λ³΄λ©΄, λ€λ¶€λ¶„π•” λ‹¤ λ¶λ³€π•”κ³ , κ·Έλμ„ λ‹¤μκ³Ό κ°™π•” ν•„λ“μ— final ν‚¤μ›λ“λ¥Ό μ‚¬μ©ν•κ² λλ‹¤.
κ·Έλ°λ° μƒμ„±μλ„ λ§λ“¤μ–΄μ•Ό ν•κ³ , μ£Όμ… λ°›μ€ κ°’μ„ λ€μ…ν•λ” μ½”λ“λ„ λ§λ“¤μ–΄μ•Ό ν•κ³ β€¦

ν•„λ“ μ£Όμ…μ²λΌ μΆ€ νΈλ¦¬ν•κ² μ‚¬μ©ν•λ” λ°©λ²•μ€ μ—†μ„κΉ?
μ—­μ‹ κ°λ°μλ” κ·€μ°®μ€ κ²ƒμ€ λ» μ°Έλ”λ‹¤!

λ‹¤μ κΈ°λ³Έ μ½”λ“λ¥Ό μµμ ν™”ν•΄λ³΄μ.

**κΈ°λ³Έ μ½”λ“**

```

@Component


public class OrderServiceImpl implements OrderService {

private final MemberRepository memberRepository;
private final DiscountPolicy discountPolicy;

@Autowired

public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy
discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

}

```

μƒμ„±μκ°€ λ”± 1κ°λ§ μμΌλ©΄ @Autowired λ¥Ό μƒλµν•  μ μλ‹¤.

```

@Component

public class OrderServiceImpl implements OrderService {

private final MemberRepository memberRepository;
private final DiscountPolicy discountPolicy;

public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy
discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

}

```

π•”μ  λ΅¬λ³µμ„ μ μ©ν•΄λ³΄μ. λ΅¬λ³µ λΌπ•”λΈλ¬λ¦¬ μ μ© λ°©λ²•μ€ μ•„λμ— μ μ–΄λ‘μ—λ‹¤.

λ΅¬λ³µ λΌπ•”λΈλ¬λ¦¬κ°€ μ κ³µν•λ” @RequiredArgsConstructor κΈ°λ¥μ„ μ‚¬μ©ν•λ©΄ finalπ•” λ¶™μ€ ν•„λ“λ¥Ό λ¨μ•„μ„ μƒ
μ„±μλ¥Ό μλ™μΌλ΅ λ§λ“¤μ–΄μ¤€λ‹¤. (λ‹¤μ μ½”λ“μ—λ” λ³΄π•”μ§€ μ•μ§€λ§ μ‹¤μ  νΈμ¶ κ°€λ¥ν•λ‹¤.)

μµμΆ… κ²°κ³Όλ” λ‹¤μκ³Ό κ°™λ‹¤! μ •λ§ κ°„κ²°ν•μ§€ μ•μ€κ°€!

**μµμΆ… κ²°κ³Ό μ½”λ“**

```

@Component
@RequiredArgsConstructor

public class OrderServiceImpl implements OrderService {

private final MemberRepository memberRepository;
private final DiscountPolicy discountPolicy;


}

```

π•” μµμΆ…κ²°κ³Ό μ½”λ“μ™€ π•”μ „μ μ½”λ“λ” μ™„μ „ν λ™μΌν•λ‹¤. λ΅¬λ³µπ•” μλ°”μ μ• λ…Έν…π•”μ… ν”„λ΅μ„Έμ„λΌλ” κΈ°λ¥μ„ π•”μ©ν•΄μ„ μ»΄νμΌ
μ‹μ μ— μƒμ„±μ μ½”λ“λ¥Ό μλ™μΌλ΅ μƒμ„±ν•΄μ¤€λ‹¤. μ‹¤μ  class λ¥Ό μ—΄μ–΄λ³΄λ©΄ λ‹¤μ μ½”λ“κ°€ μ¶”κ°€λμ–΄ μλ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

```

public OrderServiceImpl(MemberRepository memberRepository, DiscountPolicy
discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

```

**μ •λ¦¬**

μµκ·Όμ—λ” μƒμ„±μλ¥Ό λ”± 1κ° λ‘κ³ ,  @Autowired λ¥Ό μƒλµν•λ” λ°©λ²•μ„ μ£Όλ΅ μ‚¬μ©ν•λ‹¤. μ—¬κΈ°μ— Lombok λΌπ•”λΈλ¬λ¦¬μ

@RequiredArgsConstructor ν•¨κ» μ‚¬μ©ν•λ©΄ κΈ°λ¥μ€ λ‹¤ μ κ³µν•λ©΄μ„, μ½”λ“λ” κΉ”λ”ν•κ² μ‚¬μ©ν•  μ μλ‹¤.

λ΅¬λ³µ λΌμ΄λΈλ¬λ¦¬ μ μ© λ°©λ²•

build.gradle μ— λΌπ•”λΈλ¬λ¦¬ λ° ν™κ²½ μ¶”κ°€

```grvy

plugins {

id 'org.springframework.boot' version '2.3.2.RELEASE'

id 'io.spring.dependency-management' version '1.0.9.RELEASE'
id 'java'

}

group = 'hello'

version = '0.0.1-SNAPSHOT'

sourceCompatibility = '11'

//lombok μ„¤μ •  μ¶”κ°€  μ‹μ‘

configurations {
compileOnly {

extendsFrom annotationProcessor

}

}

//lombok μ„¤μ •  μ¶”κ°€  λ


repositories {
mavenCentral()

}

dependencies {

implementation 'org.springframework.boot:spring-boot-starter'

//lombok λΌπ•”λΈλ¬λ¦¬  μ¶”κ°€  μ‹μ‘

compileOnly 'org.projectlombok:lombok'
annotationProcessor 'org.projectlombok:lombok'

testCompileOnly 'org.projectlombok:lombok'
testAnnotationProcessor 'org.projectlombok:lombok'

//lombok λΌπ•”λΈλ¬λ¦¬  μ¶”κ°€  λ

testImplementation('org.springframework.boot:spring-boot-starter-test') {
exclude group: 'org.junit.vintage', module: 'junit-vintage-engine'

}

}

test {

useJUnitPlatform()

}

```

1.   Preferences(μλ„μ° File     Settings)     plugin     lombok κ²€μƒ‰ μ„¤μΉ μ‹¤ν–‰ (μ¬μ‹μ‘)

2.   Preferences     Annotation Processors κ²€μƒ‰    Enable annotation processing μ²΄ν¬ (μ¬μ‹μ‘)

3.   μ„μμ ν…μ¤νΈ ν΄λμ¤λ¥Ό λ§λ“¤κ³  @Getter, @Setter ν™•μΈ

μ΅°ν λΉμ΄ 2κ° μ΄μƒ - λ¬Έμ 

@Autowired λ” νƒ€μ…(Type)μΌλ΅ μ΅°νν•λ‹¤.

```

@Autowired

private DiscountPolicy discountPolicy

```

νƒ€μ…μΌλ΅ μ΅°νν•κΈ° λ•λ¬Έμ—, λ§μΉ λ‹¤μ μ½”λ“μ™€ μ μ‚¬ν•κ² λ™μ‘ν•λ‹¤. (μ‹¤μ λ΅λ” λ” λ§μ€ κΈ°λ¥μ„ μ κ³µν•λ‹¤.)

ac.getBean(DiscountPolicy.class)


μ¤ν”„λ§ λΉ μ΅°νμ—μ„ ν•™μµν–λ“―π•” νƒ€μ…μΌλ΅ μ΅°νν•λ©΄ μ„ νƒλ λΉπ•” 2κ° π•”μƒμΌ λ• λ¬Έμ κ°€ λ°μƒν•λ‹¤.

DiscountPolicy μ ν•μ„ νƒ€μ…μΈ FixDiscountPolicy ,  RateDiscountPolicy λ‘λ‹¤ μ¤ν”„λ§ λΉμΌλ΅ μ„ μ–Έν•΄
λ³΄μ.

```

@Component

public class FixDiscountPolicy implements DiscountPolicy {}

```

```

@Component

public class RateDiscountPolicy implements DiscountPolicy {}

```

κ·Έλ¦¬κ³  π•”λ ‡κ² μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…μ„ μ‹¤ν–‰ν•λ©΄

```

@Autowired

private DiscountPolicy discountPolicy

```

NoUniqueBeanDefinitionException μ¤λ¥κ°€ λ°μƒν•λ‹¤.

```

NoUniqueBeanDefinitionException: No qualifying bean of type
'hello.core.discount.DiscountPolicy' available: expected single matching bean
but                            found 2: fixDiscountPolicy,rateDiscountPolicy

```

μ¤λ¥λ©”μ‹μ§€κ°€ μΉμ ν•κ²λ„ ν•λ‚μ λΉμ„ κΈ°λ€ν–λ”λ°  fixDiscountPolicy , rateDiscountPolicy 2κ°κ°€ λ°κ²¬λ
μ—λ‹¤κ³  μ•λ ¤μ¤€λ‹¤.

π•”λ• ν•μ„ νƒ€μ…μΌλ΅ μ§€μ •ν•  μ λ„ μμ§€λ§, ν•μ„ νƒ€μ…μΌλ΅ μ§€μ •ν•λ” κ²ƒμ€ DIPλ¥Ό μ„λ°°ν•κ³  μ μ—°μ„±π•” λ–¨μ–΄μ§„λ‹¤. κ·Έλ¦¬κ³  π•”
λ¦„λ§ λ‹¤λ¥΄κ³ , μ™„μ „ν λ‘κ°™μ€ νƒ€μ…μ μ¤ν”„λ§ λΉπ•” 2κ° μμ„ λ• ν•΄κ²°π•” μ•λλ‹¤.

μ¤ν”„λ§ λΉμ„ μλ™ λ“±λ΅ν•΄μ„ λ¬Έμ λ¥Ό ν•΄κ²°ν•΄λ„ λμ§€λ§, μμ΅΄ κ΄€κ³„ μλ™ μ£Όμ…μ—μ„ ν•΄κ²°ν•λ” μ—¬λ¬ λ°©λ²•π•” μλ‹¤.

@AutoWired ν•„λ“ λ…, @Qualifier, @Primary

ν•΄κ²° λ°©λ²•μ„ ν•λ‚μ”© μ•μ•„λ³΄μ.

μ΅°ν λ€μƒ λΉπ•” 2κ° π•”μƒμΌ λ• ν•΄κ²° λ°©λ²•

@Autowired ν•„λ“ λ… λ§¤μΉ­

@Qualifier     @QualifierλΌλ¦¬ λ§¤μΉ­    λΉ π•”λ¦„ λ§¤μΉ­

@Primary μ‚¬μ©


@AutoWired ν•„λ“ λ… λ§¤μΉ­

@Autowired λ” νƒ€μ… λ§¤μΉ­μ„ μ‹λ„ν•κ³ , π•”λ• μ—¬λ¬ λΉπ•” μμΌλ©΄ ν•„λ“ π•”λ¦„, νλΌλ―Έν„° π•”λ¦„μΌλ΅ λΉ π•”λ¦„μ„ μ¶”κ°€ λ§¤μΉ­ν•
λ‹¤.

**κΈ°μ΅΄ μ½”λ“**

```

@Autowired

private DiscountPolicy discountPolicy

```

**ν•„λ“ λ…μ„ λΉ μ΄λ¦„μΌλ΅ λ³€κ²½**

```

@Autowired

private DiscountPolicy rateDiscountPolicy

```

ν•„λ“ λ…π•” rateDiscountPolicy π•”λ―€λ΅ μ •μƒ μ£Όμ…λλ‹¤.

**ν•„λ“ λ… λ§¤μΉ­μ€ λ¨Όμ € νƒ€μ… λ§¤μΉ­μ„ μ‹λ„ ν•κ³  κ·Έ κ²°κ³Όμ— μ—¬λ¬ λΉμ΄ μμ„ λ• μ¶”κ°€λ΅ λ™μ‘ν•λ” κΈ°λ¥μ΄λ‹¤.**

**@Autowired λ§¤μΉ­ μ •λ¦¬**

1.   νƒ€μ… λ§¤μΉ­

2.   νƒ€μ… λ§¤μΉ­μ κ²°κ³Όκ°€ 2κ° π•”μƒμΌ λ• ν•„λ“ λ…, νλΌλ―Έν„° λ…μΌλ΅ λΉ π•”λ¦„ λ§¤μΉ­

@Qualifier μ‚¬μ©

@Qualifier λ” μ¶”κ°€ κµ¬λ¶„μλ¥Ό λ¶™μ—¬μ£Όλ” λ°©λ²•π•”λ‹¤. μ£Όμ…μ‹ μ¶”κ°€μ μΈ λ°©λ²•μ„ μ κ³µν•λ” κ²ƒπ•”μ§€ λΉ π•”λ¦„μ„ λ³€κ²½ν•λ” κ²ƒ
μ€ μ•„λ‹λ‹¤.

**λΉ λ“±λ΅μ‹ @Qualifierλ¥Ό λ¶™μ—¬ μ¤€λ‹¤.**

```

@Component
@Qualifier("mainDiscountPolicy")

public class RateDiscountPolicy implements DiscountPolicy {}

```

```

@Component
@Qualifier("fixDiscountPolicy")

public class FixDiscountPolicy implements DiscountPolicy {}

```

**μ£Όμ…μ‹μ— @Qualifierλ¥Ό λ¶™μ—¬μ£Όκ³  λ“±λ΅ν• μ΄λ¦„μ„ μ μ–΄μ¤€λ‹¤.**


**μƒμ„±μ μλ™ μ£Όμ… μμ‹**

```

@Autowired

public OrderServiceImpl(MemberRepository memberRepository,

@Qualifier("mainDiscountPolicy") DiscountPolicy

discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

```

**μμ •μ μλ™ μ£Όμ… μμ‹**

```

@Autowired

public DiscountPolicy setDiscountPolicy(@Qualifier("mainDiscountPolicy")
DiscountPolicy discountPolicy) {

this.discountPolicy = discountPolicy;

}

```

@Qualifier λ΅ μ£Όμ…ν•  λ• @Qualifier("mainDiscountPolicy") λ¥Ό λ»μ°ΎμΌλ©΄ μ–΄λ–»κ² λ κΉ? κ·Έλ¬λ©΄
mainDiscountPolicyλΌλ” π•”λ¦„μ μ¤ν”„λ§ λΉμ„ μ¶”κ°€λ΅ μ°Ύλ”λ‹¤. ν•μ§€λ§ κ²½ν—μƒ @Qualifier λ” @Qualifier λ¥Ό μ°Ύ
λ” μ©λ„λ΅λ§ μ‚¬μ©ν•λ”κ² λ…ν™•ν•κ³  μΆ‹λ‹¤.

λ‹¤μκ³Ό κ°™π•” μ§μ ‘ λΉ λ“±λ΅μ‹μ—λ„ @Qualifierλ¥Ό λ™μΌν•κ² μ‚¬μ©ν•  μ μλ‹¤.

```

@Bean
@Qualifier("mainDiscountPolicy")

public DiscountPolicy discountPolicy() {
return new ...

}

```

**@Qualifier μ •λ¦¬**

1.   @QualifierλΌλ¦¬ λ§¤μΉ­

2.   λΉ π•”λ¦„ λ§¤μΉ­

3.    NoSuchBeanDefinitionException μμ™Έ λ°μƒ

@Primary μ‚¬μ©

@Primary λ” μ°μ„ μμ„λ¥Ό μ •ν•λ” λ°©λ²•π•”λ‹¤. @Autowired μ‹μ— μ—¬λ¬ λΉπ•” λ§¤μΉ­λλ©΄ @Primary κ°€ μ°μ„ κ¶μ„ κ°€μ§„λ‹¤.


rateDiscountPolicy κ°€ μ°μ„ κ¶μ„ κ°€μ§€λ„λ΅ ν•μ.

```

@Component
@Primary

public class RateDiscountPolicy implements DiscountPolicy {}

@Component

public class FixDiscountPolicy implements DiscountPolicy {}

```

**μ‚¬μ©μ½”λ“**

```

//μƒμ„±μ
@Autowired

public OrderServiceImpl(MemberRepository memberRepository,

DiscountPolicy discountPolicy) {
this.memberRepository = memberRepository;
this.discountPolicy            = discountPolicy;

}

//μμ •μ
@Autowired

public DiscountPolicy setDiscountPolicy(DiscountPolicy discountPolicy) {
this.discountPolicy = discountPolicy;

}

```

μ½”λ“λ¥Ό μ‹¤ν–‰ν•΄λ³΄λ©΄ λ¬Έμ  μ—†π•” @Primary κ°€ μ λ™μ‘ν•λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

μ—¬κΈ°κΉμ§€ λ³΄λ©΄ @Primary μ™€ @Qualifier μ¤‘μ— μ–΄λ–¤ κ²ƒμ„ μ‚¬μ©ν•λ©΄ μΆ‹μ„μ§€ κ³ λ―Όπ•” λ  κ²ƒπ•”λ‹¤.  @Qualifier μ λ‹¨
μ μ€ μ£Όμ… λ°›μ„ λ• λ‹¤μκ³Ό κ°™π•” λ¨λ“  μ½”λ“μ— @Qualifier λ¥Ό λ¶™μ—¬μ£Όμ–΄μ•Ό ν•λ‹¤λ” μ π•”λ‹¤.

```

@Autowired

public OrderServiceImpl(MemberRepository memberRepository,

@Qualifier("mainDiscountPolicy") DiscountPolicy

discountPolicy) {

this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

```

λ°λ©΄μ— @Primary λ¥Ό μ‚¬μ©ν•λ©΄ π•”λ ‡κ² @Qualifier λ¥Ό λ¶™μΌ ν•„μ”κ°€ μ—†λ‹¤.

**@Primary, @Qualifier ν™μ©**

μ½”λ“μ—μ„ μμ£Ό μ‚¬μ©ν•λ” λ©”μΈ λ°π•”ν„°λ² π•”μ¤μ μ»¤λ„¥μ…μ„ νλ“ν•λ” μ¤ν”„λ§ λΉπ•” μκ³ , μ½”λ“μ—μ„ νΉλ³„ν• κΈ°λ¥μΌλ΅ κ°€λ” μ‚¬


μ©ν•λ” μ„λΈ λ°π•”ν„°λ² π•”μ¤μ μ»¤λ„¥μ…μ„ νλ“ν•λ” μ¤ν”„λ§ λΉπ•” μλ‹¤κ³  μƒκ°ν•΄λ³΄μ. λ©”μΈ λ°π•”ν„°λ² π•”μ¤μ μ»¤λ„¥μ…μ„ νλ“ν•
λ” μ¤ν”„λ§ λΉμ€ @Primary λ¥Ό μ μ©ν•΄μ„ μ΅°νν•λ” κ³³μ—μ„ @Qualifier μ§€μ • μ—†π•” νΈλ¦¬ν•κ² μ΅°νν•κ³ , μ„λΈ λ°π•”ν„°λ² 

π•”μ¤ μ»¤λ„¥μ… λΉμ„ νλ“ν•  λ•λ” @Qualifier λ¥Ό μ§€μ •ν•΄μ„ λ…μ‹μ μΌλ΅ νλ“ ν•λ” λ°©μ‹μΌλ΅ μ‚¬μ©ν•λ©΄ μ½”λ“λ¥Ό κΉ”λ”ν•κ²
μ μ§€ν•  μ μλ‹¤. λ¬Όλ΅  π•”λ• λ©”μΈ λ°π•”ν„°λ² π•”μ¤μ μ¤ν”„λ§ λΉμ„ λ“±λ΅ν•  λ• @Qualifier λ¥Ό μ§€μ •ν•΄μ£Όλ” κ²ƒμ€ μƒκ΄€μ—†λ‹¤.

**μ°μ„ μμ„**

@Primary λ” κΈ°λ³Έκ°’ μ²λΌ λ™μ‘ν•λ” κ²ƒπ•”κ³ ,  @Qualifier λ” λ§¤μ° μƒμ„Έν•κ² λ™μ‘ν•λ‹¤. π•”λ° κ²½μ° μ–΄λ–¤ κ²ƒπ•” μ°μ„ κ¶μ„
κ°€μ Έκ°κΉ? μ¤ν”„λ§μ€ μλ™λ³΄λ‹¤λ” μλ™π•”, λ„’μ€ λ²”μ„μ μ„ νƒκ¶ λ³΄λ‹¤λ” μΆμ€ λ²”μ„μ μ„ νƒκ¶π•” μ°μ„  μμ„κ°€ λ†’λ‹¤. λ”°λΌμ„ μ—¬
κΈ°μ„λ„ @Qualifier κ°€ μ°μ„ κ¶π•” λ†’λ‹¤.

μ• λ…Έν…μ΄μ… μ§μ ‘ λ§λ“¤κΈ°

@Qualifier("mainDiscountPolicy") π•”λ ‡κ² λ¬Έμλ¥Ό μ μΌλ©΄ μ»΄νμΌμ‹ νƒ€μ… μ²΄ν¬κ°€ μ•λλ‹¤. λ‹¤μκ³Ό κ°™μ€ μ• λ…Έ
ν…π•”μ…μ„ λ§λ“¤μ–΄μ„ λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μλ‹¤.

```

package hello.core.annotataion;

import org.springframework.beans.factory.annotation.Qualifier;
import java.lang.annotation.*;

@Target({ElementType.FIELD, ElementType.METHOD, ElementType.PARAMETER,
ElementType.TYPE, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)

@Documented
@Qualifier("mainDiscountPolicy")
public                              @interface MainDiscountPolicy {

}

```

```

@Component
@MainDiscountPolicy

public class RateDiscountPolicy implements DiscountPolicy {}

```

```

//μƒμ„±μ  μλ™  μ£Όμ…

@Autowired

public OrderServiceImpl(MemberRepository memberRepository,

@MainDiscountPolicy DiscountPolicy discountPolicy) {


this.memberRepository = memberRepository;
this.discountPolicy = discountPolicy;

}

//μμ •μ  μλ™  μ£Όμ…

@Autowired

public DiscountPolicy setDiscountPolicy(@MainDiscountPolicy DiscountPolicy
discountPolicy) {

this.discountPolicy = discountPolicy;

}

```

μ• λ…Έν…π•”μ…μ—λ” μƒμ†π•”λΌλ” κ°λ…π•” μ—†λ‹¤. π•”λ ‡κ² μ—¬λ¬ μ• λ…Έν…π•”μ…μ„ λ¨μ•„μ„ μ‚¬μ©ν•λ” κΈ°λ¥μ€ μ¤ν”„λ§π•” μ§€μ›ν•΄μ£Όλ” κΈ°λ¥

π•”λ‹¤.  @Qualifier λΏλ§ μ•„λ‹λΌ λ‹¤λ¥Έ μ• λ…Έν…π•”μ…λ“¤λ„ ν•¨κ» μ΅°ν•©ν•΄μ„ μ‚¬μ©ν•  μ μλ‹¤. λ‹¨μ μΌλ΅ @Autowired λ„ μ¬
μ •μ ν•  μ μλ‹¤. λ¬Όλ΅  μ¤ν”„λ§π•” μ κ³µν•λ” κΈ°λ¥μ„ λλ ·ν• λ©μ  μ—†π•” λ¬΄λ¶„λ³„ν•κ² μ¬μ •μ ν•λ” κ²ƒμ€ μ μ§€λ³΄μμ— λ” νΌλ€λ§
κ°€μ¤‘ν•  μ μλ‹¤.

μ΅°νν• λΉμ΄ λ¨λ‘ ν•„μ”ν•  λ•, List, Map

μλ„μ μΌλ΅ μ •λ§ ν•΄λ‹Ή νƒ€μ…μ μ¤ν”„λ§ λΉπ•” λ‹¤ ν•„μ”ν• κ²½μ°λ„ μλ‹¤.

μλ¥Ό λ“¤μ–΄μ„ ν• μΈ μ„λΉ„μ¤λ¥Ό μ κ³µν•λ”λ°, ν΄λΌπ•”μ–ΈνΈκ°€ ν• μΈμ μΆ…λ¥(rate, fix)λ¥Ό μ„ νƒν•  μ μλ‹¤κ³  κ°€μ •ν•΄λ³΄μ. μ¤ν”„λ§μ„
μ‚¬μ©ν•λ©΄ μ†μ„ λ§ν•λ” μ „λµ ν¨ν„΄μ„ λ§¤μ° κ°„λ‹¨ν•κ² κµ¬ν„ν•  μ μλ‹¤.

μ½”λ“λ΅ λ°”λ΅ μ„¤λ…ν•κ² λ‹¤.

```

package hello.core.autowired;

import hello.core.AutoAppConfig;

import hello.core.discount.DiscountPolicy;
import hello.core.member.Grade;

import hello.core.member.Member;
import org.junit.jupiter.api.Test;

import org.springframework.context.ApplicationContext;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;

import java.util.List;
import java.util.Map;


import static org.assertj.core.api.Assertions.assertThat;
public class AllBeanTest {

@Test

void findAllBean() {
ApplicationContext ac = new

AnnotationConfigApplicationContext(AutoAppConfig.class, DiscountService.class);
DiscountService discountService = ac.getBean(DiscountService.class);
Member      member = new Member(1L, "userA", Grade.VIP);

int discountPrice = discountService.discount(member, 10000,
"fixDiscountPolicy");

assertThat(discountService).isInstanceOf(DiscountService.class);
assertThat(discountPrice).isEqualTo(1000);

}

static class DiscountService {

private final Map<String, DiscountPolicy> policyMap;
private final List<DiscountPolicy> policies;

public DiscountService(Map<String, DiscountPolicy> policyMap,
List<DiscountPolicy> policies) {

this.policyMap = policyMap;
this.policies = policies;

System.out.println("policyMap = " + policyMap);
System.out.println("policies = " + policies);

}

public int discount(Member member, int price, String discountCode) {
DiscountPolicy discountPolicy = policyMap.get(discountCode);

System.out.println("discountCode = " + discountCode);
System.out.println("discountPolicy = " + discountPolicy);


}

}

```

return discountPolicy.discount(member, price);

}


**λ΅μ§ λ¶„μ„**

DiscountServiceλ” MapμΌλ΅ λ¨λ“  DiscountPolicy λ¥Ό μ£Όμ…λ°›λ”λ‹¤. π•”λ• fixDiscountPolicy ,

rateDiscountPolicy κ°€ μ£Όμ…λλ‹¤.

discount () λ©”μ„λ“λ” discountCodeλ΅ "fixDiscountPolicy"κ°€ λ„μ–΄μ¤λ©΄ mapμ—μ„
fixDiscountPolicy μ¤ν”„λ§ λΉμ„ μ°Ύμ•„μ„ μ‹¤ν–‰ν•λ‹¤. λ¬Όλ΅  β€rateDiscountPolicyβ€κ°€ λ„μ–΄μ¤λ©΄
rateDiscountPolicy μ¤ν”„λ§ λΉμ„ μ°Ύμ•„μ„ μ‹¤ν–‰ν•λ‹¤.

**μ£Όμ… λ¶„μ„**

Map<String, DiscountPolicy> : mapμ ν‚¤μ— μ¤ν”„λ§ λΉμ π•”λ¦„μ„ λ„£μ–΄μ£Όκ³ , κ·Έ κ°’μΌλ΅

DiscountPolicy νƒ€μ…μΌλ΅ μ΅°νν• λ¨λ“  μ¤ν”„λ§ λΉμ„ λ‹΄μ•„μ¤€λ‹¤.

List<DiscountPolicy> :  DiscountPolicy νƒ€μ…μΌλ΅ μ΅°νν• λ¨λ“  μ¤ν”„λ§ λΉμ„ λ‹΄μ•„μ¤€λ‹¤.
λ§μ•½ ν•΄λ‹Ήν•λ” νƒ€μ…μ μ¤ν”„λ§ λΉπ•” μ—†μΌλ©΄, λΉ μ»¬λ ‰μ…π•”λ‚ Mapμ„ μ£Όμ…ν•λ‹¤.

**μ°Έκ³  - μ¤ν”„λ§ μ»¨ν…μ΄λ„λ¥Ό μƒμ„±ν•λ©΄μ„ μ¤ν”„λ§ λΉ λ“±λ΅ν•κΈ°**

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” μƒμ„±μμ— ν΄λμ¤ μ •λ³΄λ¥Ό λ°›λ”λ‹¤. μ—¬κΈ°μ— ν΄λμ¤ μ •λ³΄λ¥Ό λ„κΈ°λ©΄ ν•΄λ‹Ή ν΄λμ¤κ°€ μ¤ν”„λ§ λΉμΌλ΅ μλ™ λ“±
λ΅λλ‹¤.

new
AnnotationConfigApplicationContext(AutoAppConfig.class,DiscountService.class);

π•” μ½”λ“λ” 2κ°€μ§€λ΅ λ‚λ„μ–΄ π•”ν•΄ν•  μ μλ‹¤.

new AnnotationConfigApplicationContext() λ¥Ό ν†µν•΄ μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό μƒμ„±ν•λ‹¤.
AutoAppConfig.class ,  DiscountService.class λ¥Ό νλΌλ―Έν„°λ΅ λ„κΈ°λ©΄μ„ ν•΄λ‹Ή ν΄λμ¤λ¥Ό μλ™μΌλ΅ μ¤
ν”„λ§                      λΉμΌλ΅ λ“±λ΅ν•λ‹¤.

μ •λ¦¬ν•λ©΄ μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό μƒμ„±ν•λ©΄μ„, ν•΄λ‹Ή μ»¨ν…π•”λ„μ— λ™μ‹μ—  AutoAppConfig ,  DiscountService λ¥Ό μ¤ν”„
λ§ λΉμΌλ΅ μλ™ λ“±λ΅ν•λ‹¤.

μλ™, μλ™μ μ¬λ°”λ¥Έ μ‹¤λ¬΄ μ΄μ κΈ°μ¤€

**νΈλ¦¬ν• μλ™ κΈ°λ¥μ„ κΈ°λ³ΈμΌλ΅ μ‚¬μ©ν•μ**

κ·Έλ¬λ©΄ μ–΄λ–¤ κ²½μ°μ— μ»΄ν¬λ„νΈ μ¤μΊ”κ³Ό μλ™ μ£Όμ…μ„ μ‚¬μ©ν•κ³ , μ–΄λ–¤ κ²½μ°μ— μ„¤μ • μ •λ³΄λ¥Ό ν†µν•΄μ„ μλ™μΌλ΅ λΉμ„ λ“±λ΅ν•κ³ ,
μμ΅΄κ΄€κ³„λ„ μλ™μΌλ΅ μ£Όμ…ν•΄μ•Ό ν• κΉ?

κ²°λ΅ λ¶€ν„° π•”μ•ΌκΈ°ν•λ©΄, μ¤ν”„λ§π•” λ‚μ¤κ³  μ‹κ°„π•” κ° μλ΅ μ μ  μλ™μ„ μ„ νΈν•λ” μ¶”μ„Έλ‹¤. μ¤ν”„λ§μ€ @Component λΏλ§ μ•„
λ‹λΌ @Controller ,  @Service ,  @Repository μ²λΌ κ³„μΈµμ— λ§μ¶”μ–΄ μΌλ°μ μΈ μ• ν”λ¦¬μΌ€π•”μ… λ΅μ§μ„ μλ™μΌλ΅ μ¤
μΊ”ν•  μ μλ„λ΅ μ§€μ›ν•λ‹¤. κ±°κΈ°μ— λ”ν•΄μ„ μµκ·Ό μ¤ν”„λ§ λ¶€νΈλ” μ»΄ν¬λ„νΈ μ¤μΊ”μ„ κΈ°λ³ΈμΌλ΅ μ‚¬μ©ν•κ³ , μ¤ν”„λ§ λ¶€νΈμ λ‹¤μ–‘


ν• μ¤ν”„λ§ λΉλ“¤λ„ μ΅°κ±΄π•” λ§μΌλ©΄ μλ™μΌλ΅ λ“±λ΅ν•λ„λ΅ μ„¤κ³„ν–λ‹¤.

μ„¤μ • μ •λ³΄λ¥Ό κΈ°λ°μΌλ΅ μ• ν”λ¦¬μΌ€π•”μ…μ„ κµ¬μ„±ν•λ” λ¶€λ¶„κ³Ό μ‹¤μ  λ™μ‘ν•λ” λ¶€λ¶„μ„ λ…ν™•ν•κ² λ‚λ„λ” κ²ƒπ•” π•”μƒμ π•”μ§€λ§, κ°
λ°μ μ…μ¥μ—μ„ μ¤ν”„λ§ λΉμ„ ν•λ‚ λ“±λ΅ν•  λ• @Component λ§ λ„£μ–΄μ£Όλ©΄ λλ‚λ” μΌμ„ @Configuration μ„¤μ • μ •λ³΄μ—
κ°€μ„ @Bean μ„ μ κ³ , κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μ£Όμ…ν•  λ€μƒμ„ μΌμΌπ•” μ μ–΄μ£Όλ” κ³Όμ •μ€ μƒλ‹Ήν λ²κ±°λ΅­λ‹¤.

λ κ΄€λ¦¬ν•  λΉπ•” λ§μ•„μ„ μ„¤μ • μ •λ³΄κ°€ μ»¤μ§€λ©΄ μ„¤μ • μ •λ³΄λ¥Ό κ΄€λ¦¬ν•λ” κ²ƒ μμ²΄κ°€ λ¶€λ‹΄π•” λλ‹¤.
κ·Έλ¦¬κ³  κ²°μ •μ μΌλ΅ μλ™ λΉ λ“±λ΅μ„ μ‚¬μ©ν•΄λ„ OCP, DIPλ¥Ό μ§€ν‚¬ μ μλ‹¤.

**κ·Έλ¬λ©΄ μλ™ λΉ λ“±λ΅μ€ μ–Έμ  μ‚¬μ©ν•λ©΄ μΆ‹μ„κΉ?**

μ• ν”λ¦¬μΌ€π•”μ…μ€ ν¬κ² μ—…λ¬΄ λ΅μ§κ³Ό κΈ°μ  μ§€μ› λ΅μ§μΌλ΅ λ‚λ μ μλ‹¤.

**μ—…λ¬΄ λ΅μ§ λΉ:**                   μ›Ήμ„ μ§€μ›ν•λ” μ»¨νΈλ΅¤λ¬, ν•µμ‹¬ λΉ„μ¦λ‹μ¤ λ΅μ§π•” μλ” μ„λΉ„μ¤, λ°π•”ν„° κ³„μΈµμ λ΅μ§μ„ μ²λ¦¬ν•λ” λ¦¬ν¬
μ§€ν† λ¦¬λ“±π•” λ¨λ‘ μ—…λ¬΄ λ΅μ§π•”λ‹¤. λ³΄ν†µ λΉ„μ¦λ‹μ¤ μ”κµ¬μ‚¬ν•­μ„ κ°λ°ν•  λ• μ¶”κ°€λκ±°λ‚ λ³€κ²½λλ‹¤.

**κΈ°μ  μ§€μ› λΉ:**                   κΈ°μ μ μΈ λ¬Έμ λ‚ κ³µν†µ κ΄€μ‹¬μ‚¬(AOP)λ¥Ό μ²λ¦¬ν•  λ• μ£Όλ΅ μ‚¬μ©λλ‹¤. λ°π•”ν„°λ² π•”μ¤ μ—°κ²°π•”λ‚, κ³µν†µ λ΅κ·Έ
μ²λ¦¬ μ²λΌ μ—…λ¬΄ λ΅μ§μ„ μ§€μ›ν•κΈ° μ„ν• ν•λ¶€ κΈ°μ π•”λ‚ κ³µν†µ κΈ°μ λ“¤π•”λ‹¤.

μ—…λ¬΄ λ΅μ§μ€ μ«μλ„ λ§¤μ° λ§κ³ , ν•λ² κ°λ°ν•΄μ•Ό ν•λ©΄ μ»¨νΈλ΅¤λ¬, μ„λΉ„μ¤, λ¦¬ν¬μ§€ν† λ¦¬ μ²λΌ μ–΄λμ •λ„ μ μ‚¬ν• ν¨ν„΄π•”
μλ‹¤. π•”λ° κ²½μ° μλ™ κΈ°λ¥μ„ μ κ·Ή μ‚¬μ©ν•λ” κ²ƒπ•” μΆ‹λ‹¤. λ³΄ν†µ λ¬Έμ κ°€ λ°μƒν•΄λ„ μ–΄λ–¤ κ³³μ—μ„ λ¬Έμ κ°€ λ°μƒν–λ”μ§€ λ…
ν™•ν•κ² νμ•…ν•κΈ° μ‰½λ‹¤.

κΈ°μ  μ§€μ› λ΅μ§μ€ μ—…λ¬΄ λ΅μ§κ³Ό λΉ„κµν•΄μ„ κ·Έ μκ°€ λ§¤μ° μ κ³ , λ³΄ν†µ μ• ν”λ¦¬μΌ€π•”μ… μ „λ°μ— κ±Έμ³μ„ κ΄‘λ²”μ„ν•κ² μν–¥μ„
λ―ΈμΉλ‹¤. κ·Έλ¦¬κ³  μ—…λ¬΄ λ΅μ§μ€ λ¬Έμ κ°€ λ°μƒν–μ„ λ• μ–΄λ””κ°€ λ¬Έμ μΈμ§€ λ…ν™•ν•κ² μ λ“λ¬λ‚μ§€λ§, κΈ°μ  μ§€μ› λ΅μ§μ€ μ μ©

π•” μ λκ³  μλ”μ§€ μ•„λ‹μ§€ μ΅°μ°¨ νμ•…ν•κΈ° μ–΄λ ¤μ΄ κ²½μ°κ°€ λ§λ‹¤. κ·Έλμ„ π•”λ° κΈ°μ  μ§€μ› λ΅μ§λ“¤μ€ κ°€κΈ‰μ  μλ™ λΉ λ“±
λ΅μ„ μ‚¬μ©ν•΄μ„ λ…ν™•ν•κ² λ“λ¬λ‚΄λ” κ²ƒπ•” μΆ‹λ‹¤.

**μ• ν”λ¦¬μΌ€μ΄μ…μ— κ΄‘λ²”μ„ν•κ² μν–¥μ„ λ―ΈμΉλ” κΈ°μ  μ§€μ› κ°μ²΄λ” μλ™ λΉμΌλ΅ λ“±λ΅ν•΄μ„ λ”±! μ„¤μ • μ •λ³΄μ— λ°”λ΅ λ‚νƒ€λ‚κ² ν•λ”
κ²ƒμ΄ μ μ§€λ³΄μ ν•κΈ° μΆ‹λ‹¤.**

**λΉ„μ¦λ‹μ¤ λ΅μ§ μ¤‘μ—μ„ λ‹¤ν•μ„±μ„ μ κ·Ή ν™μ©ν•  λ•**

μμ΅΄κ΄€κ³„ μλ™ μ£Όμ… - μ΅°νν• λΉπ•” λ¨λ‘ ν•„μ”ν•  λ•, List, Mapμ„ λ‹¤μ‹ λ³΄μ.

DiscountService κ°€ μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…μΌλ΅ Map<String, DiscountPolicy> μ— μ£Όμ…μ„ λ°›λ” μƒν™©μ„ μƒκ°
ν•΄λ³΄μ. μ—¬κΈ°μ— μ–΄λ–¤ λΉλ“¤π•” μ£Όμ…λ  μ§€, κ° λΉλ“¤μ π•”λ¦„μ€ λ¬΄μ—‡μΌμ§€ μ½”λ“λ§ λ³΄κ³  ν•λ²μ— μ‰½κ² νμ•…ν•  μ μμ„κΉ? λ‚΄κ°€ κ°
λ°ν–μΌλ‹ ν¬κ² κ΄€κ³„κ°€ μ—†μ§€λ§, λ§μ•½ π•” μ½”λ“λ¥Ό λ‹¤λ¥Έ κ°λ°μκ°€ κ°λ°ν•΄μ„ λ‚μ—κ² μ¤€ κ²ƒπ•”λΌλ©΄ μ–΄λ–¨κΉ?

μλ™ λ“±λ΅μ„ μ‚¬μ©ν•κ³  μκΈ° λ•λ¬Έμ— νμ•…ν•λ ¤λ©΄ μ—¬λ¬ μ½”λ“λ¥Ό μ°Ύμ•„λ΄μ•Ό ν•λ‹¤.

π•”λ° κ²½μ° μλ™ λΉμΌλ΅ λ“±λ΅ν•κ±°λ‚ λλ” μλ™μΌλ΅ν•λ©΄ **νΉμ • ν¨ν‚¤μ§€μ— κ°™μ΄ λ¬¶μ–΄**λ‘λ”κ² μΆ‹λ‹¤! ν•µμ‹¬μ€ λ”± λ³΄κ³  π•”ν•΄κ°€ λ
μ–΄μ•Ό ν•λ‹¤!


π•” λ¶€λ¶„μ„ λ³„λ„μ μ„¤μ • μ •λ³΄λ΅ λ§λ“¤κ³  μλ™μΌλ΅ λ“±λ΅ν•λ©΄ λ‹¤μκ³Ό κ°™λ‹¤.

```

@Configuration

public class DiscountPolicyConfig {

@Bean

public DiscountPolicy rateDiscountPolicy() {
return new RateDiscountPolicy();

}

@Bean

public DiscountPolicy fixDiscountPolicy() {
return new FixDiscountPolicy();

}

}

```

π•” μ„¤μ • μ •λ³΄λ§ λ΄λ„ ν•λμ— λΉμ π•”λ¦„μ€ λ¬Όλ΅ π•”κ³ , μ–΄λ–¤ λΉλ“¤π•” μ£Όμ…λ μ§€ νμ•…ν•  μ μλ‹¤. κ·Έλλ„ λΉ μλ™ λ“±λ΅μ„ μ‚¬μ©
ν•κ³  μ‹¶μΌλ©΄ νμ•…ν•κΈ° μΆ‹κ² DiscountPolicy μ κµ¬ν„ λΉλ“¤λ§ λ”°λ΅ λ¨μ•„μ„ νΉμ • ν¨ν‚¤μ§€μ— λ¨μ•„λ‘μ.

μ°Έκ³ λ΅ **μ¤ν”„λ§κ³Ό μ¤ν”„λ§ λ¶€νΈκ°€ μλ™μΌλ΅ λ“±λ΅ν•λ” μ λ§μ€ λΉλ“¤μ€ μμ™Έ**λ‹¤. π•”λ° λ¶€λ¶„λ“¤μ€ μ¤ν”„λ§ μμ²΄λ¥Ό μ π•”ν•΄ν•κ³ 
μ¤ν”„λ§μ μλ„λ€λ΅ μ μ‚¬μ©ν•λ”κ² μ¤‘μ”ν•λ‹¤. μ¤ν”„λ§ λ¶€νΈμ κ²½μ° DataSource κ°™μ€ λ°π•”ν„°λ² π•”μ¤ μ—°κ²°μ— μ‚¬μ©ν•λ” κΈ°
μ  μ§€μ› λ΅μ§κΉμ§€ λ‚΄λ¶€μ—μ„ μλ™μΌλ΅ λ“±λ΅ν•λ”λ°, π•”λ° λ¶€λ¶„μ€ λ©”λ‰΄μ–Όμ„ μ μ°Έκ³ ν•΄μ„ μ¤ν”„λ§ λ¶€νΈκ°€ μλ„ν• λ€λ΅ νΈλ¦¬ν•
κ² μ‚¬μ©ν•λ©΄ λλ‹¤. λ°λ©΄μ— **μ¤ν”„λ§ λ¶€νΈκ°€ μ•„λ‹λΌ λ‚΄κ°€ μ§μ ‘ κΈ°μ  μ§€μ› κ°μ²΄λ¥Ό μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•λ‹¤λ©΄ μλ™μΌλ΅ λ“±λ΅ν•΄
μ„ λ…ν™•ν•κ² λ“λ¬λ‚΄λ” κ²ƒμ΄ μΆ‹λ‹¤.**

**μ •λ¦¬**

νΈλ¦¬ν• μλ™ κΈ°λ¥μ„ κΈ°λ³ΈμΌλ΅ μ‚¬μ©ν•μ
μ§μ ‘ λ“±λ΅ν•λ” κΈ°μ  μ§€μ› κ°μ²΄λ” μλ™ λ“±λ΅

λ‹¤ν•μ„±μ„ μ κ·Ή ν™μ©ν•λ” λΉ„μ¦λ‹μ¤ λ΅μ§μ€ μλ™ λ“±λ΅μ„ κ³ λ―Όν•΄λ³΄μ


8. λΉ μƒλ…μ£ΌκΈ° μ½λ°±

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

/λΉ μƒλ…μ£ΌκΈ° μ½λ°± μ‹μ‘

/μΈν„°νπ•”μ¤ InitializingBean, DisposableBean

/λΉ λ“±λ΅ μ΄κΈ°ν™”, μ†λ©Έ λ©”μ„λ“ μ§€μ •

/μ• λ…Έν…π•”μ… @PostConstruct, @PreDestroy

λΉ μƒλ…μ£ΌκΈ° μ½λ°± μ‹μ‘

λ°π•”ν„°λ² π•”μ¤ μ»¤λ„¥μ… ν’€π•”λ‚, λ„¤νΈμ›ν¬ μ†μΌ“μ²λΌ μ• ν”λ¦¬μΌ€π•”μ… μ‹μ‘ μ‹μ μ— ν•„μ”ν• μ—°κ²°μ„ λ―Έλ¦¬ ν•΄λ‘κ³ , μ• ν”λ¦¬μΌ€π•”μ…
μΆ…λ£ μ‹μ μ— μ—°κ²°μ„ λ¨λ‘ μΆ…λ£ν•λ” μ‘μ—…μ„ μ§„ν–‰ν•λ ¤λ©΄, κ°μ²΄μ μ΄κΈ°ν™”μ™€ μΆ…λ£ μ‘μ—…π•” ν•„μ”ν•λ‹¤.

π•”λ²μ‹κ°„μ—λ” μ¤ν”„λ§μ„ ν†µν•΄ π•”λ¬ν• μ΄κΈ°ν™” μ‘μ—…κ³Ό μΆ…λ£ μ‘μ—…μ„ μ–΄λ–»κ² μ§„ν–‰ν•λ”μ§€ μμ λ΅ μ•μ•„λ³΄μ.

κ°„λ‹¨ν•κ² μ™Έλ¶€ λ„¤νΈμ›ν¬μ— λ―Έλ¦¬ μ—°κ²°ν•λ” κ°μ²΄λ¥Ό ν•λ‚ μƒμ„±ν•λ‹¤κ³  κ°€μ •ν•΄λ³΄μ. μ‹¤μ λ΅ λ„¤νΈμ›ν¬μ— μ—°κ²°ν•λ” κ²ƒμ€ μ•„λ‹
κ³ , λ‹¨μν λ¬Έμλ§ μ¶λ ¥ν•λ„λ΅ ν–λ‹¤. π•” NetworkClient λ” μ• ν”λ¦¬μΌ€π•”μ… μ‹μ‘ μ‹μ μ— connect() λ¥Ό νΈμ¶ν•΄μ„ μ—°
κ²°μ„ λ§Ίμ–΄λ‘μ–΄μ•Ό ν•κ³ , μ• ν”λ¦¬μΌ€π•”μ…π•” μΆ…λ£λλ©΄ disConnect() λ¥Ό νΈμ¶ν•΄μ„ μ—°κ²°μ„ λμ–΄μ•Ό ν•λ‹¤.

**μμ  μ½”λ“, ν…μ¤νΈ ν•μ„μ— μƒμ„±**

```

package hello.core.lifecycle;
public class NetworkClient {

private String url;

public NetworkClient() {
System.out.println("μƒμ„±μ  νΈμ¶, url = " + url);
connect();

call("μ΄κΈ°ν™”  μ—°κ²°  λ©”μ‹μ§€");

}

public void setUrl(String url) {
this.url = url;

}

//μ„λΉ„μ¤  μ‹μ‘μ‹  νΈμ¶

public void connect() {
System.out.println("connect: " + url);


}

public void call(String message) {

System.out.println("call: " + url + " message = " + message);

}

//μ„λΉ„μ¤  μΆ…λ£μ‹  νΈμ¶

public void disconnect() {
System.out.println("close: " + url);

}

}

```

**μ¤ν”„λ§ ν™κ²½μ„¤μ •κ³Ό μ‹¤ν–‰**

```

package hello.core.lifecycle;

import org.junit.jupiter.api.Test;

import org.springframework.context.ApplicationContext;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;

import org.springframework.context.annotation.Configuration;
public class BeanLifeCycleTest {

@Test

public void lifeCycleTest() {
ConfigurableApplicationContext ac = new

AnnotationConfigApplicationContext(LifeCycleConfig.class);
NetworkClient client = ac.getBean(NetworkClient.class);

ac.close(); //μ¤ν”„λ§  μ»¨ν…π•”λ„λ¥Ό  μΆ…λ£, ConfigurableApplicationContext ν•„μ”

}

@Configuration

static class LifeCycleConfig {

@Bean

public NetworkClient networkClient() {

NetworkClient networkClient = new NetworkClient();
networkClient.setUrl("http://hello-spring.dev");
return                                      networkClient;

}


}

}

```

μ‹¤ν–‰ν•΄λ³΄λ©΄ λ‹¤μκ³Ό κ°™μ€ π•”μƒν• κ²°κ³Όκ°€ λ‚μ¨λ‹¤.

```

μƒμ„±μ  νΈμ¶, url = null
connect: null

call: null message = μ΄κΈ°ν™”  μ—°κ²°  λ©”μ‹μ§€

```

μƒμ„±μ λ¶€λ¶„μ„ λ³΄λ©΄ url μ •λ³΄ μ—†π•” connectκ°€ νΈμ¶λλ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

λ„λ¬΄ λ‹Ήμ—°ν• π•”μ•ΌκΈ°π•”μ§€λ§ κ°μ²΄λ¥Ό μƒμ„±ν•λ” λ‹¨κ³„μ—λ” urlπ•” μ—†κ³ , κ°μ²΄λ¥Ό μƒμ„±ν• λ‹¤μμ— μ™Έλ¶€μ—μ„ μμ •μ μ£Όμ…μ„ ν†µν•΄μ„

setUrl() π•” νΈμ¶λμ–΄μ•Ό urlπ•” μ΅΄μ¬ν•κ² λλ‹¤.

μ¤ν”„λ§ λΉμ€ κ°„λ‹¨ν•κ² λ‹¤μκ³Ό κ°™μ€ λΌπ•”ν”„μ‚¬π•”ν΄μ„ κ°€μ§„λ‹¤.

**κ°μ²΄ μƒμ„±**                                                                                        
**μμ΅΄κ΄€κ³„ μ£Όμ…**

μ¤ν”„λ§ λΉμ€ κ°μ²΄λ¥Ό μƒμ„±ν•κ³ , μμ΅΄κ΄€κ³„ μ£Όμ…π•” λ‹¤ λλ‚ λ‹¤μμ—μ•Ό ν•„μ”ν• λ°π•”ν„°λ¥Ό μ‚¬μ©ν•  μ μλ” μ¤€λΉ„κ°€ μ™„λ£λλ‹¤. λ”°
λΌμ„ μ΄κΈ°ν™” μ‘μ—…μ€ μμ΅΄κ΄€κ³„ μ£Όμ…π•” λ¨λ‘ μ™„λ£λκ³  λ‚ λ‹¤μμ— νΈμ¶ν•΄μ•Ό ν•λ‹¤. κ·Έλ°λ° κ°λ°μκ°€ μμ΅΄κ΄€κ³„ μ£Όμ…π•” λ¨λ‘
μ™„λ£λ μ‹μ μ„ μ–΄λ–»κ² μ• μ μμ„κΉ?

**μ¤ν”„λ§μ€ μμ΅΄κ΄€κ³„ μ£Όμ…μ΄ μ™„λ£λλ©΄ μ¤ν”„λ§ λΉμ—κ² μ½λ°± λ©”μ„λ“λ¥Ό ν†µν•΄μ„ μ΄κΈ°ν™” μ‹μ μ„ μ•λ ¤μ£Όλ” λ‹¤μ–‘ν• κΈ°λ¥μ„ μ κ³µ**

ν•λ‹¤. λν• **μ¤ν”„λ§μ€ μ¤ν”„λ§ μ»¨ν…μ΄λ„κ°€ μΆ…λ£λκΈ° μ§μ „μ— μ†λ©Έ μ½λ°±**μ„ μ¤€λ‹¤. λ”°λΌμ„ μ•μ „ν•κ² μΆ…λ£ μ‘μ—…μ„ μ§„ν–‰ν•  μ μ
λ‹¤.

**μ¤ν”„λ§ λΉμ μ΄λ²¤νΈ λΌμ΄ν”„μ‚¬μ΄ν΄**

**μ¤ν”„λ§ μ»¨ν…μ΄λ„ μƒμ„±**                                                                                     
   **μ¤ν”„λ§ λΉ μƒμ„±**                                                                                     
   **μμ΅΄κ΄€κ³„ μ£Όμ…**                                                                                      
  **μ΄κΈ°ν™” μ½λ°±**                                                                                        
**μ‚¬μ©**                                                                                        **μ†λ©Έμ „ 
μ½λ°±**                                                                                        **μ¤ν”„λ§ 
μΆ…λ£**

**μ΄κΈ°ν™” μ½λ°±**: λΉπ•” μƒμ„±λκ³ , λΉμ μμ΅΄κ΄€κ³„ μ£Όμ…π•” μ™„λ£λ ν›„ νΈμ¶

**μ†λ©Έμ „ μ½λ°±**: λΉπ•” μ†λ©ΈλκΈ° μ§μ „μ— νΈμ¶
μ¤ν”„λ§μ€ λ‹¤μ–‘ν• λ°©μ‹μΌλ΅ μƒλ…μ£ΌκΈ° μ½λ°±μ„ μ§€μ›ν•λ‹¤.

**μ°Έκ³ : κ°μ²΄μ μƒμ„±κ³Ό μ΄κΈ°ν™”λ¥Ό λ¶„λ¦¬ν•μ.**

μƒμ„±μλ” ν•„μ μ •λ³΄(νλΌλ―Έν„°)λ¥Ό λ°›κ³ , λ©”λ¨λ¦¬λ¥Ό ν• λ‹Ήν•΄μ„ κ°μ²΄λ¥Ό μƒμ„±ν•λ” μ±…μ„μ„ κ°€μ§„λ‹¤. λ°λ©΄μ— μ΄κΈ°ν™”λ” π•”λ ‡
κ² μƒμ„±λ κ°’λ“¤μ„ ν™μ©ν•΄μ„ μ™Έλ¶€ μ»¤λ„¥μ…μ„ μ—°κ²°ν•λ”λ“± λ¬΄κ±°μ΄ λ™μ‘μ„ μν–‰ν•λ‹¤.

λ”°λΌμ„ μƒμ„±μ μ•μ—μ„ λ¬΄κ±°μ΄ μ΄κΈ°ν™” μ‘μ—…μ„ ν•¨κ» ν•λ” κ²ƒ λ³΄λ‹¤λ” κ°μ²΄λ¥Ό μƒμ„±ν•λ” λ¶€λ¶„κ³Ό μ΄κΈ°ν™” ν•λ” λ¶€λ¶„μ„ λ…
ν™•ν•κ² λ‚λ„λ” κ²ƒπ•” μ μ§€λ³΄μ κ΄€μ μ—μ„ μΆ‹λ‹¤. λ¬Όλ΅  μ΄κΈ°ν™” μ‘μ—…π•” λ‚΄λ¶€ κ°’λ“¤λ§ μ•½κ°„ λ³€κ²½ν•λ” μ •λ„λ΅ λ‹¨μν• κ²½μ°


μ—λ” μƒμ„±μμ—μ„ ν•λ²μ— λ‹¤ μ²λ¦¬ν•λ”κ² λ” λ‚μ„ μ μλ‹¤.

**μ°Έκ³ :**                   μ‹±κΈ€ν†¤ λΉλ“¤μ€ μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ μΆ…λ£λ  λ• μ‹±κΈ€ν†¤ λΉλ“¤λ„ ν•¨κ» μΆ…λ£λκΈ° λ•λ¬Έμ— μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ μΆ…λ£
λκΈ° μ§μ „μ— μ†λ©Έμ „ μ½λ°±π•” μΌμ–΄λ‚λ‹¤. λ’¤μ—μ„ μ„¤λ…ν•κ² μ§€λ§ μ‹±κΈ€ν†¤ μ²λΌ μ»¨ν…π•”λ„μ μ‹μ‘κ³Ό μΆ…λ£κΉμ§€ μƒμ΅΄ν•λ” λΉ
λ„ μμ§€λ§, μƒλ…μ£ΌκΈ°κ°€ μ§§μ€ λΉλ“¤λ„ μλ”λ° π•” λΉλ“¤μ€ μ»¨ν…π•”λ„μ™€ λ¬΄κ΄€ν•κ² ν•΄λ‹Ή λΉπ•” μΆ…λ£λκΈ° μ§μ „μ— μ†λ©Έμ „ μ½
λ°±π•” μΌμ–΄λ‚λ‹¤. μμ„Έν• λ‚΄μ©μ€ μ¤μ½”ν”„μ—μ„ μ•μ•„λ³΄κ² λ‹¤.

**μ¤ν”„λ§μ€ ν¬κ² 3κ°€μ§€ λ°©λ²•μΌλ΅ λΉ μƒλ…μ£ΌκΈ° μ½λ°±μ„ μ§€μ›ν•λ‹¤.**

μΈν„°νπ•”μ¤(InitializingBean, DisposableBean)
μ„¤μ • μ •λ³΄μ— μ΄κΈ°ν™” λ©”μ„λ“, μΆ…λ£ λ©”μ„λ“ μ§€μ •
@PostConstruct, @PreDestroy μ• λ…Έν…π•”μ… μ§€μ›

ν•λ‚μ”© μ•μ•„λ³΄μ.

μΈν„°νμ΄μ¤ InitializingBean, DisposableBean

**μ½”λ“λ¥Ό λ°”λ΅ λ³΄μ**

```

package hello.core.lifecycle;

import org.springframework.beans.factory.DisposableBean;
import org.springframework.beans.factory.InitializingBean;

public class NetworkClient implements InitializingBean, DisposableBean {
private String url;

public NetworkClient() {
System.out.println("μƒμ„±μ  νΈμ¶, url = " + url);

}

public void setUrl(String url) {
this.url = url;

}

//μ„λΉ„μ¤  μ‹μ‘μ‹  νΈμ¶

public void connect() {
System.out.println("connect: " + url);


}

public void call(String message) {

System.out.println("call: " + url + " message = " + message);

}

//μ„λΉ„μ¤  μΆ…λ£μ‹  νΈμ¶

public void disConnect() {
System.out.println("close + " + url);

}

@Override

public void afterPropertiesSet() throws Exception {
connect();

call("μ΄κΈ°ν™”  μ—°κ²°  λ©”μ‹μ§€");

}

@Override

public void destroy() throws Exception {
disConnect();

}

}

```

InitializingBean μ€ afterPropertiesSet() λ©”μ„λ“λ΅ μ΄κΈ°ν™”λ¥Ό μ§€μ›ν•λ‹¤.

DisposableBean μ€ destroy() λ©”μ„λ“λ΅ μ†λ©Έμ„ μ§€μ›ν•λ‹¤.

**μ¶λ ¥ κ²°κ³Ό**

```

μƒμ„±μ  νΈμ¶, url = null
NetworkClient.afterPropertiesSet
connect:           http://hello-spring.dev

call: http://hello-spring.dev message = μ΄κΈ°ν™”  μ—°κ²°  λ©”μ‹μ§€

13:24:49.043 [main] DEBUG

org.springframework.context.annotation.AnnotationConfigApplicationContext -

Closing NetworkClient.destroy
close + http://hello-spring.dev

```

μ¶λ ¥ κ²°κ³Όλ¥Ό λ³΄λ©΄ μ΄κΈ°ν™” λ©”μ„λ“κ°€ μ£Όμ… μ™„λ£ ν›„μ— μ μ ν•κ² νΈμ¶ λ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

κ·Έλ¦¬κ³  μ¤ν”„λ§ μ»¨ν…π•”λ„μ μΆ…λ£κ°€ νΈμ¶λμ μ†λ©Έ λ©”μ„λ“κ°€ νΈμ¶ λ κ²ƒλ„ ν™•μΈν•  μ μλ‹¤.

**μ΄κΈ°ν™”, μ†λ©Έ μΈν„°νμ΄μ¤ λ‹¨μ **

π•” μΈν„°νπ•”μ¤λ” μ¤ν”„λ§ μ „μ© μΈν„°νπ•”μ¤λ‹¤. ν•΄λ‹Ή μ½”λ“κ°€ μ¤ν”„λ§ μ „μ© μΈν„°νπ•”μ¤μ— μμ΅΄ν•λ‹¤.


μ΄κΈ°ν™”, μ†λ©Έ λ©”μ„λ“μ π•”λ¦„μ„ λ³€κ²½ν•  μ μ—†λ‹¤.

λ‚΄κ°€ μ½”λ“λ¥Ό κ³ μΉ  μ μ—†λ” μ™Έλ¶€ λΌπ•”λΈλ¬λ¦¬μ— μ μ©ν•  μ μ—†λ‹¤.

μ°Έκ³ : μΈν„°νπ•”μ¤λ¥Ό μ‚¬μ©ν•λ” μ΄κΈ°ν™”, μΆ…λ£ λ°©λ²•μ€ μ¤ν”„λ§ μ΄μ°½κΈ°μ— λ‚μ¨ λ°©λ²•λ“¤π•”κ³ , μ§€κΈμ€ λ‹¤μμ λ” λ‚μ€ λ°©λ²•
λ“¤π•” μμ–΄μ„ κ±°μ μ‚¬μ©ν•μ§€ μ•λ”λ‹¤.

λΉ λ“±λ΅ μ΄κΈ°ν™”, μ†λ©Έ λ©”μ„λ“ μ§€μ •

μ„¤μ • μ •λ³΄μ— @Bean(initMethod = "init", destroyMethod = "close") μ²λΌ μ΄κΈ°ν™”, μ†λ©Έ λ©”μ„λ“λ¥Ό μ§€
μ •ν•  μ μλ‹¤.

**μ„¤μ • μ •λ³΄λ¥Ό μ‚¬μ©ν•λ„λ΅ λ³€κ²½**

```

package hello.core.lifecycle;
public class NetworkClient {

private String url;

public NetworkClient() {
System.out.println("μƒμ„±μ  νΈμ¶, url = " + url);

}

public void setUrl(String url) {
this.url = url;

}

//μ„λΉ„μ¤  μ‹μ‘μ‹  νΈμ¶

public void connect() {
System.out.println("connect: " + url);

}

public void call(String message) {

System.out.println("call: " + url + " message = " + message);

}

//μ„λΉ„μ¤  μΆ…λ£μ‹  νΈμ¶


public void disConnect() {
System.out.println("close + " + url);

}

public void init() {
System.out.println("NetworkClient.init");
connect();

call("μ΄κΈ°ν™”  μ—°κ²°  λ©”μ‹μ§€");

}

public void close() {
System.out.println("NetworkClient.close");
disConnect();

}

}

```

**μ„¤μ • μ •λ³΄μ— μ΄κΈ°ν™” μ†λ©Έ λ©”μ„λ“ μ§€μ •**

```

@Configuration

static class LifeCycleConfig {

@Bean(initMethod = "init", destroyMethod = "close")
public NetworkClient networkClient() {

NetworkClient networkClient = new NetworkClient();
networkClient.setUrl("http://hello-spring.dev");
return                                      networkClient;

}

}

```

**κ²°κ³Ό**

```

μƒμ„±μ  νΈμ¶, url = null
NetworkClient.init

connect: http://hello-spring.dev

call: http://hello-spring.dev message = μ΄κΈ°ν™”  μ—°κ²°  λ©”μ‹μ§€

13:33:10.029 [main] DEBUG

org.springframework.context.annotation.AnnotationConfigApplicationContext -

Closing NetworkClient.close
close + http://hello-spring.dev

```

**μ„¤μ • μ •λ³΄ μ‚¬μ© νΉμ§•**


λ©”μ„λ“ π•”λ¦„μ„ μμ λ΅­κ² μ¤„ μ μλ‹¤.

μ¤ν”„λ§ λΉπ•” μ¤ν”„λ§ μ½”λ“μ— μμ΅΄ν•μ§€ μ•λ”λ‹¤.

μ½”λ“κ°€ μ•„λ‹λΌ μ„¤μ • μ •λ³΄λ¥Ό μ‚¬μ©ν•κΈ° λ•λ¬Έμ— μ½”λ“λ¥Ό κ³ μΉ  μ μ—†λ” μ™Έλ¶€ λΌπ•”λΈλ¬λ¦¬μ—λ„ μ΄κΈ°ν™”, μΆ…λ£ λ©”μ„λ“λ¥Ό μ 
μ©ν•  μ μλ‹¤.

**μΆ…λ£ λ©”μ„λ“ μ¶”λ΅ **

@Beanμ  destroyMethod μ†μ„±μ—λ” μ•„μ£Ό νΉλ³„ν• κΈ°λ¥π•” μλ‹¤.

λΌπ•”λΈλ¬λ¦¬λ” λ€λ¶€λ¶„ close ,  shutdown π•”λΌλ” π•”λ¦„μ μΆ…λ£ λ©”μ„λ“λ¥Ό μ‚¬μ©ν•λ‹¤.
@Beanμ destroyMethod λ” κΈ°λ³Έκ°’π•” (inferred) (μ¶”λ΅ )μΌλ΅ λ“±λ΅λμ–΄ μλ‹¤.

π•” μ¶”λ΅  κΈ°λ¥μ€ close ,  shutdown λΌλ” π•”λ¦„μ λ©”μ„λ“λ¥Ό μλ™μΌλ΅ νΈμ¶ν•΄μ¤€λ‹¤. π•”λ¦„ κ·Έλ€λ΅ μΆ…λ£ λ©”μ„λ“λ¥Ό μ¶”
λ΅ ν•΄μ„ νΈμ¶ν•΄μ¤€λ‹¤.

λ”°λΌμ„ μ§μ ‘ μ¤ν”„λ§ λΉμΌλ΅ λ“±λ΅ν•λ©΄ μΆ…λ£ λ©”μ„λ“λ” λ”°λ΅ μ μ–΄μ£Όμ§€ μ•μ•„λ„ μ λ™μ‘ν•λ‹¤.
μ¶”λ΅  κΈ°λ¥μ„ μ‚¬μ©ν•κΈ° μ‹«μΌλ©΄ destroyMethod="" μ²λΌ λΉ κ³µλ°±μ„ μ§€μ •ν•λ©΄ λλ‹¤.

μ• λ…Έν…μ΄μ… @PostConstruct, @PreDestroy

μ°μ„  μ½”λ“ λ¨Όμ € λ³΄κ³  μ„¤λ…ν•κ² λ‹¤.

```

package hello.core.lifecycle;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;

public class NetworkClient {
private String url;

public NetworkClient() {
System.out.println("μƒμ„±μ  νΈμ¶, url = " + url);

}

public void setUrl(String url) {
this.url = url;

}

//μ„λΉ„μ¤  μ‹μ‘μ‹  νΈμ¶

public void connect() {


System.out.println("connect: " + url);

}

public void call(String message) {

System.out.println("call: " + url + " message = " + message);

}

//μ„λΉ„μ¤  μΆ…λ£μ‹  νΈμ¶

public void disConnect() {
System.out.println("close + " + url);

}

@PostConstruct
public void init() {

System.out.println("NetworkClient.init");
connect();

call("μ΄κΈ°ν™”  μ—°κ²°  λ©”μ‹μ§€");

}

@PreDestroy

public void close() {
System.out.println("NetworkClient.close");
disConnect();

}

}

```

```

@Configuration

static class LifeCycleConfig {

@Bean

public NetworkClient networkClient() {

NetworkClient networkClient = new NetworkClient();
networkClient.setUrl("http://hello-spring.dev");
return                                      networkClient;

}

}

```

**μ‹¤ν–‰ κ²°κ³Ό**

```

μƒμ„±μ  νΈμ¶, url = null


NetworkClient.init

connect: http://hello-spring.dev

call: http://hello-spring.dev message = μ΄κΈ°ν™”  μ—°κ²°  λ©”μ‹μ§€

19:40:50.269 [main] DEBUG

org.springframework.context.annotation.AnnotationConfigApplicationContext -

Closing NetworkClient.close
close + http://hello-spring.dev

```

@PostConstruct ,  @PreDestroy π•” λ‘ μ• λ…Έν…π•”μ…μ„ μ‚¬μ©ν•λ©΄ κ°€μ¥ νΈλ¦¬ν•κ² μ΄κΈ°ν™”μ™€ μΆ…λ£λ¥Ό μ‹¤ν–‰ν•  μ μλ‹¤.

**@PostConstruct, @PreDestroy μ• λ…Έν…μ΄μ… νΉμ§•**

μµμ‹  μ¤ν”„λ§μ—μ„ κ°€μ¥ κ¶μ¥ν•λ” λ°©λ²•π•”λ‹¤.
μ• λ…Έν…π•”μ… ν•λ‚λ§ λ¶™π•”λ©΄ λλ―€λ΅ λ§¤μ° νΈλ¦¬ν•λ‹¤.

ν¨ν‚¤μ§€λ¥Ό μ λ³΄λ©΄ javax.annotation.PostConstruct π•”λ‹¤. μ¤ν”„λ§μ— μΆ…μ†μ μΈ κΈ°μ π•” μ•„λ‹λΌ JSR-250

λΌλ” μλ°” ν‘μ¤€π•”λ‹¤. λ”°λΌμ„ μ¤ν”„λ§π•” μ•„λ‹ λ‹¤λ¥Έ μ»¨ν…π•”λ„μ—μ„λ„ λ™μ‘ν•λ‹¤.
μ»΄ν¬λ„νΈ μ¤μΊ”κ³Ό μ μ–΄μΈλ¦°λ‹¤.

μ μΌν• λ‹¨μ μ€ μ™Έλ¶€ λΌπ•”λΈλ¬λ¦¬μ—λ” μ μ©ν•μ§€ λ»ν•λ‹¤λ” κ²ƒπ•”λ‹¤. μ™Έλ¶€ λΌπ•”λΈλ¬λ¦¬λ¥Ό μ΄κΈ°ν™”, μΆ…λ£ ν•΄μ•Ό ν•λ©΄

@Beanμ κΈ°λ¥μ„ μ‚¬μ©ν•μ.


**μ •λ¦¬**

**@PostConstruct, @PreDestroy μ• λ…Έν…μ΄μ…μ„ μ‚¬μ©ν•μ**

μ½”λ“λ¥Ό κ³ μΉ  μ μ—†λ” μ™Έλ¶€ λΌπ•”λΈλ¬λ¦¬λ¥Ό μ΄κΈ°ν™”, μΆ…λ£ν•΄μ•Ό ν•λ©΄ @Bean μ initMethod ,  destroyMethod λ¥Ό
μ‚¬μ©ν•μ.


9. λΉ μ¤μ½”ν”„

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

/λΉ μ¤μ½”ν”„λ€?

/ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„

/ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„ - μ‹±κΈ€ν†¤ λΉκ³Ό ν•¨κ» μ‚¬μ©μ‹ λ¬Έμ μ 

/ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„ - μ‹±κΈ€ν†¤ λΉκ³Ό ν•¨κ» μ‚¬μ©μ‹ Providerλ΅ λ¬Έμ  ν•΄κ²°

/μ›Ή μ¤μ½”ν”„

/request μ¤μ½”ν”„ μμ  λ§λ“¤κΈ°

/μ¤μ½”ν”„μ™€ Provider

/μ¤μ½”ν”„μ™€ ν”„λ΅μ‹

λΉ μ¤μ½”ν”„λ€?

μ§€κΈκΉμ§€ μ°λ¦¬λ” μ¤ν”„λ§ λΉπ•” μ¤ν”„λ§ μ»¨ν…π•”λ„μ μ‹μ‘κ³Ό ν•¨κ» μƒμ„±λμ–΄μ„ μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ μΆ…λ£λ  λ• κΉμ§€ μ μ§€λλ‹¤
κ³  ν•™μµν–λ‹¤. π•”κ²ƒμ€ μ¤ν”„λ§ λΉπ•” κΈ°λ³Έμ μΌλ΅ μ‹±κΈ€ν†¤ μ¤μ½”ν”„λ΅ μƒμ„±λκΈ° λ•λ¬Έπ•”λ‹¤. μ¤μ½”ν”„λ” λ²μ—­ κ·Έλ€λ΅ λΉπ•” μ΅΄μ¬ν• 
μ μλ” λ²”μ„λ¥Ό λ»ν•λ‹¤.

**μ¤ν”„λ§μ€ λ‹¤μκ³Ό κ°™μ€ λ‹¤μ–‘ν• μ¤μ½”ν”„λ¥Ό μ§€μ›ν•λ‹¤.**

**μ‹±κΈ€ν†¤**: κΈ°λ³Έ μ¤μ½”ν”„, μ¤ν”„λ§ μ»¨ν…π•”λ„μ μ‹μ‘κ³Ό μΆ…λ£κΉμ§€ μ μ§€λλ” κ°€μ¥ λ„“μ€ λ²”μ„μ μ¤μ½”ν”„π•”λ‹¤.

**ν”„λ΅ν† νƒ€μ…**: μ¤ν”„λ§ μ»¨ν…π•”λ„λ” ν”„λ΅ν† νƒ€μ… λΉμ μƒμ„±κ³Ό μμ΅΄κ΄€κ³„ μ£Όμ…κΉμ§€λ§ κ΄€μ—¬ν•κ³  λ”λ” κ΄€λ¦¬ν•μ§€ μ•λ” λ§¤μ°
μ§§μ€ λ²”μ„μ μ¤μ½”ν”„π•”λ‹¤.

**μ›Ή κ΄€λ ¨ μ¤μ½”ν”„**

**request**: μ›Ή μ”μ²­π•” λ“¤μ–΄μ¤κ³  λ‚κ°λ• κΉμ§€ μ μ§€λλ” μ¤μ½”ν”„π•”λ‹¤.

**session**: μ›Ή μ„Έμ…π•” μƒμ„±λκ³  μΆ…λ£λ  λ• κΉμ§€ μ μ§€λλ” μ¤μ½”ν”„π•”λ‹¤.

**application**: μ›Ήμ μ„λΈ”λ¦Ώ μ»¨ν…μ¤νΈμ™€ κ°™μ€ λ²”μ„λ΅ μ μ§€λλ” μ¤μ½”ν”„π•”λ‹¤.
λΉ μ¤μ½”ν”„λ” λ‹¤μκ³Ό κ°™π•” μ§€μ •ν•  μ μλ‹¤.

**μ»΄ν¬λ„νΈ μ¤μΊ” μλ™ λ“±λ΅**

```

@Scope("prototype")
@Component

public class HelloBean {}

```

**μλ™ λ“±λ΅**

```


@Scope("prototype")
@Bean

PrototypeBean HelloBean() {
return new HelloBean();

}

```

μ§€κΈκΉμ§€ μ‹±κΈ€ν†¤ μ¤μ½”ν”„λ¥Ό κ³„μ† μ‚¬μ©ν•΄λ³΄μ•μΌλ‹, ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„λ¶€ν„° ν™•μΈν•΄λ³΄μ.

ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„

μ‹±κΈ€ν†¤ μ¤μ½”ν”„μ λΉμ„ μ΅°νν•λ©΄ μ¤ν”„λ§ μ»¨ν…π•”λ„λ” ν•­μƒ κ°™μ€ μΈμ¤ν„΄μ¤μ μ¤ν”„λ§ λΉμ„ λ°ν™ν•λ‹¤. λ°λ©΄μ— ν”„λ΅ν† νƒ€μ… μ¤
μ½”ν”„λ¥Ό μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μ΅°νν•λ©΄ μ¤ν”„λ§ μ»¨ν…π•”λ„λ” ν•­μƒ μƒλ΅μ΄ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•΄μ„ λ°ν™ν•λ‹¤.

**μ‹±κΈ€ν†¤ λΉ μ”μ²­**

1.   μ‹±κΈ€ν†¤ μ¤μ½”ν”„μ λΉμ„ μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μ”μ²­ν•λ‹¤.

2.   μ¤ν”„λ§ μ»¨ν…π•”λ„λ” λ³ΈμΈπ•” κ΄€λ¦¬ν•λ” μ¤ν”„λ§ λΉμ„ λ°ν™ν•λ‹¤.

3.   π•”ν›„μ— μ¤ν”„λ§ μ»¨ν…π•”λ„μ— κ°™μ€ μ”μ²­π•” μ™€λ„ κ°™μ€ κ°μ²΄ μΈμ¤ν„΄μ¤μ μ¤ν”„λ§ λΉμ„ λ°ν™ν•λ‹¤.

**ν”„λ΅ν† νƒ€μ… λΉ μ”μ²­1**


1.   ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„μ λΉμ„ μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μ”μ²­ν•λ‹¤.

2.   μ¤ν”„λ§ μ»¨ν…π•”λ„λ” π•” μ‹μ μ— ν”„λ΅ν† νƒ€μ… λΉμ„ μƒμ„±ν•κ³ , ν•„μ”ν• μμ΅΄κ΄€κ³„λ¥Ό μ£Όμ…ν•λ‹¤.

**ν”„λ΅ν† νƒ€μ… λΉ μ”μ²­2**

3.   μ¤ν”„λ§ μ»¨ν…π•”λ„λ” μƒμ„±ν• ν”„λ΅ν† νƒ€μ… λΉμ„ ν΄λΌπ•”μ–ΈνΈμ— λ°ν™ν•λ‹¤.

4.   π•”ν›„μ— μ¤ν”„λ§ μ»¨ν…π•”λ„μ— κ°™μ€ μ”μ²­π•” μ¤λ©΄ ν•­μƒ μƒλ΅μ΄ ν”„λ΅ν† νƒ€μ… λΉμ„ μƒμ„±ν•΄μ„ λ°ν™ν•λ‹¤.

**μ •λ¦¬**

μ—¬κΈ°μ„ **ν•µμ‹¬μ€ μ¤ν”„λ§ μ»¨ν…μ΄λ„λ” ν”„λ΅ν† νƒ€μ… λΉμ„ μƒμ„±ν•κ³ , μμ΅΄κ΄€κ³„ μ£Όμ…, μ΄κΈ°ν™”κΉμ§€λ§ μ²λ¦¬ν•λ‹¤λ” κ²ƒμ΄λ‹¤.**                   ν΄λΌπ•”
μ–ΈνΈμ— λΉμ„ λ°ν™ν•κ³ , π•”ν›„ μ¤ν”„λ§ μ»¨ν…π•”λ„λ” μƒμ„±λ ν”„λ΅ν† νƒ€μ… λΉμ„ κ΄€λ¦¬ν•μ§€ μ•λ”λ‹¤. ν”„λ΅ν† νƒ€μ… λΉμ„ κ΄€λ¦¬ν•  μ±…μ„


μ€ ν”„λ΅ν† νƒ€μ… λΉμ„ λ°›μ€ ν΄λΌπ•”μ–ΈνΈμ— μλ‹¤. κ·Έλμ„ @PreDestroy κ°™μ€ μΆ…λ£ λ©”μ„λ“κ°€ νΈμ¶λμ§€ μ•λ”λ‹¤.

μ½”λ“λ΅ ν™•μΈν•΄λ³΄μ.

**μ‹±κΈ€ν†¤ μ¤μ½”ν”„ λΉ ν…μ¤νΈ**

```

package hello.core.scope;

import org.junit.jupiter.api.Test;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Scope;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;

import static org.assertj.core.api.Assertions.assertThat;
public class SingletonTest {

@Test

public void singletonBeanFind() {

AnnotationConfigApplicationContext ac = new
AnnotationConfigApplicationContext(SingletonBean.class);

SingletonBean singletonBean1 = ac.getBean(SingletonBean.class);
SingletonBean singletonBean2 = ac.getBean(SingletonBean.class);
System.out.println("singletonBean1 = " + singletonBean1);
System.out.println("singletonBean2     = " + singletonBean2);
assertThat(singletonBean1).isSameAs(singletonBean2);

ac.close(); //μΆ…λ£

}

@Scope("singleton")

static class SingletonBean {

@PostConstruct
public void init() {

System.out.println("SingletonBean.init");

}

@PreDestroy


public void destroy() {
System.out.println("SingletonBean.destroy");

}

}

}

```

λ¨Όμ € μ‹±κΈ€ν†¤ μ¤μ½”ν”„μ λΉμ„ μ΅°νν•λ” singletonBeanFind() ν…μ¤νΈλ¥Ό μ‹¤ν–‰ν•΄λ³΄μ.

**μ‹¤ν–‰ κ²°κ³Ό**

```

SingletonBean.init

singletonBean1 = hello.core.scope.PrototypeTest$SingletonBean@54504ecd
singletonBean2 = hello.core.scope.PrototypeTest$SingletonBean@54504ecd
org.springframework.context.annotation.AnnotationConfigApplicationContext -
Closing                                             SingletonBean.destroy

```

λΉ μ΄κΈ°ν™” λ©”μ„λ“λ¥Ό μ‹¤ν–‰ν•κ³ ,
κ°™μ€ μΈμ¤ν„΄μ¤μ λΉμ„ μ΅°νν•κ³ ,

μΆ…λ£ λ©”μ„λ“κΉμ§€ μ •μƒ νΈμ¶ λ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

**ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„ λΉ ν…μ¤νΈ

```

package hello.core.scope;

import org.junit.jupiter.api.Test;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Bean;

import org.springframework.context.annotation.Scope;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;

import static org.assertj.core.api.Assertions.*;
public class PrototypeTest {

@Test

public void prototypeBeanFind() {
AnnotationConfigApplicationContext ac = new


AnnotationConfigApplicationContext(PrototypeBean.class);
System.out.println("find prototypeBean1");

PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
System.out.println("find prototypeBean2");

PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
System.out.println("prototypeBean1 = " + prototypeBean1);
System.out.println("prototypeBean2     = " + prototypeBean2);
assertThat(prototypeBean1).isNotSameAs(prototypeBean2);

ac.close(); //μΆ…λ£

}

@Scope("prototype")

static class PrototypeBean {

@PostConstruct
public void init() {

System.out.println("PrototypeBean.init");

}

@PreDestroy

public void destroy() {
System.out.println("PrototypeBean.destroy");

}

}

}

```

ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„μ λΉμ„ μ΅°νν•λ” prototypeBeanFind() ν…μ¤νΈλ¥Ό μ‹¤ν–‰ν•΄λ³΄μ.

**μ‹¤ν–‰ κ²°κ³Ό**

```

find prototypeBean1
PrototypeBean.init
find  prototypeBean2
PrototypeBean.init

prototypeBean1 = hello.core.scope.PrototypeTest$PrototypeBean@13d4992d
prototypeBean2 = hello.core.scope.PrototypeTest$PrototypeBean@302f7971
org.springframework.context.annotation.AnnotationConfigApplicationContext -

Closing

```

μ‹±κΈ€ν†¤ λΉμ€ μ¤ν”„λ§ μ»¨ν…π•”λ„ μƒμ„± μ‹μ μ— μ΄κΈ°ν™” λ©”μ„λ“κ°€ μ‹¤ν–‰ λμ§€λ§, ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„μ λΉμ€ μ¤ν”„λ§ μ»¨ν…

π•”λ„μ—μ„ λΉμ„ μ΅°νν•  λ• μƒμ„±λκ³ , μ΄κΈ°ν™” λ©”μ„λ“λ„ μ‹¤ν–‰λλ‹¤.


ν”„λ΅ν† νƒ€μ… λΉμ„ 2λ² μ΅°νν–μΌλ―€λ΅ μ™„μ „ν λ‹¤λ¥Έ μ¤ν”„λ§ λΉπ•” μƒμ„±λκ³ , μ΄κΈ°ν™”λ„ 2λ² μ‹¤ν–‰λ κ²ƒμ„ ν™•μΈν•  μ μ
λ‹¤.

μ‹±κΈ€ν†¤ λΉμ€ μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ κ΄€λ¦¬ν•κΈ° λ•λ¬Έμ— μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ μΆ…λ£λ  λ• λΉμ μΆ…λ£ λ©”μ„λ“κ°€ μ‹¤ν–‰λμ§€λ§,
ν”„λ΅ν† νƒ€μ… λΉμ€ μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ μƒμ„±κ³Ό μμ΅΄κ΄€κ³„ μ£Όμ… κ·Έλ¦¬κ³  μ΄κΈ°ν™” κΉμ§€λ§ κ΄€μ—¬ν•κ³ , λ”λ” κ΄€λ¦¬ν•μ§€ μ•λ”
λ‹¤. λ”°λΌμ„ ν”„λ΅ν† νƒ€μ… λΉμ€ μ¤ν”„λ§ μ»¨ν…π•”λ„κ°€ μΆ…λ£λ  λ• @PreDestroy κ°™μ€ μΆ…λ£ λ©”μ„λ“κ°€ μ „ν€ μ‹¤ν–‰λμ§€ μ•
λ”λ‹¤.

**ν”„λ΅ν† νƒ€μ… λΉμ νΉμ§• μ •λ¦¬**

μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μ”μ²­ν•  λ• λ§λ‹¤ μƒλ΅ μƒμ„±λλ‹¤.

μ¤ν”„λ§ μ»¨ν…π•”λ„λ” ν”„λ΅ν† νƒ€μ… λΉμ μƒμ„±κ³Ό μμ΅΄κ΄€κ³„ μ£Όμ… κ·Έλ¦¬κ³  μ΄κΈ°ν™”κΉμ§€λ§ κ΄€μ—¬ν•λ‹¤.
μΆ…λ£ λ©”μ„λ“κ°€ νΈμ¶λμ§€ μ•λ”λ‹¤.

κ·Έλμ„ ν”„λ΅ν† νƒ€μ… λΉμ€ ν”„λ΅ν† νƒ€μ… λΉμ„ μ΅°νν• ν΄λΌπ•”μ–ΈνΈκ°€ κ΄€λ¦¬ν•΄μ•Ό ν•λ‹¤. μΆ…λ£ λ©”μ„λ“μ— λ€ν• νΈμ¶λ„ ν΄λΌπ•”
μ–ΈνΈκ°€ μ§μ ‘ ν•΄μ•Όν•λ‹¤.

ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„ - μ‹±κΈ€ν†¤ λΉκ³Ό ν•¨κ» μ‚¬μ©μ‹ λ¬Έμ μ 

μ¤ν”„λ§ μ»¨ν…π•”λ„μ— ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„μ λΉμ„ μ”μ²­ν•λ©΄ ν•­μƒ μƒλ΅μ΄ κ°μ²΄ μΈμ¤ν„΄μ¤λ¥Ό μƒμ„±ν•΄μ„ λ°ν™ν•λ‹¤. ν•μ§€λ§ μ‹±κΈ€
ν†¤ λΉκ³Ό ν•¨κ» μ‚¬μ©ν•  λ•λ” μλ„ν• λ€λ΅ μ λ™μ‘ν•μ§€ μ•μΌλ―€λ΅ μ£Όμν•΄μ•Ό ν•λ‹¤. κ·Έλ¦Όκ³Ό μ½”λ“λ΅ μ„¤λ…ν•κ² λ‹¤.

λ¨Όμ € μ¤ν”„λ§ μ»¨ν…π•”λ„μ— ν”„λ΅ν† νƒ€μ… λΉμ„ μ§μ ‘ μ”μ²­ν•λ” μμ λ¥Ό λ³΄μ.

ν”„λ΅ν† νƒ€μ… λΉ μ§μ ‘ μ”μ²­

**μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— ν”„λ΅ν† νƒ€μ… λΉ μ§μ ‘ μ”μ²­1**


1.   ν΄λΌπ•”μ–ΈνΈAλ” μ¤ν”„λ§ μ»¨ν…π•”λ„μ— ν”„λ΅ν† νƒ€μ… λΉμ„ μ”μ²­ν•λ‹¤.

2.   μ¤ν”„λ§ μ»¨ν…π•”λ„λ” ν”„λ΅ν† νƒ€μ… λΉμ„ μƒλ΅ μƒμ„±ν•΄μ„ λ°ν™(**x01**)ν•λ‹¤. ν•΄λ‹Ή λΉμ count ν•„λ“ κ°’μ€ 0π•”λ‹¤.

3.   ν΄λΌπ•”μ–ΈνΈλ” μ΅°νν• ν”„λ΅ν† νƒ€μ… λΉμ— addCount() λ¥Ό νΈμ¶ν•λ©΄μ„ count ν•„λ“λ¥Ό +1 ν•λ‹¤.
κ²°κ³Όμ μΌλ΅ ν”„λ΅ν† νƒ€μ… λΉ(**x01**)μ countλ” 1π•” λλ‹¤.

**μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— ν”„λ΅ν† νƒ€μ… λΉ μ§μ ‘ μ”μ²­2**

1.   ν΄λΌπ•”μ–ΈνΈBλ” μ¤ν”„λ§ μ»¨ν…π•”λ„μ— ν”„λ΅ν† νƒ€μ… λΉμ„ μ”μ²­ν•λ‹¤.

2.   μ¤ν”„λ§ μ»¨ν…π•”λ„λ” ν”„λ΅ν† νƒ€μ… λΉμ„ μƒλ΅ μƒμ„±ν•΄μ„ λ°ν™(**x02**)ν•λ‹¤. ν•΄λ‹Ή λΉμ count ν•„λ“ κ°’μ€ 0π•”λ‹¤.

3.   ν΄λΌπ•”μ–ΈνΈλ” μ΅°νν• ν”„λ΅ν† νƒ€μ… λΉμ— addCount() λ¥Ό νΈμ¶ν•λ©΄μ„ count ν•„λ“λ¥Ό +1 ν•λ‹¤.
κ²°κ³Όμ μΌλ΅ ν”„λ΅ν† νƒ€μ… λΉ(**x02**)μ countλ” 1π•” λλ‹¤.


**μ½”λ“λ΅ ν™•μΈ**

```

public class SingletonWithPrototypeTest1 {
@Test

void prototypeFind() {
AnnotationConfigApplicationContext ac = new

AnnotationConfigApplicationContext(PrototypeBean.class);

PrototypeBean prototypeBean1 = ac.getBean(PrototypeBean.class);
prototypeBean1.addCount();
assertThat(prototypeBean1.getCount()).isEqualTo(1);

PrototypeBean prototypeBean2 = ac.getBean(PrototypeBean.class);
prototypeBean2.addCount();
assertThat(prototypeBean2.getCount()).isEqualTo(1);

}

@Scope("prototype")

static class PrototypeBean {
private int count = 0;

public void addCount() {
count++;

}

public int getCount() {
return count;

}

@PostConstruct
public void init() {

System.out.println("PrototypeBean.init " + this);

}

@PreDestroy

public void destroy() {
System.out.println("PrototypeBean.destroy");

}

}

}


```

μ‹±κΈ€ν†¤ λΉμ—μ„ ν”„λ΅ν† νƒ€μ… λΉ μ‚¬μ©

π•”λ²μ—λ” clientBean π•”λΌλ” μ‹±κΈ€ν†¤ λΉπ•” μμ΅΄κ΄€κ³„ μ£Όμ…μ„ ν†µν•΄μ„ ν”„λ΅ν† νƒ€μ… λΉμ„ μ£Όμ…λ°›μ•„μ„ μ‚¬μ©ν•λ” μλ¥Ό λ³΄μ.

**μ‹±κΈ€ν†¤μ—μ„ ν”„λ΅ν† νƒ€μ… λΉ μ‚¬μ©1**

clientBean μ€ μ‹±κΈ€ν†¤π•”λ―€λ΅, λ³΄ν†µ μ¤ν”„λ§ μ»¨ν…π•”λ„ μƒμ„± μ‹μ μ— ν•¨κ» μƒμ„±λκ³ , μμ΅΄κ΄€κ³„ μ£Όμ…λ„ λ°μƒν•λ‹¤.

1.    clientBean μ€ μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…μ„ μ‚¬μ©ν•λ‹¤. μ£Όμ… μ‹μ μ— μ¤ν”„λ§ μ»¨ν…π•”λ„μ— ν”„λ΅ν† νƒ€μ… λΉμ„ μ”μ²­ν•
λ‹¤.

2.   μ¤ν”„λ§ μ»¨ν…π•”λ„λ” ν”„λ΅ν† νƒ€μ… λΉμ„ μƒμ„±ν•΄μ„ clientBean μ— λ°ν™ν•λ‹¤. ν”„λ΅ν† νƒ€μ… λΉμ count ν•„λ“ κ°’
μ€ 0π•”λ‹¤.

π•”μ  clientBean μ€ ν”„λ΅ν† νƒ€μ… λΉμ„ λ‚΄λ¶€ ν•„λ“μ— λ³΄κ΄€ν•λ‹¤. (μ •ν™•νλ” μ°Έμ΅°κ°’μ„ λ³΄κ΄€ν•λ‹¤.)

**μ‹±κΈ€ν†¤μ—μ„ ν”„λ΅ν† νƒ€μ… λΉ μ‚¬μ©2**


ν΄λΌπ•”μ–ΈνΈ Aλ” clientBean μ„ μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μ”μ²­ν•΄μ„ λ°›λ”λ‹¤.μ‹±κΈ€ν†¤π•”λ―€λ΅ ν•­μƒ κ°™μ€ clientBean

π•” λ°ν™λλ‹¤.

3.   ν΄λΌπ•”μ–ΈνΈ Aλ” clientBean.logic() μ„ νΈμ¶ν•λ‹¤.

4.    clientBean μ€ prototypeBeanμ addCount() λ¥Ό νΈμ¶ν•΄μ„ ν”„λ΅ν† νƒ€μ… λΉμ countλ¥Ό μ¦κ°€ν•λ‹¤.
countκ°’π•” 1π•” λλ‹¤.

**μ‹±κΈ€ν†¤μ—μ„ ν”„λ΅ν† νƒ€μ… λΉ μ‚¬μ©3**

ν΄λΌπ•”μ–ΈνΈ Bλ” clientBean μ„ μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μ”μ²­ν•΄μ„ λ°›λ”λ‹¤.μ‹±κΈ€ν†¤π•”λ―€λ΅ ν•­μƒ κ°™μ€ clientBean

π•” λ°ν™λλ‹¤.

**μ—¬κΈ°μ„ μ¤‘μ”ν• μ μ΄ μλ”λ°, clientBeanμ΄ λ‚΄λ¶€μ— κ°€μ§€κ³  μλ” ν”„λ΅ν† νƒ€μ… λΉμ€ μ΄λ―Έ κ³Όκ±°μ— μ£Όμ…μ΄ λλ‚ λΉμ΄
λ‹¤. μ£Όμ… μ‹μ μ— μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— μ”μ²­ν•΄μ„ ν”„λ΅ν† νƒ€μ… λΉμ΄ μƒλ΅ μƒμ„±μ΄ λ κ²ƒμ΄μ§€, μ‚¬μ© ν•  λ•λ§λ‹¤ μƒλ΅ μƒμ„±λ


λ” κ²ƒμ΄ μ•„λ‹λ‹¤!**

5.   ν΄λΌπ•”μ–ΈνΈ Bλ” clientBean.logic() μ„ νΈμ¶ν•λ‹¤.

6.    clientBean μ€ prototypeBeanμ addCount() λ¥Ό νΈμ¶ν•΄μ„ ν”„λ΅ν† νƒ€μ… λΉμ countλ¥Ό μ¦κ°€ν•λ‹¤. μ›
λ count κ°’π•” 1π•”μ—μΌλ―€λ΅ 2κ°€ λλ‹¤.

**ν…μ¤νΈ μ½”λ“**

```

package hello.core.scope;

import org.junit.jupiter.api.Test;

import org.springframework.beans.factory.annotation.Autowired;
import

org.springframework.context.annotation.AnnotationConfigApplicationContext;
import org.springframework.context.annotation.Scope;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;

import static org.assertj.core.api.Assertions.*;
public class SingletonWithPrototypeTest1 {

@Test

void singletonClientUsePrototype() {
AnnotationConfigApplicationContext ac = new

AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);

ClientBean clientBean1 = ac.getBean(ClientBean.class);
int count1 = clientBean1.logic();
assertThat(count1).isEqualTo(1);

ClientBean clientBean2 = ac.getBean(ClientBean.class);
int count2 = clientBean2.logic();
assertThat(count2).isEqualTo(2);

}

static class ClientBean {

private final PrototypeBean prototypeBean;
@Autowired

public ClientBean(PrototypeBean prototypeBean) {


this.prototypeBean = prototypeBean;

}

public int logic() {
prototypeBean.addCount();

int count = prototypeBean.getCount();
return count;

}

}

@Scope("prototype")

static class PrototypeBean {
private int count = 0;

public void addCount() {
count++;

}

public int getCount() {
return count;

}

@PostConstruct
public void init() {

System.out.println("PrototypeBean.init " + this);

}

@PreDestroy

public void destroy() {
System.out.println("PrototypeBean.destroy");

}

}

}

```

μ¤ν”„λ§μ€ μΌλ°μ μΌλ΅ μ‹±κΈ€ν†¤ λΉμ„ μ‚¬μ©ν•λ―€λ΅, μ‹±κΈ€ν†¤ λΉπ•” ν”„λ΅ν† νƒ€μ… λΉμ„ μ‚¬μ©ν•κ² λλ‹¤. κ·Έλ°λ° μ‹±κΈ€ν†¤ λΉμ€ μƒμ„±
μ‹μ μ—λ§ μμ΅΄κ΄€κ³„ μ£Όμ…μ„ λ°›κΈ° λ•λ¬Έμ—, ν”„λ΅ν† νƒ€μ… λΉπ•” μƒλ΅ μƒμ„±λκΈ°λ” ν•μ§€λ§, μ‹±κΈ€ν†¤ λΉκ³Ό ν•¨κ» κ³„μ† μ μ§€λλ” κ²ƒ

π•” λ¬Έμ λ‹¤.

μ•„λ§ μ›ν•λ” κ²ƒπ•” π•”λ° κ²ƒμ€ μ•„λ‹ κ²ƒπ•”λ‹¤. ν”„λ΅ν† νƒ€μ… λΉμ„ μ£Όμ… μ‹μ μ—λ§ μƒλ΅ μƒμ„±ν•λ”κ² μ•„λ‹λΌ, μ‚¬μ©ν•  λ• λ§λ‹¤ μƒλ΅


μƒμ„±ν•΄μ„ μ‚¬μ©ν•λ” κ²ƒμ„ μ›ν•  κ²ƒπ•”λ‹¤.

**μ°Έκ³ :**                   μ—¬λ¬ λΉμ—μ„ κ°™μ€ ν”„λ΅ν† νƒ€μ… λΉμ„ μ£Όμ… λ°›μΌλ©΄, **μ£Όμ… λ°›λ” μ‹μ μ— κ°κ° μƒλ΅μ΄ ν”„λ΅ν† νƒ€μ… λΉμ΄ μƒμ„±**λλ‹¤.

μλ¥Ό λ“¤μ–΄μ„ clientA, clientBκ°€ κ°κ° μμ΅΄κ΄€κ³„ μ£Όμ…μ„ λ°›μΌλ©΄ κ°κ° λ‹¤λ¥Έ μΈμ¤ν„΄μ¤μ ν”„λ΅ν† νƒ€μ… λΉμ„ μ£Όμ… λ°›λ”
λ‹¤.

clientA     prototypeBean@x01
clientB     prototypeBean@x02

λ¬Όλ΅  μ‚¬μ©ν•  λ• λ§λ‹¤ μƒλ΅ μƒμ„±λλ” κ²ƒμ€ μ•„λ‹λ‹¤.

ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„ - μ‹±κΈ€ν†¤ λΉκ³Ό ν•¨κ» μ‚¬μ©μ‹ Providerλ΅ λ¬Έμ  ν•΄κ²°

μ‹±κΈ€ν†¤ λΉκ³Ό ν”„λ΅ν† νƒ€μ… λΉμ„ ν•¨κ» μ‚¬μ©ν•  λ•, μ–΄λ–»κ² ν•λ©΄ μ‚¬μ©ν•  λ• λ§λ‹¤ ν•­μƒ μƒλ΅μ΄ ν”„λ΅ν† νƒ€μ… λΉμ„ μƒμ„±ν•  μ μμ„
κΉ?

μ¤ν”„λ§ μ»¨ν…μ΄λ„μ— μ”μ²­

κ°€μ¥ κ°„λ‹¨ν• λ°©λ²•μ€ μ‹±κΈ€ν†¤ λΉπ•” ν”„λ΅ν† νƒ€μ…μ„ μ‚¬μ©ν•  λ• λ§λ‹¤ μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μƒλ΅ μ”μ²­ν•λ” κ²ƒπ•”λ‹¤.

```

public class PrototypeProviderTest {

@Test

void providerTest() {
AnnotationConfigApplicationContext ac = new

AnnotationConfigApplicationContext(ClientBean.class, PrototypeBean.class);

ClientBean clientBean1 = ac.getBean(ClientBean.class);
int count1 = clientBean1.logic();
assertThat(count1).isEqualTo(1);

ClientBean clientBean2 = ac.getBean(ClientBean.class);
int count2 = clientBean2.logic();
assertThat(count2).isEqualTo(1);

}

static class ClientBean {


@Autowired

private ApplicationContext ac;

public int logic() {

PrototypeBean prototypeBean = ac.getBean(PrototypeBean.class);
prototypeBean.addCount();

int count = prototypeBean.getCount();
return count;

}

}

@Scope("prototype")

static class PrototypeBean {
private int count = 0;

public void addCount() {
count++;

}

public int getCount() {
return count;

}

@PostConstruct
public void init() {

System.out.println("PrototypeBean.init " + this);

}

@PreDestroy

public void destroy() {
System.out.println("PrototypeBean.destroy");

}

}

}

```

**ν•µμ‹¬ μ½”λ“**

```

@Autowired

private ApplicationContext ac;


public int logic() {

PrototypeBean prototypeBean = ac.getBean(PrototypeBean.class);
prototypeBean.addCount();

int count = prototypeBean.getCount();
return count;

}

```

μ‹¤ν–‰ν•΄λ³΄λ©΄ ac.getBean() μ„ ν†µν•΄μ„ ν•­μƒ μƒλ΅μ΄ ν”„λ΅ν† νƒ€μ… λΉπ•” μƒμ„±λλ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

μμ΅΄κ΄€κ³„λ¥Ό μ™Έλ¶€μ—μ„ μ£Όμ…(DI) λ°›λ”κ² μ•„λ‹λΌ π•”λ ‡κ² μ§μ ‘ ν•„μ”ν• μμ΅΄κ΄€κ³„λ¥Ό μ°Ύλ” κ²ƒμ„ Dependency Lookup
(DL) μμ΅΄κ΄€κ³„ μ΅°ν(νƒμƒ‰) π•”λΌν•λ‹¤.

κ·Έλ°λ° π•”λ ‡κ² μ¤ν”„λ§μ μ• ν”λ¦¬μΌ€π•”μ… μ»¨ν…μ¤νΈ μ „μ²΄λ¥Ό μ£Όμ…λ°›κ² λλ©΄, μ¤ν”„λ§ μ»¨ν…π•”λ„μ— μΆ…μ†μ μΈ μ½”λ“κ°€ λκ³ ,
λ‹¨μ„ ν…μ¤νΈλ„ μ–΄λ ¤μ›μ§„λ‹¤.

μ§€κΈ ν•„μ”ν• κΈ°λ¥μ€ μ§€μ •ν• ν”„λ΅ν† νƒ€μ… λΉμ„ μ»¨ν…π•”λ„μ—μ„ λ€μ‹  μ°Ύμ•„μ£Όλ” λ”±! **DL**                   μ •λ„μ κΈ°λ¥λ§ μ κ³µν•λ” λ¬΄μ–Έκ°€
κ°€ μμΌλ©΄ λλ‹¤.

μ¤ν”„λ§μ—λ” π•”λ―Έ λ¨λ“ κ² μ¤€λΉ„λμ–΄ μλ‹¤.

ObjectFactOry, ObjectProvider

μ§€μ •ν• λΉμ„ μ»¨ν…π•”λ„μ—μ„ λ€μ‹  μ°Ύμ•„μ£Όλ” DL μ„λΉ„μ¤λ¥Ό μ κ³µν•λ” κ²ƒπ•” λ°”λ΅ ObjectProvider π•”λ‹¤. μ°Έκ³ λ΅ κ³Όκ±°μ—λ”

ObjectFactory κ°€ μμ—λ”λ°, μ—¬κΈ°μ— νΈμ κΈ°λ¥μ„ μ¶”κ°€ν•΄μ„ ObjectProvider κ°€ λ§λ“¤μ–΄μ΅λ‹¤.

```

@Autowired

private ObjectProvider<PrototypeBean> prototypeBeanProvider;

public int logic() {

PrototypeBean prototypeBean = prototypeBeanProvider.getObject();
prototypeBean.addCount();

int count = prototypeBean.getCount();
return count;

}

```

μ‹¤ν–‰ν•΄λ³΄λ©΄ prototypeBeanProvider.getObject() μ„ ν†µν•΄μ„ ν•­μƒ μƒλ΅μ΄ ν”„λ΅ν† νƒ€μ… λΉπ•” μƒμ„±λλ” κ²ƒ
μ„ ν™•μΈν•  μ μλ‹¤.

ObjectProvider μ getObject() λ¥Ό νΈμ¶ν•λ©΄ λ‚΄λ¶€μ—μ„λ” μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό ν†µν•΄ ν•΄λ‹Ή λΉμ„ μ°Ύμ•„μ„ λ°ν™
ν•λ‹¤. (**DL**)

μ¤ν”„λ§π•” μ κ³µν•λ” κΈ°λ¥μ„ μ‚¬μ©ν•μ§€λ§, κΈ°λ¥π•” λ‹¨μν•λ―€λ΅ λ‹¨μ„ν…μ¤νΈλ¥Ό λ§λ“¤κ±°λ‚ mock μ½”λ“λ¥Ό λ§λ“¤κΈ°λ” ν›¨μ”¬
μ‰¬μ›μ§„λ‹¤.


ObjectProvider λ” μ§€κΈ λ”± ν•„μ”ν• DL μ •λ„μ κΈ°λ¥λ§ μ κ³µν•λ‹¤.


**νΉμ§•**

ObjectFactory: κΈ°λ¥π•” λ‹¨μ, λ³„λ„μ λΌπ•”λΈλ¬λ¦¬ ν•„μ” μ—†μ, μ¤ν”„λ§μ— μμ΅΄

ObjectProvider: ObjectFactory μƒμ†, μµμ…, μ¤νΈλ¦Ό μ²λ¦¬λ“± νΈμ κΈ°λ¥π•” λ§κ³ , λ³„λ„μ λΌπ•”λΈλ¬λ¦¬ ν•„μ” μ—†μ,
μ¤ν”„λ§μ— μμ΅΄

JSR-330 Provider

λ§μ§€λ§‰ λ°©λ²•μ€ javax.inject.Provider λΌλ” JSR-330 μλ°” ν‘μ¤€μ„ μ‚¬μ©ν•λ” λ°©λ²•π•”λ‹¤.

**μ¤ν”„λ§ λ¶€νΈ 3.0**μ€ jakarta.inject.Provider μ‚¬μ©ν•λ‹¤.

π•” λ°©λ²•μ„ μ‚¬μ©ν•λ ¤λ©΄ λ‹¤μ λΌπ•”λΈλ¬λ¦¬λ¥Ό gradleμ— μ¶”κ°€ν•΄μ•Ό ν•λ‹¤.

**μ¤ν”„λ§λ¶€νΈ 3.0 λ―Έλ§**

javax.inject:javax.inject:1 λΌπ•”λΈλ¬λ¦¬λ¥Ό gradleμ— μ¶”κ°€ν•΄μ•Ό ν•λ‹¤.

**μ¤ν”„λ§λ¶€νΈ 3.0 μ΄μƒ**

jakarta.inject:jakarta.inject-api:2.0.1 λΌπ•”λΈλ¬λ¦¬λ¥Ό gradleμ— μ¶”κ°€ν•΄μ•Ό ν•λ‹¤.

**javax.inject.Provider μ°Έκ³ μ© μ½”λ“ - μ¤ν”„λ§λ¶€νΈ 3.0 λ―Έλ§**

```

package javax.inject;

public interface Provider<T> {
T get();

}

```

**μ¤ν”„λ§ λ¶€νΈ 3.0**μ€ jakarta.inject.Provider μ‚¬μ©

```

@Autowired

private Provider<PrototypeBean> provider;

public int logic() {

PrototypeBean prototypeBean = provider.get();
prototypeBean.addCount();

int count = prototypeBean.getCount();
return count;

}

```


μ‹¤ν–‰ν•΄λ³΄λ©΄ provider.get() μ„ ν†µν•΄μ„ ν•­μƒ μƒλ΅μ΄ ν”„λ΅ν† νƒ€μ… λΉπ•” μƒμ„±λλ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.
provider μ get() μ„ νΈμ¶ν•λ©΄ λ‚΄λ¶€μ—μ„λ” μ¤ν”„λ§ μ»¨ν…π•”λ„λ¥Ό ν†µν•΄ ν•΄λ‹Ή λΉμ„ μ°Ύμ•„μ„ λ°ν™ν•λ‹¤. (**DL)
μλ°” ν‘μ¤€π•”κ³ , κΈ°λ¥π•” λ‹¨μν•λ―€λ΅ λ‹¨μ„ν…μ¤νΈλ¥Ό λ§λ“¤κ±°λ‚ mock μ½”λ“λ¥Ό λ§λ“¤κΈ°λ” ν›¨μ”¬ μ‰¬μ›μ§„λ‹¤.

Provider λ” μ§€κΈ λ”± ν•„μ”ν• DL μ •λ„μ κΈ°λ¥λ§ μ κ³µν•λ‹¤.


**νΉμ§•**

get() λ©”μ„λ“ ν•λ‚λ΅ κΈ°λ¥π•” λ§¤μ° λ‹¨μν•λ‹¤.
λ³„λ„μ λΌπ•”λΈλ¬λ¦¬κ°€ ν•„μ”ν•λ‹¤.

μλ°” ν‘μ¤€π•”λ―€λ΅ μ¤ν”„λ§π•” μ•„λ‹ λ‹¤λ¥Έ μ»¨ν…π•”λ„μ—μ„λ„ μ‚¬μ©ν•  μ μλ‹¤.


**μ •λ¦¬**

κ·Έλ¬λ©΄ ν”„λ΅ν† νƒ€μ… λΉμ„ μ–Έμ  μ‚¬μ©ν• κΉ? λ§¤λ² μ‚¬μ©ν•  λ• λ§λ‹¤ μμ΅΄κ΄€κ³„ μ£Όμ…π•” μ™„λ£λ μƒλ΅μ΄ κ°μ²΄κ°€ ν•„μ”ν•λ©΄ μ‚¬
μ©ν•λ©΄ λλ‹¤. κ·Έλ°λ° μ‹¤λ¬΄μ—μ„ μ›Ή μ• ν”λ¦¬μΌ€π•”μ…μ„ κ°λ°ν•΄λ³΄λ©΄, μ‹±κΈ€ν†¤ λΉμΌλ΅ λ€λ¶€λ¶„μ λ¬Έμ λ¥Ό ν•΄κ²°ν•  μ μκΈ° λ•
λ¬Έμ— ν”„λ΅ν† νƒ€μ… λΉμ„ μ§μ ‘μ μΌλ΅ μ‚¬μ©ν•λ” μΌμ€ λ§¤μ° λ“λ¬Όλ‹¤.

ObjectProvider ,  JSR330 Provider λ“±μ€ ν”„λ΅ν† νƒ€μ… λΏλ§ μ•„λ‹λΌ DLπ•” ν•„μ”ν• κ²½μ°λ” μ–Έμ λ“ μ§€ μ‚¬μ©ν• 
μ μλ‹¤.

**μ°Έκ³ :**                   μ¤ν”„λ§π•” μ κ³µν•λ” λ©”μ„λ“μ— @Lookup μ• λ…Έν…π•”μ…μ„ μ‚¬μ©ν•λ” λ°©λ²•λ„ μμ§€λ§, π•”μ „ λ°©λ²•λ“¤λ΅ μ¶©λ¶„ν•κ³ ,
κ³ λ ¤ν•΄μ•Όν•  λ‚΄μ©λ„ λ§μ•„μ„ μƒλµν•κ² λ‹¤.

**μ°Έκ³ :**                   μ‹¤λ¬΄μ—μ„ μλ°” ν‘μ¤€μΈ JSR-330 Providerλ¥Ό μ‚¬μ©ν•  κ²ƒμΈμ§€, μ•„λ‹λ©΄ μ¤ν”„λ§π•” μ κ³µν•λ” ObjectProvider
λ¥Ό μ‚¬μ©ν•  κ²ƒμΈμ§€ κ³ λ―Όπ•” λ  κ²ƒπ•”λ‹¤. ObjectProviderλ” DLμ„ μ„ν• νΈμ κΈ°λ¥μ„ λ§π•” μ κ³µν•΄μ£Όκ³  μ¤ν”„λ§ μ™Έμ— λ³„
λ„μ μμ΅΄κ΄€κ³„ μ¶”κ°€κ°€ ν•„μ” μ—†κΈ° λ•λ¬Έμ— νΈλ¦¬ν•λ‹¤. λ§μ•½(μ •λ§ κ·Έλ΄μΌμ€ κ±°μ μ—†κ² μ§€λ§) μ½”λ“λ¥Ό μ¤ν”„λ§π•” μ•„λ‹ λ‹¤λ¥Έ
μ»¨ν…π•”λ„μ—μ„λ„ μ‚¬μ©ν•  μ μμ–΄μ•Ό ν•λ‹¤λ©΄ JSR-330 Providerλ¥Ό μ‚¬μ©ν•΄μ•Όν•λ‹¤.

μ¤ν”„λ§μ„ μ‚¬μ©ν•λ‹¤ λ³΄λ©΄ π•” κΈ°λ¥ λΏλ§ μ•„λ‹λΌ λ‹¤λ¥Έ κΈ°λ¥λ“¤λ„ μλ°” ν‘μ¤€κ³Ό μ¤ν”„λ§π•” μ κ³µν•λ” κΈ°λ¥π•” κ²ΉμΉ λ•κ°€ λ§

π•” μλ‹¤. λ€λ¶€λ¶„ μ¤ν”„λ§π•” λ” λ‹¤μ–‘ν•κ³  νΈλ¦¬ν• κΈ°λ¥μ„ μ κ³µν•΄μ£ΌκΈ° λ•λ¬Έμ—, νΉλ³„ν λ‹¤λ¥Έ μ»¨ν…π•”λ„λ¥Ό μ‚¬μ©ν•  μΌπ•” μ—†
λ‹¤λ©΄, μ¤ν”„λ§π•” μ κ³µν•λ” κΈ°λ¥μ„ μ‚¬μ©ν•λ©΄ λλ‹¤.


μ›Ή μ¤μ½”ν”„

μ§€κΈκΉμ§€ μ‹±κΈ€ν†¤κ³Ό ν”„λ΅ν† νƒ€μ… μ¤μ½”ν”„λ¥Ό ν•™μµν–λ‹¤. μ‹±κΈ€ν†¤μ€ μ¤ν”„λ§ μ»¨ν…π•”λ„μ μ‹μ‘κ³Ό λκΉμ§€ ν•¨κ»ν•λ” λ§¤μ° κΈ΄ μ¤μ½”
ν”„π•”κ³ , ν”„λ΅ν† νƒ€μ…μ€ μƒμ„±κ³Ό μμ΅΄κ΄€κ³„ μ£Όμ…, κ·Έλ¦¬κ³  μ΄κΈ°ν™”κΉμ§€λ§ μ§„ν–‰ν•λ” νΉλ³„ν• μ¤μ½”ν”„π•”λ‹¤.

π•”λ²μ—λ” μ›Ή μ¤μ½”ν”„μ— λ€ν•΄μ„ μ•μ•„λ³΄μ

**μ›Ή μ¤μ½”ν”„μ νΉμ§•**

μ›Ή μ¤μ½”ν”„λ” μ›Ή ν™κ²½μ—μ„λ§ λ™μ‘ν•λ‹¤.

μ›Ή μ¤μ½”ν”„λ” ν”„λ΅ν† νƒ€μ…κ³Ό λ‹¤λ¥΄κ² μ¤ν”„λ§π•” ν•΄λ‹Ή μ¤μ½”ν”„μ μΆ…λ£μ‹μ κΉμ§€ κ΄€λ¦¬ν•λ‹¤. λ”°λΌμ„ μΆ…λ£ λ©”μ„λ“κ°€ νΈμ¶λ
λ‹¤.

**μ›Ή μ¤μ½”ν”„ μΆ…λ¥**

**request:**                   HTTP μ”μ²­ ν•λ‚κ°€ λ“¤μ–΄μ¤κ³  λ‚κ° λ• κΉμ§€ μ μ§€λλ” μ¤μ½”ν”„, κ°κ°μ HTTP μ”μ²­λ§λ‹¤ λ³„λ„μ λΉ μΈμ¤ν„΄
μ¤κ°€ μƒμ„±λκ³ , κ΄€λ¦¬λλ‹¤.

**session:**                   HTTP Sessionκ³Ό λ™μΌν• μƒλ…μ£ΌκΈ°λ¥Ό κ°€μ§€λ” μ¤μ½”ν”„

**application:**                   μ„λΈ”λ¦Ώ μ»¨ν…μ¤νΈ( ServletContext )μ™€ λ™μΌν• μƒλ…μ£ΌκΈ°λ¥Ό κ°€μ§€λ” μ¤μ½”ν”„

**websocket:**                   μ›Ή μ†μΌ“κ³Ό λ™μΌν• μƒλ…μ£ΌκΈ°λ¥Ό κ°€μ§€λ” μ¤μ½”ν”„

μ‚¬μ‹¤ μ„Έμ…π•”λ‚, μ„λΈ”λ¦Ώ μ»¨ν…μ¤νΈ, μ›Ή μ†μΌ“ κ°™μ€ μ©μ–΄λ¥Ό μ λ¨λ¥΄λ” λ¶„λ“¤λ„ μμ„ κ²ƒπ•”λ‹¤. μ—¬κΈ°μ„λ” request μ¤μ½”ν”„λ¥Ό μμ 
λ΅ μ„¤λ…ν•κ² λ‹¤. λ‚λ¨Έμ§€λ„ λ²”μ„λ§ λ‹¤λ¥΄μ§€ λ™μ‘ λ°©μ‹μ€ λΉ„μ·ν•λ‹¤.

**HTTP request μ”μ²­ λ‹Ή κ°κ° ν• λ‹Ήλλ” request μ¤μ½”ν”„**


request μ¤μ½”ν”„ μμ  λ§λ“¤κΈ°

μ›Ή ν™κ²½ μ¶”κ°€

μ›Ή μ¤μ½”ν”„λ” μ›Ή ν™κ²½μ—μ„λ§ λ™μ‘ν•λ―€λ΅ web ν™κ²½π•” λ™μ‘ν•λ„λ΅ λΌπ•”λΈλ¬λ¦¬λ¥Ό μ¶”κ°€ν•μ.

**build.gradleμ— μ¶”κ°€**

```grvy

//web λΌπ•”λΈλ¬λ¦¬  μ¶”κ°€

implementation 'org.springframework.boot:spring-boot-starter-web'

```

π•”μ  hello.core.CoreApplication μ main λ©”μ„λ“λ¥Ό μ‹¤ν–‰ν•λ©΄ μ›Ή μ• ν”λ¦¬μΌ€π•”μ…π•” μ‹¤ν–‰λλ” κ²ƒμ„ ν™•μΈν•  μ μ
λ‹¤.

```

Tomcat started on port(s): 8080 (http) with context path ''
Started CoreApplication in 0.914 seconds (JVM running for 1.528)

```

**μ°Έκ³ :**                               spring-boot-starter-web λΌπ•”λΈλ¬λ¦¬λ¥Ό μ¶”κ°€ν•λ©΄ μ¤ν”„λ§ λ¶€νΈλ” λ‚΄μ¥ ν†°μΌ“ μ„λ²„λ¥Ό ν™μ©ν•΄μ„ μ›Ή 
μ„
λ²„μ™€ μ¤ν”„λ§μ„ ν•¨κ» μ‹¤ν–‰μ‹ν‚¨λ‹¤.

**μ°Έκ³ :**                   μ¤ν”„λ§ λ¶€νΈλ” μ›Ή λΌπ•”λΈλ¬λ¦¬κ°€ μ—†μΌλ©΄ μ°λ¦¬κ°€ μ§€κΈκΉμ§€ ν•™μµν•
AnnotationConfigApplicationContext μ„ κΈ°λ°μΌλ΅ μ• ν”λ¦¬μΌ€π•”μ…μ„ κµ¬λ™ν•λ‹¤. μ›Ή λΌπ•”λΈλ¬λ¦¬κ°€ μ¶”κ°€λ
λ©΄                                                            μ›Ήκ³Ό κ΄€λ ¨λ μ¶”κ°€ μ„¤μ •κ³Ό ν™κ²½λ“¤π•” ν•„μ”ν•λ―€λ΅
AnnotationConfigServletWebServerApplicationContext λ¥Ό κΈ°λ°μΌλ΅ μ• ν”λ¦¬μΌ€π•”μ…μ„ κµ¬λ™ν•λ‹¤.

λ§μ•½ κΈ°λ³Έ ν¬νΈμΈ 8080 ν¬νΈλ¥Ό λ‹¤λ¥Έκ³³μ—μ„ μ‚¬μ©μ¤‘π•”μ–΄μ„ μ¤λ¥κ°€ λ°μƒν•λ©΄ ν¬νΈλ¥Ό λ³€κ²½ν•΄μ•Ό ν•λ‹¤. 9090 ν¬νΈλ΅ λ³€κ²½ν•
λ ¤λ©΄ λ‹¤μ μ„¤μ •μ„ μ¶”κ°€ν•μ.

main/resources/application.properties

```

server.port=9090

```


request μ¤μ½”ν”„ μμ  κ°λ°

λ™μ‹μ— μ—¬λ¬ HTTP μ”μ²­π•” μ¤λ©΄ μ •ν™•ν μ–΄λ–¤ μ”μ²­π•” λ‚¨κΈ΄ λ΅κ·ΈμΈμ§€ κµ¬λ¶„ν•κΈ° μ–΄λ µλ‹¤.

π•”λ΄λ• μ‚¬μ©ν•κΈ° λ”± μΆ‹μ€κ²ƒπ•” λ°”λ΅ request μ¤μ½”ν”„π•”λ‹¤.

λ‹¤μκ³Ό κ°™π•” λ΅κ·Έκ°€ λ‚¨λ„λ΅ request μ¤μ½”ν”„λ¥Ό ν™μ©ν•΄μ„ μ¶”κ°€ κΈ°λ¥μ„ κ°λ°ν•΄λ³΄μ.

```

[d06b992f...] request scope bean create
[d06b992f...][http://localhost:8080/log-demo] controller test
[d06b992f...][http://localhost:8080/log-demo] service id = testId
[d06b992f...]                         request scope bean close

```

κΈ°λ€ν•λ” κ³µν†µ ν¬λ©§: UUIDre                   {message}
UUIDλ¥Ό μ‚¬μ©ν•΄μ„ HTTP μ”μ²­μ„ κµ¬λ¶„ν•μ.

requestURL μ •λ³΄λ„ μ¶”κ°€λ΅ λ„£μ–΄μ„ μ–΄λ–¤ URLμ„ μ”μ²­ν•΄μ„ λ‚¨μ€ λ΅κ·ΈμΈμ§€ ν™•μΈν•μ.
λ¨Όμ € μ½”λ“λ΅ ν™•μΈν•΄λ³΄μ.

**MyLogger**

```

package hello.core.common;

import org.springframework.context.annotation.Scope;
import org.springframework.stereotype.Component;

import javax.annotation.PostConstruct;
import javax.annotation.PreDestroy;
import java.util.UUID;

@Component

@Scope(value = "request")
public class MyLogger {

private String uuid;
private String requestURL;

public void setRequestURL(String requestURL) {
this.requestURL = requestURL;

}

public void log(String message) {

System.out.println("[" + uuid + "]" + "[" + requestURL + "] " +


message);

}

@PostConstruct
public void init() {

uuid = UUID.randomUUID().toString();

System.out.println("[" + uuid + "] request scope bean create:" + this);

}

@PreDestroy

public void close() {

System.out.println("[" + uuid + "] request scope bean close:" + this);

}

}

```

λ΅κ·Έλ¥Ό μ¶λ ¥ν•κΈ° μ„ν• MyLogger ν΄λμ¤π•”λ‹¤.

@Scope(value = "request") λ¥Ό μ‚¬μ©ν•΄μ„ request μ¤μ½”ν”„λ΅ μ§€μ •ν–λ‹¤. π•”μ  π•” λΉμ€ HTTP μ”μ²­ λ‹Ή ν•λ‚
μ”© μƒμ„±λκ³ , HTTP μ”μ²­π•” λλ‚λ” μ‹μ μ— μ†λ©Έλλ‹¤.

π•” λΉπ•” μƒμ„±λλ” μ‹μ μ— μλ™μΌλ΅ @PostConstruct μ΄κΈ°ν™” λ©”μ„λ“λ¥Ό μ‚¬μ©ν•΄μ„ uuidλ¥Ό μƒμ„±ν•΄μ„ μ €μ¥ν•΄λ‘”λ‹¤.

π•” λΉμ€ HTTP μ”μ²­ λ‹Ή ν•λ‚μ”© μƒμ„±λλ―€λ΅, uuidλ¥Ό μ €μ¥ν•΄λ‘λ©΄ λ‹¤λ¥Έ HTTP μ”μ²­κ³Ό κµ¬λ¶„ν•  μ μλ‹¤.

π•” λΉπ•” μ†λ©Έλλ” μ‹μ μ— @PreDestroy λ¥Ό μ‚¬μ©ν•΄μ„ μΆ…λ£ λ©”μ‹μ§€λ¥Ό λ‚¨κΈ΄λ‹¤.

requestURL μ€ π•” λΉπ•” μƒμ„±λλ” μ‹μ μ—λ” μ• μ μ—†μΌλ―€λ΅, μ™Έλ¶€μ—μ„ setterλ΅ μ…λ ¥ λ°›λ”λ‹¤.

**LogDemoController**

```

package hello.core.web;

import hello.core.common.MyLogger;

import hello.core.logdemo.LogDemoService;
import lombok.RequiredArgsConstructor;

import org.springframework.stereotype.Controller;

import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import javax.servlet.http.HttpServletRequest;

@Controller
@RequiredArgsConstructor

public class LogDemoController {


private final LogDemoService logDemoService;
private final MyLogger myLogger;

@RequestMapping("log-demo")
@ResponseBody

public String logDemo(HttpServletRequest request) {

String requestURL = request.getRequestURL().toString();
myLogger.setRequestURL(requestURL);

myLogger.log("controller test");
logDemoService.logic("testId");
return                             "OK";

}

}

```

λ΅κ±°κ°€ μ μ‘λ™ν•λ”μ§€ ν™•μΈν•λ” ν…μ¤νΈμ© μ»¨νΈλ΅¤λ¬λ‹¤.

μ—¬κΈ°μ„ HttpServletRequestλ¥Ό ν†µν•΄μ„ μ”μ²­ URLμ„ λ°›μ•λ‹¤.
requestURL κ°’ http://localhost:8080/log-demo

π•”λ ‡κ² λ°›μ€ requestURL κ°’μ„ myLoggerμ— μ €μ¥ν•΄λ‘”λ‹¤. myLoggerλ” HTTP μ”μ²­ λ‹Ή κ°κ° κµ¬λ¶„λλ―€λ΅ λ‹¤λ¥Έ

HTTP μ”μ²­ λ•λ¬Έμ— κ°’π•” μ„π•”λ” κ±±μ •μ€ ν•μ§€ μ•μ•„λ„ λλ‹¤.
μ»¨νΈλ΅¤λ¬μ—μ„ controller testλΌλ” λ΅κ·Έλ¥Ό λ‚¨κΈ΄λ‹¤.

**μ°Έκ³ :**                   requestURLμ„ MyLoggerμ— μ €μ¥ν•λ” λ¶€λ¶„μ€ μ»¨νΈλ΅¤λ¬ λ³΄λ‹¤λ” κ³µν†µ μ²λ¦¬κ°€ κ°€λ¥ν• μ¤ν”„λ§ μΈν„°μ…‰ν„°λ‚
μ„λΈ”λ¦Ώ ν•„ν„° κ°™μ€ κ³³μ„ ν™μ©ν•λ” κ²ƒπ•” μΆ‹λ‹¤. μ—¬κΈ°μ„λ” μμ λ¥Ό λ‹¨μν™”ν•κ³ , μ•„μ§ μ¤ν”„λ§ μΈν„°μ…‰ν„°λ¥Ό ν•™μµν•μ§€ μ•μ€
λ¶„λ“¤μ„ μ„ν•΄μ„ μ»¨νΈλ΅¤λ¬λ¥Ό μ‚¬μ©ν–λ‹¤. μ¤ν”„λ§ μ›Ήμ— μµμ™ν•λ‹¤λ©΄ μΈν„°μ…‰ν„°λ¥Ό μ‚¬μ©ν•΄μ„ κµ¬ν„ν•΄λ³΄μ.

**LogDemoService μ¶”κ°€**

```

package hello.core.logdemo;

import hello.core.common.MyLogger;
import lombok.RequiredArgsConstructor;

import org.springframework.stereotype.Service;

@Service
@RequiredArgsConstructor
public                          class LogDemoService {


private final MyLogger myLogger;

public void logic(String id) {
myLogger.log("service id = " + id);

}

}


```

λΉ„μ¦λ‹μ¤ λ΅μ§π•” μλ” μ„λΉ„μ¤ κ³„μΈµμ—μ„λ„ λ΅κ·Έλ¥Ό μ¶λ ¥ν•΄λ³΄μ.

μ—¬κΈ°μ„ μ¤‘μ”ν•μ π•” μλ‹¤. request scopeλ¥Ό μ‚¬μ©ν•μ§€ μ•κ³  νλΌλ―Έν„°λ΅ π•” λ¨λ“  μ •λ³΄λ¥Ό μ„λΉ„μ¤ κ³„μΈµμ— λ„κΈ΄λ‹¤λ©΄,
νλΌλ―Έν„°κ°€ λ§μ•„μ„ μ§€μ €λ¶„ν•΄μ§„λ‹¤. λ” λ¬Έμ λ” requestURL κ°™μ€ μ›Ήκ³Ό κ΄€λ ¨λ μ •λ³΄κ°€ μ›Ήκ³Ό κ΄€λ ¨μ—†λ” μ„λΉ„μ¤ κ³„μΈµκΉ
μ§€ λ„μ–΄κ°€κ² λλ‹¤. μ›Ήκ³Ό κ΄€λ ¨λ λ¶€λ¶„μ€ μ»¨νΈλ΅¤λ¬κΉμ§€λ§ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤. μ„λΉ„μ¤ κ³„μΈµμ€ μ›Ή κΈ°μ μ— μΆ…μ†λμ§€ μ•κ³ ,
κ°€κΈ‰μ  μμν•κ² μ μ§€ν•λ” κ²ƒπ•” μ μ§€λ³΄μ κ΄€μ μ—μ„ μΆ‹λ‹¤.

request scopeμ MyLogger λ•λ¶„μ— π•”λ° λ¶€λ¶„μ„ νλΌλ―Έν„°λ΅ λ„κΈ°μ§€ μ•κ³ , MyLoggerμ λ©¤λ²„λ³€μμ— μ €μ¥ν•΄μ„
μ½”λ“μ™€ κ³„μΈµμ„ κΉ”λ”ν•κ² μ μ§€ν•  μ μλ‹¤.

π•”μ  μ‹¤ν–‰μ„ ν•΄λ³΄μ.

**κΈ°λ€ν•λ” μ¶λ ¥**

```

[d06b992f...] request scope bean create
[d06b992f...][http://localhost:8080/log-demo] controller test
[d06b992f...][http://localhost:8080/log-demo] service id = testId
[d06b992f...]                         request scope bean close

```

**μ‹¤μ λ” κΈ°λ€μ™€ λ‹¤λ¥΄κ² μ• ν”λ¦¬μΌ€μ΄μ… μ‹¤ν–‰ μ‹μ μ— μ¤λ¥ λ°μƒ**

```

Error creating bean with name 'myLogger': Scope 'request' is not active for the
current thread; consider defining a scoped proxy for this bean if you intend to
refer to it from a singleton;

```

μ¤ν”„λ§ μ• ν”λ¦¬μΌ€π•”μ…μ„ μ‹¤ν–‰ μ‹ν‚¤λ©΄ μ¤λ¥κ°€ λ°μƒν•λ‹¤. λ©”μ‹μ§€ λ§μ§€λ§‰μ— μ‹±κΈ€ν†¤π•”λΌλ” λ‹¨μ–΄κ°€ λ‚μ¤κ³ β€¦

μ¤ν”„λ§ μ• ν”λ¦¬μΌ€π•”μ…μ„ μ‹¤ν–‰ν•λ” μ‹μ μ— μ‹±κΈ€ν†¤ λΉμ€ μƒμ„±ν•΄μ„ μ£Όμ…π•” κ°€λ¥ν•μ§€λ§, request μ¤μ½”ν”„ λΉμ€ μ•„μ§ μƒμ„±λ
μ§€ μ•λ”λ‹¤. π•” λΉμ€ μ‹¤μ  κ³ κ°μ μ”μ²­π•” μ™€μ•Ό μƒμ„±ν•  μ μλ‹¤!

μ¤μ½”ν”„μ™€ Provider


μ²«λ²μ§Έ ν•΄κ²°λ°©μ•μ€ μ•μ„ λ°°μ΄ Providerλ¥Ό μ‚¬μ©ν•λ” κ²ƒπ•”λ‹¤.
κ°„λ‹¨ν ObjectProviderλ¥Ό μ‚¬μ©ν•΄λ³΄μ.

```

package hello.core.web;

import hello.core.common.MyLogger;

import hello.core.logdemo.LogDemoService;
import lombok.RequiredArgsConstructor;

import org.springframework.beans.factory.ObjectProvider;
import org.springframework.stereotype.Controller;

import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import javax.servlet.http.HttpServletRequest;

@Controller
@RequiredArgsConstructor

public class LogDemoController {

private final LogDemoService logDemoService;

private final ObjectProvider<MyLogger> myLoggerProvider;

@RequestMapping("log-demo")
@ResponseBody

public String logDemo(HttpServletRequest request) {

String requestURL = request.getRequestURL().toString();
MyLogger myLogger = myLoggerProvider.getObject();
myLogger.setRequestURL(requestURL);

myLogger.log("controller test");
logDemoService.logic("testId");
return                             "OK";

}

}

```

```

package hello.core.logdemo;

import hello.core.common.MyLogger;
import lombok.RequiredArgsConstructor;

import org.springframework.beans.factory.ObjectProvider;
import org.springframework.stereotype.Service;


@Service
@RequiredArgsConstructor
public                          class LogDemoService {

private final ObjectProvider<MyLogger> myLoggerProvider;

public void logic(String id) {

MyLogger myLogger = myLoggerProvider.getObject();
myLogger.log("service id = " + id);

}

}

```

main() λ©”μ„λ“λ΅ μ¤ν”„λ§μ„ μ‹¤ν–‰ν•κ³ , μ›Ή λΈλΌμ°μ €μ— http://localhost:8080/log-demo λ¥Ό μ…λ ¥ν•μ.
λ“λ””μ–΄ μ μ‘λ™ν•λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

```

[d06b992f...] request scope bean create
[d06b992f...][http://localhost:8080/log-demo] controller test
[d06b992f...][http://localhost:8080/log-demo] service id = testId
[d06b992f...]                         request scope bean close

```

ObjectProvider λ•λ¶„μ— ObjectProvider.getObject() λ¥Ό νΈμ¶ν•λ” μ‹μ κΉμ§€ request scope **λΉμ
μƒμ„±μ„ μ§€μ—°**ν•  μ μλ‹¤.

ObjectProvider.getObject() λ¥Ό νΈμ¶ν•μ‹λ” μ‹μ μ—λ” HTTP μ”μ²­π•” μ§„ν–‰μ¤‘π•”λ―€λ΅ request scope λΉ
μ μƒμ„±π•” μ •μƒ μ²λ¦¬λλ‹¤.

ObjectProvider.getObject() λ¥Ό LogDemoController ,  LogDemoService μ—μ„ κ°κ° ν•λ²μ”© λ”°λ΅
νΈμ¶ν•΄λ„ κ°™μ€ HTTP μ”μ²­π•”λ©΄ κ°™μ€ μ¤ν”„λ§ λΉπ•” λ°ν™λλ‹¤!     λ‚΄κ°€ μ§μ ‘ π•”κ±Έ κµ¬λ¶„ν•λ ¤λ©΄ μ–Όλ§λ‚ νλ“¤κΉ γ… γ… β€¦

π•” μ •λ„μ—μ„ λλ‚΄λ„ λ  κ²ƒ κ°™μ§€λ§β€¦ κ°λ°μλ“¤μ μ½”λ“ λ‡μλ¥Ό λ” μ¤„π•”λ ¤λ” μ•μ‹¬μ€ λπ•” μ—†λ‹¤.

μ¤μ½”ν”„μ™€ ν”„λ΅μ‹


π•”λ²μ—λ” ν”„λ΅μ‹ λ°©μ‹μ„ μ‚¬μ©ν•΄λ³΄μ.

```

@Component

@Scope(value = "request", proxyMode = ScopedProxyMode.TARGET_CLASS)
public class MyLogger {

}


```

μ—¬κΈ°κ°€ ν•µμ‹¬π•”λ‹¤.  proxyMode = ScopedProxyMode.TARGET_CLASS λ¥Ό μ¶”κ°€ν•΄μ£Όμ.
μ μ© λ€μƒπ•” μΈν„°νπ•”μ¤κ°€ μ•„λ‹ ν΄λμ¤λ©΄ TARGET_CLASS λ¥Ό μ„ νƒ

μ μ© λ€μƒπ•” μΈν„°νπ•”μ¤λ©΄ INTERFACES λ¥Ό μ„ νƒ

π•”λ ‡κ² ν•λ©΄ MyLoggerμ κ°€μ§ ν”„λ΅μ‹ ν΄λμ¤λ¥Ό λ§λ“¤μ–΄λ‘κ³  HTTP requestμ™€ μƒκ΄€ μ—†π•” κ°€μ§ ν”„λ΅μ‹ ν΄λμ¤λ¥Ό
λ‹¤λ¥Έ λΉμ— λ―Έλ¦¬ μ£Όμ…ν•΄ λ‘ μ μλ‹¤.

π•”μ  λ‚λ¨Έμ§€ μ½”λ“λ¥Ό Provider μ‚¬μ© π•”μ „μΌλ΅ λλ ¤λ‘μ.

```

package hello.core.web;

import hello.core.common.MyLogger;

import hello.core.logdemo.LogDemoService;
import lombok.RequiredArgsConstructor;

import org.springframework.stereotype.Controller;

import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.bind.annotation.ResponseBody;

import javax.servlet.http.HttpServletRequest;

@Controller
@RequiredArgsConstructor

public class LogDemoController {

private final LogDemoService logDemoService;
private final MyLogger myLogger;

@RequestMapping("log-demo")
@ResponseBody

public String logDemo(HttpServletRequest request) {

String requestURL = request.getRequestURL().toString();
myLogger.setRequestURL(requestURL);

myLogger.log("controller test");
logDemoService.logic("testId");
return                             "OK";

}

}


```

```

package hello.core.logdemo;

import hello.core.common.MyLogger;
import lombok.RequiredArgsConstructor;

import org.springframework.stereotype.Service;

@Service
@RequiredArgsConstructor
public                          class LogDemoService {

private final MyLogger myLogger;

public void logic(String id) {
myLogger.log("service id = " + id);

}

}

```

μ‹¤ν–‰ν•΄λ³΄λ©΄ μ λ™μ‘ν•λ” κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.

μ½”λ“λ¥Ό μ λ³΄λ©΄ LogDemoController ,  LogDemoService λ” Provider μ‚¬μ© μ „κ³Ό μ™„μ „ν λ™μΌν•λ‹¤. μ–΄λ–»κ² λ κ²ƒ
μΌκΉ?

μ›Ή μ¤μ½”ν”„μ™€ ν”„λ΅μ‹ λ™μ‘ μ›λ¦¬

λ¨Όμ € μ£Όμ…λ myLoggerλ¥Ό ν™•μΈν•΄λ³΄μ.

```

System.out.println("myLogger = " + myLogger.getClass());

```

**μ¶λ ¥κ²°κ³Ό**

```

myLogger = class hello.core.common.MyLogger$$EnhancerBySpringCGLIB$$b68b726d

```

**CGLIBλΌλ” λΌμ΄λΈλ¬λ¦¬λ΅ λ‚΄ ν΄λμ¤λ¥Ό μƒμ† λ°›μ€ κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ¥Ό λ§λ“¤μ–΄μ„ μ£Όμ…ν•λ‹¤.**

@Scope μ proxyMode = ScopedProxyMode.TARGET_CLASS) λ¥Ό μ„¤μ •ν•λ©΄ μ¤ν”„λ§ μ»¨ν…π•”λ„λ” CGLIB
λΌλ” λ°”π•”νΈμ½”λ“λ¥Ό μ΅°μ‘ν•λ” λΌπ•”λΈλ¬λ¦¬λ¥Ό μ‚¬μ©ν•΄μ„, MyLoggerλ¥Ό μƒμ†λ°›μ€ κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ¥Ό μƒμ„±ν•λ‹¤.
κ²°κ³Όλ¥Ό ν™•μΈν•΄λ³΄λ©΄ μ°λ¦¬κ°€ λ“±λ΅ν• μμν• MyLogger ν΄λμ¤κ°€ μ•„λ‹λΌ MyLogger$


$EnhancerBySpringCGLIB π•”λΌλ” ν΄λμ¤λ΅ λ§λ“¤μ–΄μ§„ κ°μ²΄κ°€ λ€μ‹  λ“±λ΅λ κ²ƒμ„ ν™•μΈν•  μ μλ‹¤.
κ·Έλ¦¬κ³  μ¤ν”„λ§ μ»¨ν…π•”λ„μ— "myLogger"λΌλ” π•”λ¦„μΌλ΅ μ§„μ§ λ€μ‹ μ— π•” κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ¥Ό λ“±λ΅ν•λ‹¤.

ac.getBean("myLogger", MyLogger.class) λ΅ μ΅°νν•΄λ„ ν”„λ΅μ‹ κ°μ²΄κ°€ μ΅°νλλ” κ²ƒμ„ ν™•μΈν•  μ μ
λ‹¤.

κ·Έλμ„ μμ΅΄κ΄€κ³„ μ£Όμ…λ„ π•” κ°€μ§ ν”„λ΅μ‹ κ°μ²΄κ°€ μ£Όμ…λλ‹¤.

**κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ” μ”μ²­μ΄ μ¤λ©΄ κ·Έλ• λ‚΄λ¶€μ—μ„ μ§„μ§ λΉμ„ μ”μ²­ν•λ” μ„μ„ λ΅μ§μ΄ λ“¤μ–΄μλ‹¤.**

κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ” λ‚΄λ¶€μ— μ§„μ§ myLogger λ¥Ό μ°Ύλ” λ°©λ²•μ„ μ•κ³  μλ‹¤.

ν΄λΌπ•”μ–ΈνΈκ°€ myLogger.log() μ„ νΈμ¶ν•λ©΄ μ‚¬μ‹¤μ€ κ°€μ§ ν”„λ΅μ‹ κ°μ²΄μ λ©”μ„λ“λ¥Ό νΈμ¶ν• κ²ƒπ•”λ‹¤.
κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ” request μ¤μ½”ν”„μ μ§„μ§ myLogger.log() λ¥Ό νΈμ¶ν•λ‹¤.

κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ” μ›λ³Έ ν΄λμ¤λ¥Ό μƒμ† λ°›μ•„μ„ λ§λ“¤μ–΄μ΅κΈ° λ•λ¬Έμ— π•” κ°μ²΄λ¥Ό μ‚¬μ©ν•λ” ν΄λΌπ•”μ–ΈνΈ μ…μ¥μ—μ„λ” μ‚¬
μ‹¤ μ›λ³ΈμΈμ§€ μ•„λ‹μ§€λ„ λ¨λ¥΄κ², λ™μΌν•κ² μ‚¬μ©ν•  μ μλ‹¤(λ‹¤ν•μ„±)

**λ™μ‘ μ •λ¦¬**

CGLIBλΌλ” λΌπ•”λΈλ¬λ¦¬λ΅ λ‚΄ ν΄λμ¤λ¥Ό μƒμ† λ°›μ€ κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ¥Ό λ§λ“¤μ–΄μ„ μ£Όμ…ν•λ‹¤.

π•” κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ” μ‹¤μ  μ”μ²­π•” μ¤λ©΄ κ·Έλ• λ‚΄λ¶€μ—μ„ μ‹¤μ  λΉμ„ μ”μ²­ν•λ” μ„μ„ λ΅μ§π•” λ“¤μ–΄μλ‹¤.

κ°€μ§ ν”„λ΅μ‹ κ°μ²΄λ” μ‹¤μ  request scopeμ™€λ” κ΄€κ³„κ°€ μ—†λ‹¤. κ·Έλƒ¥ κ°€μ§π•”κ³ , λ‚΄λ¶€μ— λ‹¨μν• μ„μ„ λ΅μ§λ§ μκ³ , μ‹±
κΈ€ν†¤ μ²λΌ λ™μ‘ν•λ‹¤.

**νΉμ§• μ •λ¦¬**

ν”„λ΅μ‹ κ°μ²΄ λ•λ¶„μ— ν΄λΌπ•”μ–ΈνΈλ” λ§μΉ μ‹±κΈ€ν†¤ λΉμ„ μ‚¬μ©ν•λ“―π•” νΈλ¦¬ν•κ² request scopeλ¥Ό μ‚¬μ©ν•  μ μλ‹¤.
μ‚¬μ‹¤ Providerλ¥Ό μ‚¬μ©ν•λ“ , ν”„λ΅μ‹λ¥Ό μ‚¬μ©ν•λ“  ν•µμ‹¬ μ•„π•”λ””μ–΄λ” μ§„μ§ κ°μ²΄ μ΅°νλ¥Ό κΌ­ ν•„μ”ν• μ‹μ κΉμ§€ μ§€μ—°μ²λ¦¬
ν•λ‹¤λ” μ π•”λ‹¤.


λ‹¨μ§€ μ• λ…Έν…π•”μ… μ„¤μ • λ³€κ²½λ§μΌλ΅ μ›λ³Έ κ°μ²΄λ¥Ό ν”„λ΅μ‹ κ°μ²΄λ΅ λ€μ²΄ν•  μ μλ‹¤. π•”κ²ƒπ•” λ°”λ΅ λ‹¤ν•μ„±κ³Ό DI μ»¨ν…π•”λ„
κ°€ κ°€μ§„ ν° κ°•μ π•”λ‹¤.

κΌ­ μ›Ή μ¤μ½”ν”„κ°€ μ•„λ‹μ–΄λ„ ν”„λ΅μ‹λ” μ‚¬μ©ν•  μ μλ‹¤.

**μ£Όμμ **

λ§μΉ μ‹±κΈ€ν†¤μ„ μ‚¬μ©ν•λ” κ²ƒ κ°™μ§€λ§ λ‹¤λ¥΄κ² λ™μ‘ν•κΈ° λ•λ¬Έμ— κ²°κµ­ μ£Όμν•΄μ„ μ‚¬μ©ν•΄μ•Ό ν•λ‹¤.

π•”λ° νΉλ³„ν• scopeλ” κΌ­ ν•„μ”ν• κ³³μ—λ§ μµμ†ν™”ν•΄μ„ μ‚¬μ©ν•μ, λ¬΄λ¶„λ³„ν•κ² μ‚¬μ©ν•λ©΄ μ μ§€λ³΄μν•κΈ° μ–΄λ ¤μ›μ§„λ‹¤.


10. λ‹¤μμΌλ΅

#1.μΈκ°•/2.ν•µμ‹¬μ›λ¦¬ - κΈ°λ³ΈνΈ/κ°•μ#

λ‹¤μμΌλ΅

μ§€κΈκΉμ§€ ν•™μµν• λ‚΄μ© λ©μ°¨

1. κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ™€ μ¤ν”„λ§

2. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ π•”ν•΄1 - μμ  λ§λ“¤κΈ°

3. μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ π•”ν•΄2 - κ°μ²΄ μ§€ν–¥ μ›λ¦¬ μ μ©

4. μ¤ν”„λ§ μ»¨ν…π•”λ„μ™€ μ¤ν”„λ§ λΉ

5. μ‹±κΈ€ν†¤ μ»¨ν…π•”λ„

6. μ»΄ν¬λ„νΈ μ¤μΊ”

7. μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…

8. λΉ μƒλ…μ£ΌκΈ° μ½λ°±

9. λΉ μ¤μ½”ν”„

ν•™μµ λ‚΄μ© μ •λ¦¬

**μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬μ™€ ν•µμ‹¬ κΈ°λ¥**

**μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬**

κ°μ²΄ μ§€ν–¥ μ„¤κ³„

λ‹¤ν•μ„± - μ—­ν• κ³Ό κµ¬ν„μ λ¶„λ¦¬

SOLID [OCP, DIP]

DI μ»¨ν…π•”λ„

**μ¤ν”„λ§ ν•µμ‹¬ κΈ°λ¥**

μ¤ν”„λ§ μ»¨ν…π•”λ„, λΉ
μ‹±κΈ€ν†¤

μ»΄ν¬λ„νΈ μ¤μΊ”
μμ΅΄κ΄€κ³„ μλ™ μ£Όμ…
λΉ μƒλ…μ£ΌκΈ° μ½λ°±
λΉ μ¤μ½”ν”„

μ§€κΈκΉμ§€ μ°λ¦¬λ” μ¤ν”„λ§μ ν•µμ‹¬ μ›λ¦¬μ™€ ν•µμ‹¬ κΈ°λ¥μ— λ€ν•΄μ„ κΉπ•”μκ² ν•™μµν–λ‹¤. μ¤ν”„λ§π•” μ™ λ§λ“¤μ–΄μ΅κ³ , μ™ ν•„μ”ν•μ§€,


κ·Έλ¦¬κ³  κ°μ²΄ μ§€ν–¥ μ„¤κ³„μ™€ μ¤ν”„λ§π•” μ™ λ•” μ μ—†λ” κ΄€κ³„μΈμ§€ π•”ν•΄ν–λ‹¤.

μ¤ν”„λ§μ ν•µμ‹¬ μ›λ¦¬μ™€ ν•µμ‹¬ μ»¨μ…‰μ„ μ λ€λ΅ ν•™μµν–κΈ° λ•λ¬Έμ— μ¤ν”„λ§ μ›Ή MVC, μ¤ν”„λ§ λ°π•”ν„° μ ‘κ·Ό κΈ°μ , μ¤ν”„λ§ λ¶€νΈλ¥Ό
ν¬ν•¨ν•΄μ„ μ¤ν”„λ§μ ν•µμ‹¬ κΈ°μ μ„ ν™μ©ν•λ” μ λ§μ€ μ¤ν”„λ§ κΈ°μ λ“¤μ„ λ°°μ°κ³  μ‚¬μ©ν•  λ•λ„, λ‹¨μν• κΈ°λ¥ μ‚¬μ©μ„ λ„μ–΄μ„ κΉ

π•”μλ” π•”ν•΄κ°€ κ°€λ¥ν•  κ²ƒπ•”λ‹¤.

μ¤ν”„λ§ μ™„μ „ μ •λ³µ μ‹λ¦¬μ¦(μ§„ν–‰μ¤‘)

μ¤ν”„λ§μ„ μ™„μ „ν λ§μ¤ν„° ν•  μ μλ” λ‹¤μ μ‹λ¦¬μ¦λ¥Ό μ¤€λΉ„μ¤‘π•”λ‹¤.

μ‹¤μ  μ‹¤λ¬΄μ—μ„ μ‚¬μ©ν•λ” ν•µμ‹¬ μ¤ν”„λ§ κΈ°λ¥ μ„μ£Όλ΅ μ„¤λ…ν•κ³  μ‹¤λ¬΄μ—μ„ μ‚¬μ©ν•μ§€ μ•κ±°λ‚ μ¤λλ κΈ°λ¥μ€ κ³Όκ°ν•κ² μ‚­μ ν–
λ‹¤. κ·Έλ¦¬κ³  μ‹¤λ¬΄ λ…Έν•μ°λ¥Ό μ „μν•λ‹¤.

**κ°•μ λ©λ΅**

[μ…λ¬Έ] μ¤ν”„λ§ μ…λ¬Έ - μ½”λ“λ΅ λ°°μ°λ” μ¤ν”„λ§ λ¶€νΈ, μ›Ή MVC, DB μ ‘κ·Ό κΈ°μ (μ¤ν”)
[μ΄κΈ‰] μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ - κΈ°λ³ΈνΈ(μ¤ν”)

[μ΄κΈ‰] μ‹¤μ „! μ¤ν”„λ§ μ›Ή MVC (μ§„ν–‰μ¤‘)
[μ΄κΈ‰] μ‹¤μ „! μ¤ν”„λ§ DB μ ‘κ·Ό κΈ°μ  (μμ •)
[μ΄κΈ‰~μ¤‘κΈ‰] μ‹¤μ „! μ¤ν”„λ§ λ¶€νΈ (μμ •)
[μ¤‘κΈ‰]  μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ - μ¤‘κΈ‰νΈ(μμ •)

**μ‹¤μ „! μ¤ν”„λ§ μ›Ή MVC - λ‹¤μ μ¶μ‹ μμ •**

**λ©ν‘: μ΄ κ°•μλ΅ μ›Ή μ• ν”λ¦¬μΌ€μ΄μ…μ„ κ°λ°ν•  λ• ν•„μ”ν• λ¨λ“  μ›Ή κΈ°μ  μ™„μ„±**

μ›Ή κΈ°μ΄λ¶€ν„° μ‹¤λ¬΄κΉμ§€: μ‹¤λ¬΄ κ°λ°μ„ μ„ν• λ‚΄μ©π•” λ§μ§€λ§, μ›Ή μ• ν”λ¦¬μΌ€π•”μ… κ°λ° κ²½ν—π•” μ—†λ” κ°λ°μλ„ μ μ‘ν•  μ
μκ² κµ¬μ„±

μλ°” μ›Ή κΈ°μ  π•”μ•ΌκΈ°: μ„λΈ”λ¦Ώ, ν•„ν„° κ°™μ€ μλ°” κΈ°λ³Έ μ›Ή κΈ°μ λ¶€ν„° μ‹μ‘ν•΄μ„ μ™ μ¤ν”„λ§ MVCκ°€ λ‚μ¤κ² λμ—λ”μ§€ μ„¤λ…
μ‹¤λ¬΄ μμ  μ¤‘μ‹¬: μ‹¤λ¬΄μ—μ„ μ¤ν”„λ§μΌλ΅ μ›Ή μ• ν”λ¦¬μΌ€π•”μ…μ„ κ°λ°ν•  λ• ν•„μ”ν• λ¨λ“  λ‚΄μ©μ„ μμ λ΅ μμ—°μ¤λ½κ² ν•™μµ,
μ‹¤λ¬΄ λ² μ¤νΈ ν”„λ™ν‹°μ¤ μ „μ

κ°„κ²°ν•¨: μ‹¤λ¬΄μ—μ„ μ‚¬μ©ν•μ§€ μ•λ” μ¤λλ κΈ°λ¥μ€ κ³Όκ°ν•κ² μ μ™Έ, μµμ‹  μ‹¤λ¬΄μ— μ£Όλ΅ μ‚¬μ©ν•λ” λ‚΄μ© μ„μ£Όλ΅ μ„¤λ…

μ¤ν”„λ§ λ¶€νΈμ™€ JPA μ‹¤λ¬΄ μ™„μ „ μ •λ³µ λ΅λ“λ§µ

μµμ‹  μ‹¤λ¬΄ κΈ°μ λ΅ μ›Ή μ• ν”λ¦¬μΌ€π•”μ…μ„ λ§λ“¤μ–΄λ³΄λ©΄μ„ ν•™μµν•κ³  μ‹¶μΌλ©΄ μ¤ν”„λ§ λ¶€νΈμ™€ JPA μ‹¤λ¬΄ μ™„μ „ μ •λ³µ λ΅λ“λ§µμ„ μ¶”μ²
ν•λ‹¤. URL: https://www.inflearn.com/roadmaps/149

**κ°•μ λ©λ΅**

[μ΄κΈ‰] μλ°” ORM ν‘μ¤€ JPA ν”„λ΅κ·Έλλ°

[μ΄κΈ‰] μ‹¤μ „! μ¤ν”„λ§ λ¶€νΈμ™€ JPA ν™μ©1 - μ›Ή μ• ν”λ¦¬μΌ€π•”μ… κ°λ°


[μ¤‘κΈ‰] μ‹¤μ „! μ¤ν”„λ§ λ¶€νΈμ™€ JPA ν™μ©2 - API κ°λ°κ³Ό μ„±λ¥ μµμ ν™”

[μ¤‘κΈ‰] μ‹¤μ „! μ¤ν”„λ§ λ°π•”ν„° JPA
[μ¤‘κΈ‰] μ‹¤μ „! Querydsl

μ¶”μ² ν•™μµ μ½”μ¤

**λ©ν‘: μµμ‹  κΈ°μ μ μλ°” λ°±μ—”λ“ κ°λ°μ**

μ·¨μ—… μ¤€λΉ„μƒ

μ‹¤λ¬΄ μ£Όλ‹μ–΄ λ°±μ—”λ“ κ°λ°μ

μµμ‹  κ°λ° νΈλλ“λ¥Ό κΉπ•” π•”ν•΄ν•κ³  μ‹¶μ€ μ‹¤λ¬΄ λ°±μ—”λ“ κ°λ°μ

**ν•µμ‹¬:**                   μ‹¤λ¬΄μ—μ„ ν”„λ΅μ νΈλ¥Ό μ§„ν–‰ν•  λ• μ–΄λ–»κ² μ„¤κ³„ν•κ³ , κ°λ°ν•λ”μ§€, κ·Έλ¦¬κ³  μµκ·Όμ—λ” κΈ°μ λ“¤μ„ μ‚¬μ©ν•λ”μ§€ κ²½ν—ν•΄λ³΄κ³ ,
ν° κ·Έλ¦Όμ„ π•”ν•΄ν• μƒνƒμ—μ„, κ·Έ λ‹¤μμ— μ„Έλ¶€μ μΈ κ°κ°μ κΈ°μ μ„ ν•™μµν•΄μ•Ό ν•λ‹¤.     μ•Όμƒν• μ½”μ¤

ν•™μν• μ½”μ¤ vs μ•Όμƒν• μ½”μ¤

ν•™μν• μ½”μ¤: π•”λ΅ μ„ λ¨Όμ € μ°¨κ·Όμ°¨κ·Ό μ“μ•„μ¬λ¦° λ‹¤μμ— μ‹¤λ¬΄ ν™μ©μΌλ΅ λ„μ–΄κ°€λ” λ°©μ‹

μ•Όμƒν• μ½”μ¤: μΌλ‹¨ μ‹¤λ¬΄μ—μ„ μ–΄λ–¤ κΈ°μ μ„ μ–΄λ–¤μ‹μΌλ΅ ν™μ©ν•λ”μ§€, κΉπ•”κ°€ λ¶€μ΅±ν•΄λ„ μΌλ‹¨ κ²½ν—ν•΄λ³Έ λ‹¤μμ— ν•„
μ”μ— μν•΄μ„ π•”λ΅  κΈ°μ λ“¤μ„ κ³µλ¶€ν•λ” λ°©μ‹

λ¶„μ•Όλ§λ‹¤ λ‹¤λ¥Ό μλ” μμ§€λ§ κ°λ° κ³µλ¶€λ” μ•Όμƒν• μ¤νƒ€μΌλ΅ ν•™μµν•λ” κ°λ°μκ°€ λΉ¨λ¦¬ μ„±μ¥ν•λ‹¤. μ™λƒν•λ©΄ λ‚΄κ°€ ν•΄κ²°ν•΄μ•Ό ν• 
λ¬Έμ κ°€ λ­”μ§€, μ•κ³ λ‚ λ‹¤μμ— λ¬Έμ  ν•΄κ²°μ— ν•„μ”ν• κΈ°μ μ„ ν•™μµν•κΈ° λ•λ¬Έπ•”λ‹¤. λ‚΄κ°€ ν•΄κ²°ν•΄μ•Όν•  λ¬Έμ κ°€ λ­”μ§€λ„ λ¨λ¥Έ μƒνƒ
λ΅ λ‹¨μν π•”λ΅ λ§ κ³„μ† ν•™μµν•λ©΄ π•” κΈ°μ μ„ μ™ λ°°μ›μ•Ό ν•λ”μ§€ π•”ν•΄ν•κΈ°λ„ μ‰½μ§€ μ•κ³ , λ¬΄μ—‡λ³΄λ‹¤ μ¤‘κ°„μ— ν¬κΈ°ν•κΈ° μ‰½λ‹¤.

**μ¶”μ² μ•Όμƒν• μ½”μ¤**

1.   μ¤ν”„λ§ μ…λ¬Έ

2.   μ¤ν”„λ§ ν•µμ‹¬ μ›λ¦¬ - κΈ°λ³ΈνΈ

3.   μ¤ν”„λ§ λ¶€νΈμ™€ JPA μ‹¤λ¬΄ μ™„μ „ μ •λ³µ λ΅λ“λ§µ

1.   **νƒ€μ… B - μ•Όμƒν•(μ¶”μ²)**

**νƒ€μ… B - μ•Όμƒν•(μ¶”μ²)**

**1.**                   **ν™μ©νΈ 1**                   - λ¨Όμ € ν™μ©νΈ 1μ„ μ­‰ λ”°λΌ μΉλ©° μ „μ²΄ κΈ°μ κ³Ό λ°±μ—”λ“ μ„λΉ„μ¤ κ°λ°μ κ°μ„ 
μµν™λ‹λ‹¤. (π•”ν•΄κ°€ μΆ€ λ¶€μ΅±ν•΄λ„ μ°
μ„  μ§„ν–‰ν•μ‹κΈΈ κ¶μ¥ν•©λ‹λ‹¤.)

**2.**                   **JPA κΈ°λ³ΈνΈ**                   - JPA κΈ°λ³Έ λ‚΄κ³µμ„ λ‹¤μ§‘λ‹λ‹¤.


**3.**                   **ν™μ©νΈ 1 λ³µμµ**                   - π•”λ―Έ κΈ°λ³ΈνΈμ„ ν•™μµν• μƒνƒπ•”κΈ° λ•λ¬Έμ— μ²μλ¶€ν„° λ‹¤μ‹ μ­‰ λ”°λΌν•λ‹¤ λ³΄λ©΄ 
JPAμ κΉπ•”μλ” λ‚΄μ©μ„ π•”
ν•΄ν•  μ μμµλ‹λ‹¤.

**4.**                   **ν™μ©νΈ 2 - μ‹¤μ „μ—μ„ JPAλ¥Ό κ°λ°ν•κ³ , JPA μ„±λ¥ μµμ ν™”λ¥Ό μ–΄λ–»κ² ν•λ”μ§€ π•”ν•΄ν•©λ‹λ‹¤.

**5.**                   **μ¤ν”„λ§ λ°μ΄ν„° JPA**                   - μ‹¤λ¬΄μ—μ„ ν•„μ”ν• κΈ°λ¥ μ„μ£Όλ΅ μ¤ν”„λ§ λ°π•”ν„° JPAλ¥Ό ν•™μµν•©λ‹λ‹¤.

**6.**                   **Querydsl**                   - λ³µμ΅ν• μΏΌλ¦¬μ™€ λ™μ μΏΌλ¦¬ λ¬Έμ λ¥Ό ν•΄κ²°ν•©λ‹λ‹¤.

μ•Όμƒν• μ½”μ¤λ¥Ό μ™„λ£ν• λ‹¤μμ— λ³ΈμΈμ—κ² λ¶€μ΅±ν• μ¤ν”„λ§ κΈ°μ μ„ λ” κΉπ•”μκ² ν•™μµν•΄λ„ μΆ‹κ³ , λλ” μ•Όμƒν• μ½”μ¤ μ¤‘κ°„
μ— ν•„μ”ν• μ¤ν”„λ§ κΈ°μ μ„ ν•™μµν•΄λ„ μΆ‹λ‹¤.

